(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Gh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Hv={exports:{}},nc={},Wv={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Al=Symbol.for("react.element"),uE=Symbol.for("react.portal"),cE=Symbol.for("react.fragment"),dE=Symbol.for("react.strict_mode"),fE=Symbol.for("react.profiler"),hE=Symbol.for("react.provider"),pE=Symbol.for("react.context"),mE=Symbol.for("react.forward_ref"),gE=Symbol.for("react.suspense"),yE=Symbol.for("react.memo"),vE=Symbol.for("react.lazy"),Um=Symbol.iterator;function wE(t){return t===null||typeof t!="object"?null:(t=Um&&t[Um]||t["@@iterator"],typeof t=="function"?t:null)}var qv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kv=Object.assign,Jv={};function Ws(t,e,n){this.props=t,this.context=e,this.refs=Jv,this.updater=n||qv}Ws.prototype.isReactComponent={};Ws.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ws.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Gv(){}Gv.prototype=Ws.prototype;function Yh(t,e,n){this.props=t,this.context=e,this.refs=Jv,this.updater=n||qv}var Xh=Yh.prototype=new Gv;Xh.constructor=Yh;Kv(Xh,Ws.prototype);Xh.isPureReactComponent=!0;var Hm=Array.isArray,Yv=Object.prototype.hasOwnProperty,Qh={current:null},Xv={key:!0,ref:!0,__self:!0,__source:!0};function Qv(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Yv.call(e,r)&&!Xv.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Al,type:t,key:s,ref:o,props:i,_owner:Qh.current}}function xE(t,e){return{$$typeof:Al,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Zh(t){return typeof t=="object"&&t!==null&&t.$$typeof===Al}function SE(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Wm=/\/+/g;function Xc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?SE(""+t.key):e.toString(36)}function La(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Al:case uE:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Xc(o,0):r,Hm(i)?(n="",t!=null&&(n=t.replace(Wm,"$&/")+"/"),La(i,e,n,"",function(u){return u})):i!=null&&(Zh(i)&&(i=xE(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Wm,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Hm(t))for(var l=0;l<t.length;l++){s=t[l];var a=r+Xc(s,l);o+=La(s,e,n,a,i)}else if(a=wE(t),typeof a=="function")for(t=a.call(t),l=0;!(s=t.next()).done;)s=s.value,a=r+Xc(s,l++),o+=La(s,e,n,a,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gl(t,e,n){if(t==null)return t;var r=[],i=0;return La(t,r,"","",function(s){return e.call(n,s,i++)}),r}function bE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vt={current:null},ja={transition:null},kE={ReactCurrentDispatcher:vt,ReactCurrentBatchConfig:ja,ReactCurrentOwner:Qh};function Zv(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:Gl,forEach:function(t,e,n){Gl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Gl(t,function(){e++}),e},toArray:function(t){return Gl(t,function(e){return e})||[]},only:function(t){if(!Zh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};de.Component=Ws;de.Fragment=cE;de.Profiler=fE;de.PureComponent=Yh;de.StrictMode=dE;de.Suspense=gE;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kE;de.act=Zv;de.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Kv({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Qh.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)Yv.call(e,a)&&!Xv.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Al,type:t.type,key:i,ref:s,props:r,_owner:o}};de.createContext=function(t){return t={$$typeof:pE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hE,_context:t},t.Consumer=t};de.createElement=Qv;de.createFactory=function(t){var e=Qv.bind(null,t);return e.type=t,e};de.createRef=function(){return{current:null}};de.forwardRef=function(t){return{$$typeof:mE,render:t}};de.isValidElement=Zh;de.lazy=function(t){return{$$typeof:vE,_payload:{_status:-1,_result:t},_init:bE}};de.memo=function(t,e){return{$$typeof:yE,type:t,compare:e===void 0?null:e}};de.startTransition=function(t){var e=ja.transition;ja.transition={};try{t()}finally{ja.transition=e}};de.unstable_act=Zv;de.useCallback=function(t,e){return vt.current.useCallback(t,e)};de.useContext=function(t){return vt.current.useContext(t)};de.useDebugValue=function(){};de.useDeferredValue=function(t){return vt.current.useDeferredValue(t)};de.useEffect=function(t,e){return vt.current.useEffect(t,e)};de.useId=function(){return vt.current.useId()};de.useImperativeHandle=function(t,e,n){return vt.current.useImperativeHandle(t,e,n)};de.useInsertionEffect=function(t,e){return vt.current.useInsertionEffect(t,e)};de.useLayoutEffect=function(t,e){return vt.current.useLayoutEffect(t,e)};de.useMemo=function(t,e){return vt.current.useMemo(t,e)};de.useReducer=function(t,e,n){return vt.current.useReducer(t,e,n)};de.useRef=function(t){return vt.current.useRef(t)};de.useState=function(t){return vt.current.useState(t)};de.useSyncExternalStore=function(t,e,n){return vt.current.useSyncExternalStore(t,e,n)};de.useTransition=function(){return vt.current.useTransition()};de.version="18.3.1";Wv.exports=de;var I=Wv.exports;const Ve=Gh(I);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _E=I,EE=Symbol.for("react.element"),CE=Symbol.for("react.fragment"),TE=Object.prototype.hasOwnProperty,NE=_E.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,OE={key:!0,ref:!0,__self:!0,__source:!0};function ew(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)TE.call(e,r)&&!OE.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:EE,type:t,key:s,ref:o,props:i,_owner:NE.current}}nc.Fragment=CE;nc.jsx=ew;nc.jsxs=ew;Hv.exports=nc;var _=Hv.exports,cf={},tw={exports:{}},zt={},nw={exports:{}},rw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(C,N){var R=C.length;C.push(N);e:for(;0<R;){var z=R-1>>>1,j=C[z];if(0<i(j,N))C[z]=N,C[R]=j,R=z;else break e}}function n(C){return C.length===0?null:C[0]}function r(C){if(C.length===0)return null;var N=C[0],R=C.pop();if(R!==N){C[0]=R;e:for(var z=0,j=C.length,q=j>>>1;z<q;){var H=2*(z+1)-1,X=C[H],Q=H+1,Z=C[Q];if(0>i(X,R))Q<j&&0>i(Z,X)?(C[z]=Z,C[Q]=R,z=Q):(C[z]=X,C[H]=R,z=H);else if(Q<j&&0>i(Z,R))C[z]=Z,C[Q]=R,z=Q;else break e}}return N}function i(C,N){var R=C.sortIndex-N.sortIndex;return R!==0?R:C.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var a=[],u=[],c=1,d=null,f=3,h=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(C){for(var N=n(u);N!==null;){if(N.callback===null)r(u);else if(N.startTime<=C)r(u),N.sortIndex=N.expirationTime,e(a,N);else break;N=n(u)}}function x(C){if(m=!1,y(C),!p)if(n(a)!==null)p=!0,M(k);else{var N=n(u);N!==null&&$(x,N.startTime-C)}}function k(C,N){p=!1,m&&(m=!1,g(E),E=-1),h=!0;var R=f;try{for(y(N),d=n(a);d!==null&&(!(d.expirationTime>N)||C&&!A());){var z=d.callback;if(typeof z=="function"){d.callback=null,f=d.priorityLevel;var j=z(d.expirationTime<=N);N=t.unstable_now(),typeof j=="function"?d.callback=j:d===n(a)&&r(a),y(N)}else r(a);d=n(a)}if(d!==null)var q=!0;else{var H=n(u);H!==null&&$(x,H.startTime-N),q=!1}return q}finally{d=null,f=R,h=!1}}var S=!1,b=null,E=-1,O=5,L=-1;function A(){return!(t.unstable_now()-L<O)}function P(){if(b!==null){var C=t.unstable_now();L=C;var N=!0;try{N=b(!0,C)}finally{N?B():(S=!1,b=null)}}else S=!1}var B;if(typeof w=="function")B=function(){w(P)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,D=T.port2;T.port1.onmessage=P,B=function(){D.postMessage(null)}}else B=function(){v(P,0)};function M(C){b=C,S||(S=!0,B())}function $(C,N){E=v(function(){C(t.unstable_now())},N)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(C){C.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,M(k))},t.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<C?Math.floor(1e3/C):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(C){switch(f){case 1:case 2:case 3:var N=3;break;default:N=f}var R=f;f=N;try{return C()}finally{f=R}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(C,N){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var R=f;f=C;try{return N()}finally{f=R}},t.unstable_scheduleCallback=function(C,N,R){var z=t.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?z+R:z):R=z,C){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=R+j,C={id:c++,callback:N,priorityLevel:C,startTime:R,expirationTime:j,sortIndex:-1},R>z?(C.sortIndex=R,e(u,C),n(a)===null&&C===n(u)&&(m?(g(E),E=-1):m=!0,$(x,R-z))):(C.sortIndex=j,e(a,C),p||h||(p=!0,M(k))),C},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(C){var N=f;return function(){var R=f;f=N;try{return C.apply(this,arguments)}finally{f=R}}}})(rw);nw.exports=rw;var ME=nw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AE=I,Lt=ME;function V(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iw=new Set,Vo={};function Mi(t,e){_s(t,e),_s(t+"Capture",e)}function _s(t,e){for(Vo[t]=e,t=0;t<e.length;t++)iw.add(e[t])}var Wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),df=Object.prototype.hasOwnProperty,IE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qm={},Km={};function RE(t){return df.call(Km,t)?!0:df.call(qm,t)?!1:IE.test(t)?Km[t]=!0:(qm[t]=!0,!1)}function PE(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function DE(t,e,n,r){if(e===null||typeof e>"u"||PE(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function wt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rt[t]=new wt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rt[e]=new wt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rt[t]=new wt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rt[t]=new wt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rt[t]=new wt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rt[t]=new wt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rt[t]=new wt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rt[t]=new wt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rt[t]=new wt(t,5,!1,t.toLowerCase(),null,!1,!1)});var ep=/[\-:]([a-z])/g;function tp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ep,tp);rt[e]=new wt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ep,tp);rt[e]=new wt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ep,tp);rt[e]=new wt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rt[t]=new wt(t,1,!1,t.toLowerCase(),null,!1,!1)});rt.xlinkHref=new wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rt[t]=new wt(t,1,!1,t.toLowerCase(),null,!0,!0)});function np(t,e,n,r){var i=rt.hasOwnProperty(e)?rt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(DE(e,n,i,r)&&(n=null),r||i===null?RE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Xn=AE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yl=Symbol.for("react.element"),Gi=Symbol.for("react.portal"),Yi=Symbol.for("react.fragment"),rp=Symbol.for("react.strict_mode"),ff=Symbol.for("react.profiler"),sw=Symbol.for("react.provider"),ow=Symbol.for("react.context"),ip=Symbol.for("react.forward_ref"),hf=Symbol.for("react.suspense"),pf=Symbol.for("react.suspense_list"),sp=Symbol.for("react.memo"),sr=Symbol.for("react.lazy"),lw=Symbol.for("react.offscreen"),Jm=Symbol.iterator;function to(t){return t===null||typeof t!="object"?null:(t=Jm&&t[Jm]||t["@@iterator"],typeof t=="function"?t:null)}var Ne=Object.assign,Qc;function po(t){if(Qc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qc=e&&e[1]||""}return`
`+Qc+t}var Zc=!1;function ed(t,e){if(!t||Zc)return"";Zc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=o&&0<=l);break}}}finally{Zc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?po(t):""}function $E(t){switch(t.tag){case 5:return po(t.type);case 16:return po("Lazy");case 13:return po("Suspense");case 19:return po("SuspenseList");case 0:case 2:case 15:return t=ed(t.type,!1),t;case 11:return t=ed(t.type.render,!1),t;case 1:return t=ed(t.type,!0),t;default:return""}}function mf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Yi:return"Fragment";case Gi:return"Portal";case ff:return"Profiler";case rp:return"StrictMode";case hf:return"Suspense";case pf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ow:return(t.displayName||"Context")+".Consumer";case sw:return(t._context.displayName||"Context")+".Provider";case ip:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case sp:return e=t.displayName||null,e!==null?e:mf(t.type)||"Memo";case sr:e=t._payload,t=t._init;try{return mf(t(e))}catch{}}return null}function LE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mf(e);case 8:return e===rp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Pr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function aw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jE(t){var e=aw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Xl(t){t._valueTracker||(t._valueTracker=jE(t))}function uw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=aw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function iu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gf(t,e){var n=e.checked;return Ne({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Gm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Pr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cw(t,e){e=e.checked,e!=null&&np(t,"checked",e,!1)}function yf(t,e){cw(t,e);var n=Pr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vf(t,e.type,n):e.hasOwnProperty("defaultValue")&&vf(t,e.type,Pr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ym(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vf(t,e,n){(e!=="number"||iu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var mo=Array.isArray;function hs(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Pr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function wf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(V(91));return Ne({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Xm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(V(92));if(mo(n)){if(1<n.length)throw Error(V(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Pr(n)}}function dw(t,e){var n=Pr(e.value),r=Pr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Qm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function fw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?fw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ql,hw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ql=Ql||document.createElement("div"),Ql.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ql.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Uo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var _o={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zE=["Webkit","ms","Moz","O"];Object.keys(_o).forEach(function(t){zE.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),_o[e]=_o[t]})});function pw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||_o.hasOwnProperty(t)&&_o[t]?(""+e).trim():e+"px"}function mw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=pw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var BE=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sf(t,e){if(e){if(BE[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(V(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(V(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(V(61))}if(e.style!=null&&typeof e.style!="object")throw Error(V(62))}}function bf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kf=null;function op(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var _f=null,ps=null,ms=null;function Zm(t){if(t=Pl(t)){if(typeof _f!="function")throw Error(V(280));var e=t.stateNode;e&&(e=lc(e),_f(t.stateNode,t.type,e))}}function gw(t){ps?ms?ms.push(t):ms=[t]:ps=t}function yw(){if(ps){var t=ps,e=ms;if(ms=ps=null,Zm(t),e)for(t=0;t<e.length;t++)Zm(e[t])}}function vw(t,e){return t(e)}function ww(){}var td=!1;function xw(t,e,n){if(td)return t(e,n);td=!0;try{return vw(t,e,n)}finally{td=!1,(ps!==null||ms!==null)&&(ww(),yw())}}function Ho(t,e){var n=t.stateNode;if(n===null)return null;var r=lc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(V(231,e,typeof n));return n}var Ef=!1;if(Wn)try{var no={};Object.defineProperty(no,"passive",{get:function(){Ef=!0}}),window.addEventListener("test",no,no),window.removeEventListener("test",no,no)}catch{Ef=!1}function FE(t,e,n,r,i,s,o,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Eo=!1,su=null,ou=!1,Cf=null,VE={onError:function(t){Eo=!0,su=t}};function UE(t,e,n,r,i,s,o,l,a){Eo=!1,su=null,FE.apply(VE,arguments)}function HE(t,e,n,r,i,s,o,l,a){if(UE.apply(this,arguments),Eo){if(Eo){var u=su;Eo=!1,su=null}else throw Error(V(198));ou||(ou=!0,Cf=u)}}function Ai(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Sw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function eg(t){if(Ai(t)!==t)throw Error(V(188))}function WE(t){var e=t.alternate;if(!e){if(e=Ai(t),e===null)throw Error(V(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return eg(i),t;if(s===r)return eg(i),e;s=s.sibling}throw Error(V(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?t:e}function bw(t){return t=WE(t),t!==null?kw(t):null}function kw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=kw(t);if(e!==null)return e;t=t.sibling}return null}var _w=Lt.unstable_scheduleCallback,tg=Lt.unstable_cancelCallback,qE=Lt.unstable_shouldYield,KE=Lt.unstable_requestPaint,Ie=Lt.unstable_now,JE=Lt.unstable_getCurrentPriorityLevel,lp=Lt.unstable_ImmediatePriority,Ew=Lt.unstable_UserBlockingPriority,lu=Lt.unstable_NormalPriority,GE=Lt.unstable_LowPriority,Cw=Lt.unstable_IdlePriority,rc=null,bn=null;function YE(t){if(bn&&typeof bn.onCommitFiberRoot=="function")try{bn.onCommitFiberRoot(rc,t,void 0,(t.current.flags&128)===128)}catch{}}var fn=Math.clz32?Math.clz32:ZE,XE=Math.log,QE=Math.LN2;function ZE(t){return t>>>=0,t===0?32:31-(XE(t)/QE|0)|0}var Zl=64,ea=4194304;function go(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function au(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=go(l):(s&=o,s!==0&&(r=go(s)))}else o=n&~i,o!==0?r=go(o):s!==0&&(r=go(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-fn(e),i=1<<n,r|=t[n],e&=~i;return r}function eC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tC(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-fn(s),l=1<<o,a=i[o];a===-1?(!(l&n)||l&r)&&(i[o]=eC(l,e)):a<=e&&(t.expiredLanes|=l),s&=~l}}function Tf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Tw(){var t=Zl;return Zl<<=1,!(Zl&4194240)&&(Zl=64),t}function nd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Il(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fn(e),t[e]=n}function nC(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-fn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function ap(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-fn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ge=0;function Nw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ow,up,Mw,Aw,Iw,Nf=!1,ta=[],Sr=null,br=null,kr=null,Wo=new Map,qo=new Map,cr=[],rC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ng(t,e){switch(t){case"focusin":case"focusout":Sr=null;break;case"dragenter":case"dragleave":br=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":Wo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qo.delete(e.pointerId)}}function ro(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Pl(e),e!==null&&up(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function iC(t,e,n,r,i){switch(e){case"focusin":return Sr=ro(Sr,t,e,n,r,i),!0;case"dragenter":return br=ro(br,t,e,n,r,i),!0;case"mouseover":return kr=ro(kr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Wo.set(s,ro(Wo.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,qo.set(s,ro(qo.get(s)||null,t,e,n,r,i)),!0}return!1}function Rw(t){var e=ei(t.target);if(e!==null){var n=Ai(e);if(n!==null){if(e=n.tag,e===13){if(e=Sw(n),e!==null){t.blockedOn=e,Iw(t.priority,function(){Mw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function za(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Of(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);kf=r,n.target.dispatchEvent(r),kf=null}else return e=Pl(n),e!==null&&up(e),t.blockedOn=n,!1;e.shift()}return!0}function rg(t,e,n){za(t)&&n.delete(e)}function sC(){Nf=!1,Sr!==null&&za(Sr)&&(Sr=null),br!==null&&za(br)&&(br=null),kr!==null&&za(kr)&&(kr=null),Wo.forEach(rg),qo.forEach(rg)}function io(t,e){t.blockedOn===e&&(t.blockedOn=null,Nf||(Nf=!0,Lt.unstable_scheduleCallback(Lt.unstable_NormalPriority,sC)))}function Ko(t){function e(i){return io(i,t)}if(0<ta.length){io(ta[0],t);for(var n=1;n<ta.length;n++){var r=ta[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Sr!==null&&io(Sr,t),br!==null&&io(br,t),kr!==null&&io(kr,t),Wo.forEach(e),qo.forEach(e),n=0;n<cr.length;n++)r=cr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<cr.length&&(n=cr[0],n.blockedOn===null);)Rw(n),n.blockedOn===null&&cr.shift()}var gs=Xn.ReactCurrentBatchConfig,uu=!0;function oC(t,e,n,r){var i=ge,s=gs.transition;gs.transition=null;try{ge=1,cp(t,e,n,r)}finally{ge=i,gs.transition=s}}function lC(t,e,n,r){var i=ge,s=gs.transition;gs.transition=null;try{ge=4,cp(t,e,n,r)}finally{ge=i,gs.transition=s}}function cp(t,e,n,r){if(uu){var i=Of(t,e,n,r);if(i===null)fd(t,e,r,cu,n),ng(t,r);else if(iC(i,t,e,n,r))r.stopPropagation();else if(ng(t,r),e&4&&-1<rC.indexOf(t)){for(;i!==null;){var s=Pl(i);if(s!==null&&Ow(s),s=Of(t,e,n,r),s===null&&fd(t,e,r,cu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else fd(t,e,r,null,n)}}var cu=null;function Of(t,e,n,r){if(cu=null,t=op(r),t=ei(t),t!==null)if(e=Ai(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Sw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cu=t,null}function Pw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(JE()){case lp:return 1;case Ew:return 4;case lu:case GE:return 16;case Cw:return 536870912;default:return 16}default:return 16}}var mr=null,dp=null,Ba=null;function Dw(){if(Ba)return Ba;var t,e=dp,n=e.length,r,i="value"in mr?mr.value:mr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Ba=i.slice(t,1<r?1-r:void 0)}function Fa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function na(){return!0}function ig(){return!1}function Bt(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?na:ig,this.isPropagationStopped=ig,this}return Ne(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=na)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=na)},persist:function(){},isPersistent:na}),e}var qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fp=Bt(qs),Rl=Ne({},qs,{view:0,detail:0}),aC=Bt(Rl),rd,id,so,ic=Ne({},Rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==so&&(so&&t.type==="mousemove"?(rd=t.screenX-so.screenX,id=t.screenY-so.screenY):id=rd=0,so=t),rd)},movementY:function(t){return"movementY"in t?t.movementY:id}}),sg=Bt(ic),uC=Ne({},ic,{dataTransfer:0}),cC=Bt(uC),dC=Ne({},Rl,{relatedTarget:0}),sd=Bt(dC),fC=Ne({},qs,{animationName:0,elapsedTime:0,pseudoElement:0}),hC=Bt(fC),pC=Ne({},qs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mC=Bt(pC),gC=Ne({},qs,{data:0}),og=Bt(gC),yC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=wC[t])?!!e[t]:!1}function hp(){return xC}var SC=Ne({},Rl,{key:function(t){if(t.key){var e=yC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Fa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hp,charCode:function(t){return t.type==="keypress"?Fa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Fa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bC=Bt(SC),kC=Ne({},ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lg=Bt(kC),_C=Ne({},Rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hp}),EC=Bt(_C),CC=Ne({},qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),TC=Bt(CC),NC=Ne({},ic,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),OC=Bt(NC),MC=[9,13,27,32],pp=Wn&&"CompositionEvent"in window,Co=null;Wn&&"documentMode"in document&&(Co=document.documentMode);var AC=Wn&&"TextEvent"in window&&!Co,$w=Wn&&(!pp||Co&&8<Co&&11>=Co),ag=" ",ug=!1;function Lw(t,e){switch(t){case"keyup":return MC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xi=!1;function IC(t,e){switch(t){case"compositionend":return jw(e);case"keypress":return e.which!==32?null:(ug=!0,ag);case"textInput":return t=e.data,t===ag&&ug?null:t;default:return null}}function RC(t,e){if(Xi)return t==="compositionend"||!pp&&Lw(t,e)?(t=Dw(),Ba=dp=mr=null,Xi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $w&&e.locale!=="ko"?null:e.data;default:return null}}var PC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PC[t.type]:e==="textarea"}function zw(t,e,n,r){gw(r),e=du(e,"onChange"),0<e.length&&(n=new fp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var To=null,Jo=null;function DC(t){Yw(t,0)}function sc(t){var e=es(t);if(uw(e))return t}function $C(t,e){if(t==="change")return e}var Bw=!1;if(Wn){var od;if(Wn){var ld="oninput"in document;if(!ld){var dg=document.createElement("div");dg.setAttribute("oninput","return;"),ld=typeof dg.oninput=="function"}od=ld}else od=!1;Bw=od&&(!document.documentMode||9<document.documentMode)}function fg(){To&&(To.detachEvent("onpropertychange",Fw),Jo=To=null)}function Fw(t){if(t.propertyName==="value"&&sc(Jo)){var e=[];zw(e,Jo,t,op(t)),xw(DC,e)}}function LC(t,e,n){t==="focusin"?(fg(),To=e,Jo=n,To.attachEvent("onpropertychange",Fw)):t==="focusout"&&fg()}function jC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return sc(Jo)}function zC(t,e){if(t==="click")return sc(e)}function BC(t,e){if(t==="input"||t==="change")return sc(e)}function FC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pn=typeof Object.is=="function"?Object.is:FC;function Go(t,e){if(pn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!df.call(e,i)||!pn(t[i],e[i]))return!1}return!0}function hg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function pg(t,e){var n=hg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hg(n)}}function Vw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Vw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Uw(){for(var t=window,e=iu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=iu(t.document)}return e}function mp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function VC(t){var e=Uw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Vw(n.ownerDocument.documentElement,n)){if(r!==null&&mp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=pg(n,s);var o=pg(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UC=Wn&&"documentMode"in document&&11>=document.documentMode,Qi=null,Mf=null,No=null,Af=!1;function mg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Af||Qi==null||Qi!==iu(r)||(r=Qi,"selectionStart"in r&&mp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),No&&Go(No,r)||(No=r,r=du(Mf,"onSelect"),0<r.length&&(e=new fp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Qi)))}function ra(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zi={animationend:ra("Animation","AnimationEnd"),animationiteration:ra("Animation","AnimationIteration"),animationstart:ra("Animation","AnimationStart"),transitionend:ra("Transition","TransitionEnd")},ad={},Hw={};Wn&&(Hw=document.createElement("div").style,"AnimationEvent"in window||(delete Zi.animationend.animation,delete Zi.animationiteration.animation,delete Zi.animationstart.animation),"TransitionEvent"in window||delete Zi.transitionend.transition);function oc(t){if(ad[t])return ad[t];if(!Zi[t])return t;var e=Zi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Hw)return ad[t]=e[n];return t}var Ww=oc("animationend"),qw=oc("animationiteration"),Kw=oc("animationstart"),Jw=oc("transitionend"),Gw=new Map,gg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(t,e){Gw.set(t,e),Mi(e,[t])}for(var ud=0;ud<gg.length;ud++){var cd=gg[ud],HC=cd.toLowerCase(),WC=cd[0].toUpperCase()+cd.slice(1);Lr(HC,"on"+WC)}Lr(Ww,"onAnimationEnd");Lr(qw,"onAnimationIteration");Lr(Kw,"onAnimationStart");Lr("dblclick","onDoubleClick");Lr("focusin","onFocus");Lr("focusout","onBlur");Lr(Jw,"onTransitionEnd");_s("onMouseEnter",["mouseout","mouseover"]);_s("onMouseLeave",["mouseout","mouseover"]);_s("onPointerEnter",["pointerout","pointerover"]);_s("onPointerLeave",["pointerout","pointerover"]);Mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qC=new Set("cancel close invalid load scroll toggle".split(" ").concat(yo));function yg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,HE(r,e,void 0,t),t.currentTarget=null}function Yw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;yg(i,l,u),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,u=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;yg(i,l,u),s=a}}}if(ou)throw t=Cf,ou=!1,Cf=null,t}function Se(t,e){var n=e[$f];n===void 0&&(n=e[$f]=new Set);var r=t+"__bubble";n.has(r)||(Xw(e,t,2,!1),n.add(r))}function dd(t,e,n){var r=0;e&&(r|=4),Xw(n,t,r,e)}var ia="_reactListening"+Math.random().toString(36).slice(2);function Yo(t){if(!t[ia]){t[ia]=!0,iw.forEach(function(n){n!=="selectionchange"&&(qC.has(n)||dd(n,!1,t),dd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ia]||(e[ia]=!0,dd("selectionchange",!1,e))}}function Xw(t,e,n,r){switch(Pw(e)){case 1:var i=oC;break;case 4:i=lC;break;default:i=cp}n=i.bind(null,e,n,t),i=void 0,!Ef||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function fd(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=ei(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}xw(function(){var u=s,c=op(n),d=[];e:{var f=Gw.get(t);if(f!==void 0){var h=fp,p=t;switch(t){case"keypress":if(Fa(n)===0)break e;case"keydown":case"keyup":h=bC;break;case"focusin":p="focus",h=sd;break;case"focusout":p="blur",h=sd;break;case"beforeblur":case"afterblur":h=sd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=sg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=cC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=EC;break;case Ww:case qw:case Kw:h=hC;break;case Jw:h=TC;break;case"scroll":h=aC;break;case"wheel":h=OC;break;case"copy":case"cut":case"paste":h=mC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=lg}var m=(e&4)!==0,v=!m&&t==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var w=u,y;w!==null;){y=w;var x=y.stateNode;if(y.tag===5&&x!==null&&(y=x,g!==null&&(x=Ho(w,g),x!=null&&m.push(Xo(w,x,y)))),v)break;w=w.return}0<m.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==kf&&(p=n.relatedTarget||n.fromElement)&&(ei(p)||p[qn]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=u,p=p?ei(p):null,p!==null&&(v=Ai(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(m=sg,x="onMouseLeave",g="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(m=lg,x="onPointerLeave",g="onPointerEnter",w="pointer"),v=h==null?f:es(h),y=p==null?f:es(p),f=new m(x,w+"leave",h,n,c),f.target=v,f.relatedTarget=y,x=null,ei(c)===u&&(m=new m(g,w+"enter",p,n,c),m.target=y,m.relatedTarget=v,x=m),v=x,h&&p)t:{for(m=h,g=p,w=0,y=m;y;y=Pi(y))w++;for(y=0,x=g;x;x=Pi(x))y++;for(;0<w-y;)m=Pi(m),w--;for(;0<y-w;)g=Pi(g),y--;for(;w--;){if(m===g||g!==null&&m===g.alternate)break t;m=Pi(m),g=Pi(g)}m=null}else m=null;h!==null&&vg(d,f,h,m,!1),p!==null&&v!==null&&vg(d,v,p,m,!0)}}e:{if(f=u?es(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var k=$C;else if(cg(f))if(Bw)k=BC;else{k=jC;var S=LC}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=zC);if(k&&(k=k(t,u))){zw(d,k,n,c);break e}S&&S(t,f,u),t==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&vf(f,"number",f.value)}switch(S=u?es(u):window,t){case"focusin":(cg(S)||S.contentEditable==="true")&&(Qi=S,Mf=u,No=null);break;case"focusout":No=Mf=Qi=null;break;case"mousedown":Af=!0;break;case"contextmenu":case"mouseup":case"dragend":Af=!1,mg(d,n,c);break;case"selectionchange":if(UC)break;case"keydown":case"keyup":mg(d,n,c)}var b;if(pp)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Xi?Lw(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&($w&&n.locale!=="ko"&&(Xi||E!=="onCompositionStart"?E==="onCompositionEnd"&&Xi&&(b=Dw()):(mr=c,dp="value"in mr?mr.value:mr.textContent,Xi=!0)),S=du(u,E),0<S.length&&(E=new og(E,t,null,n,c),d.push({event:E,listeners:S}),b?E.data=b:(b=jw(n),b!==null&&(E.data=b)))),(b=AC?IC(t,n):RC(t,n))&&(u=du(u,"onBeforeInput"),0<u.length&&(c=new og("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=b))}Yw(d,e)})}function Xo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function du(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ho(t,n),s!=null&&r.unshift(Xo(t,s,i)),s=Ho(t,e),s!=null&&r.push(Xo(t,s,i))),t=t.return}return r}function Pi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function vg(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=Ho(n,s),a!=null&&o.unshift(Xo(n,a,l))):i||(a=Ho(n,s),a!=null&&o.push(Xo(n,a,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var KC=/\r\n?/g,JC=/\u0000|\uFFFD/g;function wg(t){return(typeof t=="string"?t:""+t).replace(KC,`
`).replace(JC,"")}function sa(t,e,n){if(e=wg(e),wg(t)!==e&&n)throw Error(V(425))}function fu(){}var If=null,Rf=null;function Pf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Df=typeof setTimeout=="function"?setTimeout:void 0,GC=typeof clearTimeout=="function"?clearTimeout:void 0,xg=typeof Promise=="function"?Promise:void 0,YC=typeof queueMicrotask=="function"?queueMicrotask:typeof xg<"u"?function(t){return xg.resolve(null).then(t).catch(XC)}:Df;function XC(t){setTimeout(function(){throw t})}function hd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ko(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ko(e)}function _r(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Sg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ks=Math.random().toString(36).slice(2),xn="__reactFiber$"+Ks,Qo="__reactProps$"+Ks,qn="__reactContainer$"+Ks,$f="__reactEvents$"+Ks,QC="__reactListeners$"+Ks,ZC="__reactHandles$"+Ks;function ei(t){var e=t[xn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[qn]||n[xn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Sg(t);t!==null;){if(n=t[xn])return n;t=Sg(t)}return e}t=n,n=t.parentNode}return null}function Pl(t){return t=t[xn]||t[qn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function es(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(V(33))}function lc(t){return t[Qo]||null}var Lf=[],ts=-1;function jr(t){return{current:t}}function be(t){0>ts||(t.current=Lf[ts],Lf[ts]=null,ts--)}function we(t,e){ts++,Lf[ts]=t.current,t.current=e}var Dr={},ut=jr(Dr),kt=jr(!1),yi=Dr;function Es(t,e){var n=t.type.contextTypes;if(!n)return Dr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function _t(t){return t=t.childContextTypes,t!=null}function hu(){be(kt),be(ut)}function bg(t,e,n){if(ut.current!==Dr)throw Error(V(168));we(ut,e),we(kt,n)}function Qw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(V(108,LE(t)||"Unknown",i));return Ne({},n,r)}function pu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Dr,yi=ut.current,we(ut,t),we(kt,kt.current),!0}function kg(t,e,n){var r=t.stateNode;if(!r)throw Error(V(169));n?(t=Qw(t,e,yi),r.__reactInternalMemoizedMergedChildContext=t,be(kt),be(ut),we(ut,t)):be(kt),we(kt,n)}var $n=null,ac=!1,pd=!1;function Zw(t){$n===null?$n=[t]:$n.push(t)}function eT(t){ac=!0,Zw(t)}function zr(){if(!pd&&$n!==null){pd=!0;var t=0,e=ge;try{var n=$n;for(ge=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$n=null,ac=!1}catch(i){throw $n!==null&&($n=$n.slice(t+1)),_w(lp,zr),i}finally{ge=e,pd=!1}}return null}var ns=[],rs=0,mu=null,gu=0,Vt=[],Ut=0,vi=null,Ln=1,jn="";function qr(t,e){ns[rs++]=gu,ns[rs++]=mu,mu=t,gu=e}function ex(t,e,n){Vt[Ut++]=Ln,Vt[Ut++]=jn,Vt[Ut++]=vi,vi=t;var r=Ln;t=jn;var i=32-fn(r)-1;r&=~(1<<i),n+=1;var s=32-fn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ln=1<<32-fn(e)+i|n<<i|r,jn=s+t}else Ln=1<<s|n<<i|r,jn=t}function gp(t){t.return!==null&&(qr(t,1),ex(t,1,0))}function yp(t){for(;t===mu;)mu=ns[--rs],ns[rs]=null,gu=ns[--rs],ns[rs]=null;for(;t===vi;)vi=Vt[--Ut],Vt[Ut]=null,jn=Vt[--Ut],Vt[Ut]=null,Ln=Vt[--Ut],Vt[Ut]=null}var Dt=null,Pt=null,ke=!1,ln=null;function tx(t,e){var n=Wt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function _g(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Dt=t,Pt=_r(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Dt=t,Pt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vi!==null?{id:Ln,overflow:jn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Wt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Dt=t,Pt=null,!0):!1;default:return!1}}function jf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zf(t){if(ke){var e=Pt;if(e){var n=e;if(!_g(t,e)){if(jf(t))throw Error(V(418));e=_r(n.nextSibling);var r=Dt;e&&_g(t,e)?tx(r,n):(t.flags=t.flags&-4097|2,ke=!1,Dt=t)}}else{if(jf(t))throw Error(V(418));t.flags=t.flags&-4097|2,ke=!1,Dt=t}}}function Eg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dt=t}function oa(t){if(t!==Dt)return!1;if(!ke)return Eg(t),ke=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Pf(t.type,t.memoizedProps)),e&&(e=Pt)){if(jf(t))throw nx(),Error(V(418));for(;e;)tx(t,e),e=_r(e.nextSibling)}if(Eg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(V(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Pt=_r(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Pt=null}}else Pt=Dt?_r(t.stateNode.nextSibling):null;return!0}function nx(){for(var t=Pt;t;)t=_r(t.nextSibling)}function Cs(){Pt=Dt=null,ke=!1}function vp(t){ln===null?ln=[t]:ln.push(t)}var tT=Xn.ReactCurrentBatchConfig;function oo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,t))}return t}function la(t,e){throw t=Object.prototype.toString.call(e),Error(V(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Cg(t){var e=t._init;return e(t._payload)}function rx(t){function e(g,w){if(t){var y=g.deletions;y===null?(g.deletions=[w],g.flags|=16):y.push(w)}}function n(g,w){if(!t)return null;for(;w!==null;)e(g,w),w=w.sibling;return null}function r(g,w){for(g=new Map;w!==null;)w.key!==null?g.set(w.key,w):g.set(w.index,w),w=w.sibling;return g}function i(g,w){return g=Nr(g,w),g.index=0,g.sibling=null,g}function s(g,w,y){return g.index=y,t?(y=g.alternate,y!==null?(y=y.index,y<w?(g.flags|=2,w):y):(g.flags|=2,w)):(g.flags|=1048576,w)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,w,y,x){return w===null||w.tag!==6?(w=Sd(y,g.mode,x),w.return=g,w):(w=i(w,y),w.return=g,w)}function a(g,w,y,x){var k=y.type;return k===Yi?c(g,w,y.props.children,x,y.key):w!==null&&(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===sr&&Cg(k)===w.type)?(x=i(w,y.props),x.ref=oo(g,w,y),x.return=g,x):(x=Ja(y.type,y.key,y.props,null,g.mode,x),x.ref=oo(g,w,y),x.return=g,x)}function u(g,w,y,x){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=bd(y,g.mode,x),w.return=g,w):(w=i(w,y.children||[]),w.return=g,w)}function c(g,w,y,x,k){return w===null||w.tag!==7?(w=ui(y,g.mode,x,k),w.return=g,w):(w=i(w,y),w.return=g,w)}function d(g,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Sd(""+w,g.mode,y),w.return=g,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Yl:return y=Ja(w.type,w.key,w.props,null,g.mode,y),y.ref=oo(g,null,w),y.return=g,y;case Gi:return w=bd(w,g.mode,y),w.return=g,w;case sr:var x=w._init;return d(g,x(w._payload),y)}if(mo(w)||to(w))return w=ui(w,g.mode,y,null),w.return=g,w;la(g,w)}return null}function f(g,w,y,x){var k=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return k!==null?null:l(g,w,""+y,x);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Yl:return y.key===k?a(g,w,y,x):null;case Gi:return y.key===k?u(g,w,y,x):null;case sr:return k=y._init,f(g,w,k(y._payload),x)}if(mo(y)||to(y))return k!==null?null:c(g,w,y,x,null);la(g,y)}return null}function h(g,w,y,x,k){if(typeof x=="string"&&x!==""||typeof x=="number")return g=g.get(y)||null,l(w,g,""+x,k);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Yl:return g=g.get(x.key===null?y:x.key)||null,a(w,g,x,k);case Gi:return g=g.get(x.key===null?y:x.key)||null,u(w,g,x,k);case sr:var S=x._init;return h(g,w,y,S(x._payload),k)}if(mo(x)||to(x))return g=g.get(y)||null,c(w,g,x,k,null);la(w,x)}return null}function p(g,w,y,x){for(var k=null,S=null,b=w,E=w=0,O=null;b!==null&&E<y.length;E++){b.index>E?(O=b,b=null):O=b.sibling;var L=f(g,b,y[E],x);if(L===null){b===null&&(b=O);break}t&&b&&L.alternate===null&&e(g,b),w=s(L,w,E),S===null?k=L:S.sibling=L,S=L,b=O}if(E===y.length)return n(g,b),ke&&qr(g,E),k;if(b===null){for(;E<y.length;E++)b=d(g,y[E],x),b!==null&&(w=s(b,w,E),S===null?k=b:S.sibling=b,S=b);return ke&&qr(g,E),k}for(b=r(g,b);E<y.length;E++)O=h(b,g,E,y[E],x),O!==null&&(t&&O.alternate!==null&&b.delete(O.key===null?E:O.key),w=s(O,w,E),S===null?k=O:S.sibling=O,S=O);return t&&b.forEach(function(A){return e(g,A)}),ke&&qr(g,E),k}function m(g,w,y,x){var k=to(y);if(typeof k!="function")throw Error(V(150));if(y=k.call(y),y==null)throw Error(V(151));for(var S=k=null,b=w,E=w=0,O=null,L=y.next();b!==null&&!L.done;E++,L=y.next()){b.index>E?(O=b,b=null):O=b.sibling;var A=f(g,b,L.value,x);if(A===null){b===null&&(b=O);break}t&&b&&A.alternate===null&&e(g,b),w=s(A,w,E),S===null?k=A:S.sibling=A,S=A,b=O}if(L.done)return n(g,b),ke&&qr(g,E),k;if(b===null){for(;!L.done;E++,L=y.next())L=d(g,L.value,x),L!==null&&(w=s(L,w,E),S===null?k=L:S.sibling=L,S=L);return ke&&qr(g,E),k}for(b=r(g,b);!L.done;E++,L=y.next())L=h(b,g,E,L.value,x),L!==null&&(t&&L.alternate!==null&&b.delete(L.key===null?E:L.key),w=s(L,w,E),S===null?k=L:S.sibling=L,S=L);return t&&b.forEach(function(P){return e(g,P)}),ke&&qr(g,E),k}function v(g,w,y,x){if(typeof y=="object"&&y!==null&&y.type===Yi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Yl:e:{for(var k=y.key,S=w;S!==null;){if(S.key===k){if(k=y.type,k===Yi){if(S.tag===7){n(g,S.sibling),w=i(S,y.props.children),w.return=g,g=w;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===sr&&Cg(k)===S.type){n(g,S.sibling),w=i(S,y.props),w.ref=oo(g,S,y),w.return=g,g=w;break e}n(g,S);break}else e(g,S);S=S.sibling}y.type===Yi?(w=ui(y.props.children,g.mode,x,y.key),w.return=g,g=w):(x=Ja(y.type,y.key,y.props,null,g.mode,x),x.ref=oo(g,w,y),x.return=g,g=x)}return o(g);case Gi:e:{for(S=y.key;w!==null;){if(w.key===S)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){n(g,w.sibling),w=i(w,y.children||[]),w.return=g,g=w;break e}else{n(g,w);break}else e(g,w);w=w.sibling}w=bd(y,g.mode,x),w.return=g,g=w}return o(g);case sr:return S=y._init,v(g,w,S(y._payload),x)}if(mo(y))return p(g,w,y,x);if(to(y))return m(g,w,y,x);la(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(n(g,w.sibling),w=i(w,y),w.return=g,g=w):(n(g,w),w=Sd(y,g.mode,x),w.return=g,g=w),o(g)):n(g,w)}return v}var Ts=rx(!0),ix=rx(!1),yu=jr(null),vu=null,is=null,wp=null;function xp(){wp=is=vu=null}function Sp(t){var e=yu.current;be(yu),t._currentValue=e}function Bf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ys(t,e){vu=t,wp=is=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(St=!0),t.firstContext=null)}function Yt(t){var e=t._currentValue;if(wp!==t)if(t={context:t,memoizedValue:e,next:null},is===null){if(vu===null)throw Error(V(308));is=t,vu.dependencies={lanes:0,firstContext:t}}else is=is.next=t;return e}var ti=null;function bp(t){ti===null?ti=[t]:ti.push(t)}function sx(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,bp(e)):(n.next=i.next,i.next=n),e.interleaved=n,Kn(t,r)}function Kn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var or=!1;function kp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ox(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Er(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,he&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Kn(t,n)}return i=r.interleaved,i===null?(e.next=e,bp(r)):(e.next=i.next,i.next=e),r.interleaved=e,Kn(t,n)}function Va(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ap(t,n)}}function Tg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function wu(t,e,n,r){var i=t.updateQueue;or=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,o===null?s=u:o.next=u,o=a;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==o&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(s!==null){var d=i.baseState;o=0,c=u=a=null,l=s;do{var f=l.lane,h=l.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=t,m=l;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Ne({},d,f);break e;case 2:or=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=h,a=d):c=c.next=h,o|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(a=d),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);xi|=o,t.lanes=o,t.memoizedState=d}}function Ng(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(V(191,i));i.call(r)}}}var Dl={},kn=jr(Dl),Zo=jr(Dl),el=jr(Dl);function ni(t){if(t===Dl)throw Error(V(174));return t}function _p(t,e){switch(we(el,e),we(Zo,t),we(kn,Dl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=xf(e,t)}be(kn),we(kn,e)}function Ns(){be(kn),be(Zo),be(el)}function lx(t){ni(el.current);var e=ni(kn.current),n=xf(e,t.type);e!==n&&(we(Zo,t),we(kn,n))}function Ep(t){Zo.current===t&&(be(kn),be(Zo))}var Ce=jr(0);function xu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var md=[];function Cp(){for(var t=0;t<md.length;t++)md[t]._workInProgressVersionPrimary=null;md.length=0}var Ua=Xn.ReactCurrentDispatcher,gd=Xn.ReactCurrentBatchConfig,wi=0,Te=null,je=null,Fe=null,Su=!1,Oo=!1,tl=0,nT=0;function st(){throw Error(V(321))}function Tp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!pn(t[n],e[n]))return!1;return!0}function Np(t,e,n,r,i,s){if(wi=s,Te=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ua.current=t===null||t.memoizedState===null?oT:lT,t=n(r,i),Oo){s=0;do{if(Oo=!1,tl=0,25<=s)throw Error(V(301));s+=1,Fe=je=null,e.updateQueue=null,Ua.current=aT,t=n(r,i)}while(Oo)}if(Ua.current=bu,e=je!==null&&je.next!==null,wi=0,Fe=je=Te=null,Su=!1,e)throw Error(V(300));return t}function Op(){var t=tl!==0;return tl=0,t}function yn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fe===null?Te.memoizedState=Fe=t:Fe=Fe.next=t,Fe}function Xt(){if(je===null){var t=Te.alternate;t=t!==null?t.memoizedState:null}else t=je.next;var e=Fe===null?Te.memoizedState:Fe.next;if(e!==null)Fe=e,je=t;else{if(t===null)throw Error(V(310));je=t,t={memoizedState:je.memoizedState,baseState:je.baseState,baseQueue:je.baseQueue,queue:je.queue,next:null},Fe===null?Te.memoizedState=Fe=t:Fe=Fe.next=t}return Fe}function nl(t,e){return typeof e=="function"?e(t):e}function yd(t){var e=Xt(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=je,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,u=s;do{var c=u.lane;if((wi&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=d,o=r):a=a.next=d,Te.lanes|=c,xi|=c}u=u.next}while(u!==null&&u!==s);a===null?o=r:a.next=l,pn(r,e.memoizedState)||(St=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Te.lanes|=s,xi|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function vd(t){var e=Xt(),n=e.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);pn(s,e.memoizedState)||(St=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function ax(){}function ux(t,e){var n=Te,r=Xt(),i=e(),s=!pn(r.memoizedState,i);if(s&&(r.memoizedState=i,St=!0),r=r.queue,Mp(fx.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Fe!==null&&Fe.memoizedState.tag&1){if(n.flags|=2048,rl(9,dx.bind(null,n,r,i,e),void 0,null),He===null)throw Error(V(349));wi&30||cx(n,e,i)}return i}function cx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Te.updateQueue,e===null?(e={lastEffect:null,stores:null},Te.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function dx(t,e,n,r){e.value=n,e.getSnapshot=r,hx(e)&&px(t)}function fx(t,e,n){return n(function(){hx(e)&&px(t)})}function hx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!pn(t,n)}catch{return!0}}function px(t){var e=Kn(t,1);e!==null&&hn(e,t,1,-1)}function Og(t){var e=yn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nl,lastRenderedState:t},e.queue=t,t=t.dispatch=sT.bind(null,Te,t),[e.memoizedState,t]}function rl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Te.updateQueue,e===null?(e={lastEffect:null,stores:null},Te.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function mx(){return Xt().memoizedState}function Ha(t,e,n,r){var i=yn();Te.flags|=t,i.memoizedState=rl(1|e,n,void 0,r===void 0?null:r)}function uc(t,e,n,r){var i=Xt();r=r===void 0?null:r;var s=void 0;if(je!==null){var o=je.memoizedState;if(s=o.destroy,r!==null&&Tp(r,o.deps)){i.memoizedState=rl(e,n,s,r);return}}Te.flags|=t,i.memoizedState=rl(1|e,n,s,r)}function Mg(t,e){return Ha(8390656,8,t,e)}function Mp(t,e){return uc(2048,8,t,e)}function gx(t,e){return uc(4,2,t,e)}function yx(t,e){return uc(4,4,t,e)}function vx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function wx(t,e,n){return n=n!=null?n.concat([t]):null,uc(4,4,vx.bind(null,e,t),n)}function Ap(){}function xx(t,e){var n=Xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Tp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Sx(t,e){var n=Xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Tp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function bx(t,e,n){return wi&21?(pn(n,e)||(n=Tw(),Te.lanes|=n,xi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,St=!0),t.memoizedState=n)}function rT(t,e){var n=ge;ge=n!==0&&4>n?n:4,t(!0);var r=gd.transition;gd.transition={};try{t(!1),e()}finally{ge=n,gd.transition=r}}function kx(){return Xt().memoizedState}function iT(t,e,n){var r=Tr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_x(t))Ex(e,n);else if(n=sx(t,e,n,r),n!==null){var i=pt();hn(n,t,r,i),Cx(n,e,r)}}function sT(t,e,n){var r=Tr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_x(t))Ex(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,pn(l,o)){var a=e.interleaved;a===null?(i.next=i,bp(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=sx(t,e,i,r),n!==null&&(i=pt(),hn(n,t,r,i),Cx(n,e,r))}}function _x(t){var e=t.alternate;return t===Te||e!==null&&e===Te}function Ex(t,e){Oo=Su=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Cx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ap(t,n)}}var bu={readContext:Yt,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useInsertionEffect:st,useLayoutEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useMutableSource:st,useSyncExternalStore:st,useId:st,unstable_isNewReconciler:!1},oT={readContext:Yt,useCallback:function(t,e){return yn().memoizedState=[t,e===void 0?null:e],t},useContext:Yt,useEffect:Mg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ha(4194308,4,vx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ha(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ha(4,2,t,e)},useMemo:function(t,e){var n=yn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=yn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=iT.bind(null,Te,t),[r.memoizedState,t]},useRef:function(t){var e=yn();return t={current:t},e.memoizedState=t},useState:Og,useDebugValue:Ap,useDeferredValue:function(t){return yn().memoizedState=t},useTransition:function(){var t=Og(!1),e=t[0];return t=rT.bind(null,t[1]),yn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Te,i=yn();if(ke){if(n===void 0)throw Error(V(407));n=n()}else{if(n=e(),He===null)throw Error(V(349));wi&30||cx(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Mg(fx.bind(null,r,s,t),[t]),r.flags|=2048,rl(9,dx.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=yn(),e=He.identifierPrefix;if(ke){var n=jn,r=Ln;n=(r&~(1<<32-fn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=tl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=nT++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},lT={readContext:Yt,useCallback:xx,useContext:Yt,useEffect:Mp,useImperativeHandle:wx,useInsertionEffect:gx,useLayoutEffect:yx,useMemo:Sx,useReducer:yd,useRef:mx,useState:function(){return yd(nl)},useDebugValue:Ap,useDeferredValue:function(t){var e=Xt();return bx(e,je.memoizedState,t)},useTransition:function(){var t=yd(nl)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:ax,useSyncExternalStore:ux,useId:kx,unstable_isNewReconciler:!1},aT={readContext:Yt,useCallback:xx,useContext:Yt,useEffect:Mp,useImperativeHandle:wx,useInsertionEffect:gx,useLayoutEffect:yx,useMemo:Sx,useReducer:vd,useRef:mx,useState:function(){return vd(nl)},useDebugValue:Ap,useDeferredValue:function(t){var e=Xt();return je===null?e.memoizedState=t:bx(e,je.memoizedState,t)},useTransition:function(){var t=vd(nl)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:ax,useSyncExternalStore:ux,useId:kx,unstable_isNewReconciler:!1};function tn(t,e){if(t&&t.defaultProps){e=Ne({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ff(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ne({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var cc={isMounted:function(t){return(t=t._reactInternals)?Ai(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pt(),i=Tr(t),s=Fn(r,i);s.payload=e,n!=null&&(s.callback=n),e=Er(t,s,i),e!==null&&(hn(e,t,i,r),Va(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pt(),i=Tr(t),s=Fn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Er(t,s,i),e!==null&&(hn(e,t,i,r),Va(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pt(),r=Tr(t),i=Fn(n,r);i.tag=2,e!=null&&(i.callback=e),e=Er(t,i,r),e!==null&&(hn(e,t,r,n),Va(e,t,r))}};function Ag(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Go(n,r)||!Go(i,s):!0}function Tx(t,e,n){var r=!1,i=Dr,s=e.contextType;return typeof s=="object"&&s!==null?s=Yt(s):(i=_t(e)?yi:ut.current,r=e.contextTypes,s=(r=r!=null)?Es(t,i):Dr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Ig(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&cc.enqueueReplaceState(e,e.state,null)}function Vf(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},kp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Yt(s):(s=_t(e)?yi:ut.current,i.context=Es(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ff(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&cc.enqueueReplaceState(i,i.state,null),wu(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Os(t,e){try{var n="",r=e;do n+=$E(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function wd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Uf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var uT=typeof WeakMap=="function"?WeakMap:Map;function Nx(t,e,n){n=Fn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_u||(_u=!0,Zf=r),Uf(t,e)},n}function Ox(t,e,n){n=Fn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Uf(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Uf(t,e),typeof r!="function"&&(Cr===null?Cr=new Set([this]):Cr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Rg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new uT;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=kT.bind(null,t,e,n),e.then(t,t))}function Pg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Dg(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fn(-1,1),e.tag=2,Er(n,e,1))),n.lanes|=1),t)}var cT=Xn.ReactCurrentOwner,St=!1;function ht(t,e,n,r){e.child=t===null?ix(e,null,n,r):Ts(e,t.child,n,r)}function $g(t,e,n,r,i){n=n.render;var s=e.ref;return ys(e,i),r=Np(t,e,n,r,s,i),n=Op(),t!==null&&!St?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jn(t,e,i)):(ke&&n&&gp(e),e.flags|=1,ht(t,e,r,i),e.child)}function Lg(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!zp(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Mx(t,e,s,r,i)):(t=Ja(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Go,n(o,r)&&t.ref===e.ref)return Jn(t,e,i)}return e.flags|=1,t=Nr(s,r),t.ref=e.ref,t.return=e,e.child=t}function Mx(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Go(s,r)&&t.ref===e.ref)if(St=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(St=!0);else return e.lanes=t.lanes,Jn(t,e,i)}return Hf(t,e,n,r,i)}function Ax(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},we(ls,Mt),Mt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,we(ls,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,we(ls,Mt),Mt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,we(ls,Mt),Mt|=r;return ht(t,e,i,n),e.child}function Ix(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Hf(t,e,n,r,i){var s=_t(n)?yi:ut.current;return s=Es(e,s),ys(e,i),n=Np(t,e,n,r,s,i),r=Op(),t!==null&&!St?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jn(t,e,i)):(ke&&r&&gp(e),e.flags|=1,ht(t,e,n,i),e.child)}function jg(t,e,n,r,i){if(_t(n)){var s=!0;pu(e)}else s=!1;if(ys(e,i),e.stateNode===null)Wa(t,e),Tx(e,n,r),Vf(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Yt(u):(u=_t(n)?yi:ut.current,u=Es(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==u)&&Ig(e,o,r,u),or=!1;var f=e.memoizedState;o.state=f,wu(e,r,o,i),a=e.memoizedState,l!==r||f!==a||kt.current||or?(typeof c=="function"&&(Ff(e,n,c,r),a=e.memoizedState),(l=or||Ag(e,n,l,r,f,a,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,ox(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:tn(e.type,l),o.props=u,d=e.pendingProps,f=o.context,a=n.contextType,typeof a=="object"&&a!==null?a=Yt(a):(a=_t(n)?yi:ut.current,a=Es(e,a));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==a)&&Ig(e,o,r,a),or=!1,f=e.memoizedState,o.state=f,wu(e,r,o,i);var p=e.memoizedState;l!==d||f!==p||kt.current||or?(typeof h=="function"&&(Ff(e,n,h,r),p=e.memoizedState),(u=or||Ag(e,n,u,r,f,p,a)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=a,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Wf(t,e,n,r,s,i)}function Wf(t,e,n,r,i,s){Ix(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&kg(e,n,!1),Jn(t,e,s);r=e.stateNode,cT.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ts(e,t.child,null,s),e.child=Ts(e,null,l,s)):ht(t,e,l,s),e.memoizedState=r.state,i&&kg(e,n,!0),e.child}function Rx(t){var e=t.stateNode;e.pendingContext?bg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bg(t,e.context,!1),_p(t,e.containerInfo)}function zg(t,e,n,r,i){return Cs(),vp(i),e.flags|=256,ht(t,e,n,r),e.child}var qf={dehydrated:null,treeContext:null,retryLane:0};function Kf(t){return{baseLanes:t,cachePool:null,transitions:null}}function Px(t,e,n){var r=e.pendingProps,i=Ce.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),we(Ce,i&1),t===null)return zf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=hc(o,r,0,null),t=ui(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Kf(n),e.memoizedState=qf,t):Ip(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return dT(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=Nr(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Nr(l,s):(s=ui(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Kf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=qf,r}return s=t.child,t=s.sibling,r=Nr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ip(t,e){return e=hc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function aa(t,e,n,r){return r!==null&&vp(r),Ts(e,t.child,null,n),t=Ip(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dT(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=wd(Error(V(422))),aa(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=hc({mode:"visible",children:r.children},i,0,null),s=ui(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ts(e,t.child,null,o),e.child.memoizedState=Kf(o),e.memoizedState=qf,s);if(!(e.mode&1))return aa(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(V(419)),r=wd(s,r,void 0),aa(t,e,o,r)}if(l=(o&t.childLanes)!==0,St||l){if(r=He,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Kn(t,i),hn(r,t,i,-1))}return jp(),r=wd(Error(V(421))),aa(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=_T.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Pt=_r(i.nextSibling),Dt=e,ke=!0,ln=null,t!==null&&(Vt[Ut++]=Ln,Vt[Ut++]=jn,Vt[Ut++]=vi,Ln=t.id,jn=t.overflow,vi=e),e=Ip(e,r.children),e.flags|=4096,e)}function Bg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Bf(t.return,e,n)}function xd(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Dx(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ht(t,e,r.children,n),r=Ce.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bg(t,n,e);else if(t.tag===19)Bg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(we(Ce,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&xu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),xd(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&xu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}xd(e,!0,n,null,s);break;case"together":xd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(V(153));if(e.child!==null){for(t=e.child,n=Nr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Nr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function fT(t,e,n){switch(e.tag){case 3:Rx(e),Cs();break;case 5:lx(e);break;case 1:_t(e.type)&&pu(e);break;case 4:_p(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;we(yu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(we(Ce,Ce.current&1),e.flags|=128,null):n&e.child.childLanes?Px(t,e,n):(we(Ce,Ce.current&1),t=Jn(t,e,n),t!==null?t.sibling:null);we(Ce,Ce.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Dx(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),we(Ce,Ce.current),r)break;return null;case 22:case 23:return e.lanes=0,Ax(t,e,n)}return Jn(t,e,n)}var $x,Jf,Lx,jx;$x=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Jf=function(){};Lx=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ni(kn.current);var s=null;switch(n){case"input":i=gf(t,i),r=gf(t,r),s=[];break;case"select":i=Ne({},i,{value:void 0}),r=Ne({},r,{value:void 0}),s=[];break;case"textarea":i=wf(t,i),r=wf(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fu)}Sf(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Vo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(n||(n={}),n[o]=a[o])}else n||(s||(s=[]),s.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Vo.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&Se("scroll",t),s||l===a||(s=[])):(s=s||[]).push(u,a))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};jx=function(t,e,n,r){n!==r&&(e.flags|=4)};function lo(t,e){if(!ke)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ot(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function hT(t,e,n){var r=e.pendingProps;switch(yp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ot(e),null;case 1:return _t(e.type)&&hu(),ot(e),null;case 3:return r=e.stateNode,Ns(),be(kt),be(ut),Cp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(oa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ln!==null&&(nh(ln),ln=null))),Jf(t,e),ot(e),null;case 5:Ep(e);var i=ni(el.current);if(n=e.type,t!==null&&e.stateNode!=null)Lx(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(V(166));return ot(e),null}if(t=ni(kn.current),oa(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[xn]=e,r[Qo]=s,t=(e.mode&1)!==0,n){case"dialog":Se("cancel",r),Se("close",r);break;case"iframe":case"object":case"embed":Se("load",r);break;case"video":case"audio":for(i=0;i<yo.length;i++)Se(yo[i],r);break;case"source":Se("error",r);break;case"img":case"image":case"link":Se("error",r),Se("load",r);break;case"details":Se("toggle",r);break;case"input":Gm(r,s),Se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Se("invalid",r);break;case"textarea":Xm(r,s),Se("invalid",r)}Sf(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&sa(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&sa(r.textContent,l,t),i=["children",""+l]):Vo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Se("scroll",r)}switch(n){case"input":Xl(r),Ym(r,s,!0);break;case"textarea":Xl(r),Qm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=fu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=fw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[xn]=e,t[Qo]=r,$x(t,e,!1,!1),e.stateNode=t;e:{switch(o=bf(n,r),n){case"dialog":Se("cancel",t),Se("close",t),i=r;break;case"iframe":case"object":case"embed":Se("load",t),i=r;break;case"video":case"audio":for(i=0;i<yo.length;i++)Se(yo[i],t);i=r;break;case"source":Se("error",t),i=r;break;case"img":case"image":case"link":Se("error",t),Se("load",t),i=r;break;case"details":Se("toggle",t),i=r;break;case"input":Gm(t,r),i=gf(t,r),Se("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ne({},r,{value:void 0}),Se("invalid",t);break;case"textarea":Xm(t,r),i=wf(t,r),Se("invalid",t);break;default:i=r}Sf(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?mw(t,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&hw(t,a)):s==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Uo(t,a):typeof a=="number"&&Uo(t,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Vo.hasOwnProperty(s)?a!=null&&s==="onScroll"&&Se("scroll",t):a!=null&&np(t,s,a,o))}switch(n){case"input":Xl(t),Ym(t,r,!1);break;case"textarea":Xl(t),Qm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Pr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?hs(t,!!r.multiple,s,!1):r.defaultValue!=null&&hs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=fu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ot(e),null;case 6:if(t&&e.stateNode!=null)jx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(V(166));if(n=ni(el.current),ni(kn.current),oa(e)){if(r=e.stateNode,n=e.memoizedProps,r[xn]=e,(s=r.nodeValue!==n)&&(t=Dt,t!==null))switch(t.tag){case 3:sa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&sa(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xn]=e,e.stateNode=r}return ot(e),null;case 13:if(be(Ce),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ke&&Pt!==null&&e.mode&1&&!(e.flags&128))nx(),Cs(),e.flags|=98560,s=!1;else if(s=oa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(V(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(V(317));s[xn]=e}else Cs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ot(e),s=!1}else ln!==null&&(nh(ln),ln=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ce.current&1?Be===0&&(Be=3):jp())),e.updateQueue!==null&&(e.flags|=4),ot(e),null);case 4:return Ns(),Jf(t,e),t===null&&Yo(e.stateNode.containerInfo),ot(e),null;case 10:return Sp(e.type._context),ot(e),null;case 17:return _t(e.type)&&hu(),ot(e),null;case 19:if(be(Ce),s=e.memoizedState,s===null)return ot(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)lo(s,!1);else{if(Be!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=xu(t),o!==null){for(e.flags|=128,lo(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return we(Ce,Ce.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ie()>Ms&&(e.flags|=128,r=!0,lo(s,!1),e.lanes=4194304)}else{if(!r)if(t=xu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),lo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ke)return ot(e),null}else 2*Ie()-s.renderingStartTime>Ms&&n!==1073741824&&(e.flags|=128,r=!0,lo(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ie(),e.sibling=null,n=Ce.current,we(Ce,r?n&1|2:n&1),e):(ot(e),null);case 22:case 23:return Lp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mt&1073741824&&(ot(e),e.subtreeFlags&6&&(e.flags|=8192)):ot(e),null;case 24:return null;case 25:return null}throw Error(V(156,e.tag))}function pT(t,e){switch(yp(e),e.tag){case 1:return _t(e.type)&&hu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ns(),be(kt),be(ut),Cp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ep(e),null;case 13:if(be(Ce),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(V(340));Cs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return be(Ce),null;case 4:return Ns(),null;case 10:return Sp(e.type._context),null;case 22:case 23:return Lp(),null;case 24:return null;default:return null}}var ua=!1,at=!1,mT=typeof WeakSet=="function"?WeakSet:Set,K=null;function ss(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Me(t,e,r)}else n.current=null}function Gf(t,e,n){try{n()}catch(r){Me(t,e,r)}}var Fg=!1;function gT(t,e){if(If=uu,t=Uw(),mp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,a=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(l=o+i),d!==s||r!==0&&d.nodeType!==3||(a=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++u===i&&(l=o),f===s&&++c===r&&(a=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(Rf={focusedElem:t,selectionRange:n},uu=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,g=e.stateNode,w=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:tn(e.type,m),v);g.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(x){Me(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return p=Fg,Fg=!1,p}function Mo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Gf(e,n,s)}i=i.next}while(i!==r)}}function dc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Yf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function zx(t){var e=t.alternate;e!==null&&(t.alternate=null,zx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xn],delete e[Qo],delete e[$f],delete e[QC],delete e[ZC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Bx(t){return t.tag===5||t.tag===3||t.tag===4}function Vg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Bx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Xf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fu));else if(r!==4&&(t=t.child,t!==null))for(Xf(t,e,n),t=t.sibling;t!==null;)Xf(t,e,n),t=t.sibling}function Qf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Qf(t,e,n),t=t.sibling;t!==null;)Qf(t,e,n),t=t.sibling}var Xe=null,rn=!1;function tr(t,e,n){for(n=n.child;n!==null;)Fx(t,e,n),n=n.sibling}function Fx(t,e,n){if(bn&&typeof bn.onCommitFiberUnmount=="function")try{bn.onCommitFiberUnmount(rc,n)}catch{}switch(n.tag){case 5:at||ss(n,e);case 6:var r=Xe,i=rn;Xe=null,tr(t,e,n),Xe=r,rn=i,Xe!==null&&(rn?(t=Xe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Xe.removeChild(n.stateNode));break;case 18:Xe!==null&&(rn?(t=Xe,n=n.stateNode,t.nodeType===8?hd(t.parentNode,n):t.nodeType===1&&hd(t,n),Ko(t)):hd(Xe,n.stateNode));break;case 4:r=Xe,i=rn,Xe=n.stateNode.containerInfo,rn=!0,tr(t,e,n),Xe=r,rn=i;break;case 0:case 11:case 14:case 15:if(!at&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Gf(n,e,o),i=i.next}while(i!==r)}tr(t,e,n);break;case 1:if(!at&&(ss(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Me(n,e,l)}tr(t,e,n);break;case 21:tr(t,e,n);break;case 22:n.mode&1?(at=(r=at)||n.memoizedState!==null,tr(t,e,n),at=r):tr(t,e,n);break;default:tr(t,e,n)}}function Ug(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new mT),e.forEach(function(r){var i=ET.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Xe=l.stateNode,rn=!1;break e;case 3:Xe=l.stateNode.containerInfo,rn=!0;break e;case 4:Xe=l.stateNode.containerInfo,rn=!0;break e}l=l.return}if(Xe===null)throw Error(V(160));Fx(s,o,i),Xe=null,rn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){Me(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Vx(e,t),e=e.sibling}function Vx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qt(e,t),gn(t),r&4){try{Mo(3,t,t.return),dc(3,t)}catch(m){Me(t,t.return,m)}try{Mo(5,t,t.return)}catch(m){Me(t,t.return,m)}}break;case 1:Qt(e,t),gn(t),r&512&&n!==null&&ss(n,n.return);break;case 5:if(Qt(e,t),gn(t),r&512&&n!==null&&ss(n,n.return),t.flags&32){var i=t.stateNode;try{Uo(i,"")}catch(m){Me(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&cw(i,s),bf(l,o);var u=bf(l,s);for(o=0;o<a.length;o+=2){var c=a[o],d=a[o+1];c==="style"?mw(i,d):c==="dangerouslySetInnerHTML"?hw(i,d):c==="children"?Uo(i,d):np(i,c,d,u)}switch(l){case"input":yf(i,s);break;case"textarea":dw(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?hs(i,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?hs(i,!!s.multiple,s.defaultValue,!0):hs(i,!!s.multiple,s.multiple?[]:"",!1))}i[Qo]=s}catch(m){Me(t,t.return,m)}}break;case 6:if(Qt(e,t),gn(t),r&4){if(t.stateNode===null)throw Error(V(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Me(t,t.return,m)}}break;case 3:if(Qt(e,t),gn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ko(e.containerInfo)}catch(m){Me(t,t.return,m)}break;case 4:Qt(e,t),gn(t);break;case 13:Qt(e,t),gn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Dp=Ie())),r&4&&Ug(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(at=(u=at)||c,Qt(e,t),at=u):Qt(e,t),gn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(K=t,c=t.child;c!==null;){for(d=K=c;K!==null;){switch(f=K,h=f.child,f.tag){case 0:case 11:case 14:case 15:Mo(4,f,f.return);break;case 1:ss(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Me(r,n,m)}}break;case 5:ss(f,f.return);break;case 22:if(f.memoizedState!==null){Wg(d);continue}}h!==null?(h.return=f,K=h):Wg(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=d.stateNode,a=d.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=pw("display",o))}catch(m){Me(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Me(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Qt(e,t),gn(t),r&4&&Ug(t);break;case 21:break;default:Qt(e,t),gn(t)}}function gn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Bx(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Uo(i,""),r.flags&=-33);var s=Vg(t);Qf(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Vg(t);Xf(t,l,o);break;default:throw Error(V(161))}}catch(a){Me(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yT(t,e,n){K=t,Ux(t)}function Ux(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var i=K,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||ua;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||at;l=ua;var u=at;if(ua=o,(at=a)&&!u)for(K=i;K!==null;)o=K,a=o.child,o.tag===22&&o.memoizedState!==null?qg(i):a!==null?(a.return=o,K=a):qg(i);for(;s!==null;)K=s,Ux(s),s=s.sibling;K=i,ua=l,at=u}Hg(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,K=s):Hg(t)}}function Hg(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:at||dc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!at)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:tn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Ng(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ng(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Ko(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}at||e.flags&512&&Yf(e)}catch(f){Me(e,e.return,f)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function Wg(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function qg(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{dc(4,e)}catch(a){Me(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){Me(e,i,a)}}var s=e.return;try{Yf(e)}catch(a){Me(e,s,a)}break;case 5:var o=e.return;try{Yf(e)}catch(a){Me(e,o,a)}}}catch(a){Me(e,e.return,a)}if(e===t){K=null;break}var l=e.sibling;if(l!==null){l.return=e.return,K=l;break}K=e.return}}var vT=Math.ceil,ku=Xn.ReactCurrentDispatcher,Rp=Xn.ReactCurrentOwner,Kt=Xn.ReactCurrentBatchConfig,he=0,He=null,Pe=null,nt=0,Mt=0,ls=jr(0),Be=0,il=null,xi=0,fc=0,Pp=0,Ao=null,xt=null,Dp=0,Ms=1/0,Rn=null,_u=!1,Zf=null,Cr=null,ca=!1,gr=null,Eu=0,Io=0,eh=null,qa=-1,Ka=0;function pt(){return he&6?Ie():qa!==-1?qa:qa=Ie()}function Tr(t){return t.mode&1?he&2&&nt!==0?nt&-nt:tT.transition!==null?(Ka===0&&(Ka=Tw()),Ka):(t=ge,t!==0||(t=window.event,t=t===void 0?16:Pw(t.type)),t):1}function hn(t,e,n,r){if(50<Io)throw Io=0,eh=null,Error(V(185));Il(t,n,r),(!(he&2)||t!==He)&&(t===He&&(!(he&2)&&(fc|=n),Be===4&&dr(t,nt)),Et(t,r),n===1&&he===0&&!(e.mode&1)&&(Ms=Ie()+500,ac&&zr()))}function Et(t,e){var n=t.callbackNode;tC(t,e);var r=au(t,t===He?nt:0);if(r===0)n!==null&&tg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&tg(n),e===1)t.tag===0?eT(Kg.bind(null,t)):Zw(Kg.bind(null,t)),YC(function(){!(he&6)&&zr()}),n=null;else{switch(Nw(r)){case 1:n=lp;break;case 4:n=Ew;break;case 16:n=lu;break;case 536870912:n=Cw;break;default:n=lu}n=Xx(n,Hx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Hx(t,e){if(qa=-1,Ka=0,he&6)throw Error(V(327));var n=t.callbackNode;if(vs()&&t.callbackNode!==n)return null;var r=au(t,t===He?nt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Cu(t,r);else{e=r;var i=he;he|=2;var s=qx();(He!==t||nt!==e)&&(Rn=null,Ms=Ie()+500,ai(t,e));do try{ST();break}catch(l){Wx(t,l)}while(!0);xp(),ku.current=s,he=i,Pe!==null?e=0:(He=null,nt=0,e=Be)}if(e!==0){if(e===2&&(i=Tf(t),i!==0&&(r=i,e=th(t,i))),e===1)throw n=il,ai(t,0),dr(t,r),Et(t,Ie()),n;if(e===6)dr(t,r);else{if(i=t.current.alternate,!(r&30)&&!wT(i)&&(e=Cu(t,r),e===2&&(s=Tf(t),s!==0&&(r=s,e=th(t,s))),e===1))throw n=il,ai(t,0),dr(t,r),Et(t,Ie()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(V(345));case 2:Kr(t,xt,Rn);break;case 3:if(dr(t,r),(r&130023424)===r&&(e=Dp+500-Ie(),10<e)){if(au(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){pt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Df(Kr.bind(null,t,xt,Rn),e);break}Kr(t,xt,Rn);break;case 4:if(dr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-fn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ie()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vT(r/1960))-r,10<r){t.timeoutHandle=Df(Kr.bind(null,t,xt,Rn),r);break}Kr(t,xt,Rn);break;case 5:Kr(t,xt,Rn);break;default:throw Error(V(329))}}}return Et(t,Ie()),t.callbackNode===n?Hx.bind(null,t):null}function th(t,e){var n=Ao;return t.current.memoizedState.isDehydrated&&(ai(t,e).flags|=256),t=Cu(t,e),t!==2&&(e=xt,xt=n,e!==null&&nh(e)),t}function nh(t){xt===null?xt=t:xt.push.apply(xt,t)}function wT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!pn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function dr(t,e){for(e&=~Pp,e&=~fc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-fn(e),r=1<<n;t[n]=-1,e&=~r}}function Kg(t){if(he&6)throw Error(V(327));vs();var e=au(t,0);if(!(e&1))return Et(t,Ie()),null;var n=Cu(t,e);if(t.tag!==0&&n===2){var r=Tf(t);r!==0&&(e=r,n=th(t,r))}if(n===1)throw n=il,ai(t,0),dr(t,e),Et(t,Ie()),n;if(n===6)throw Error(V(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Kr(t,xt,Rn),Et(t,Ie()),null}function $p(t,e){var n=he;he|=1;try{return t(e)}finally{he=n,he===0&&(Ms=Ie()+500,ac&&zr())}}function Si(t){gr!==null&&gr.tag===0&&!(he&6)&&vs();var e=he;he|=1;var n=Kt.transition,r=ge;try{if(Kt.transition=null,ge=1,t)return t()}finally{ge=r,Kt.transition=n,he=e,!(he&6)&&zr()}}function Lp(){Mt=ls.current,be(ls)}function ai(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,GC(n)),Pe!==null)for(n=Pe.return;n!==null;){var r=n;switch(yp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hu();break;case 3:Ns(),be(kt),be(ut),Cp();break;case 5:Ep(r);break;case 4:Ns();break;case 13:be(Ce);break;case 19:be(Ce);break;case 10:Sp(r.type._context);break;case 22:case 23:Lp()}n=n.return}if(He=t,Pe=t=Nr(t.current,null),nt=Mt=e,Be=0,il=null,Pp=fc=xi=0,xt=Ao=null,ti!==null){for(e=0;e<ti.length;e++)if(n=ti[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ti=null}return t}function Wx(t,e){do{var n=Pe;try{if(xp(),Ua.current=bu,Su){for(var r=Te.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Su=!1}if(wi=0,Fe=je=Te=null,Oo=!1,tl=0,Rp.current=null,n===null||n.return===null){Be=1,il=e,Pe=null;break}e:{var s=t,o=n.return,l=n,a=e;if(e=nt,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=Pg(o);if(h!==null){h.flags&=-257,Dg(h,o,l,s,e),h.mode&1&&Rg(s,u,e),e=h,a=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(a),e.updateQueue=m}else p.add(a);break e}else{if(!(e&1)){Rg(s,u,e),jp();break e}a=Error(V(426))}}else if(ke&&l.mode&1){var v=Pg(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Dg(v,o,l,s,e),vp(Os(a,l));break e}}s=a=Os(a,l),Be!==4&&(Be=2),Ao===null?Ao=[s]:Ao.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=Nx(s,a,e);Tg(s,g);break e;case 1:l=a;var w=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Cr===null||!Cr.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var x=Ox(s,l,e);Tg(s,x);break e}}s=s.return}while(s!==null)}Jx(n)}catch(k){e=k,Pe===n&&n!==null&&(Pe=n=n.return);continue}break}while(!0)}function qx(){var t=ku.current;return ku.current=bu,t===null?bu:t}function jp(){(Be===0||Be===3||Be===2)&&(Be=4),He===null||!(xi&268435455)&&!(fc&268435455)||dr(He,nt)}function Cu(t,e){var n=he;he|=2;var r=qx();(He!==t||nt!==e)&&(Rn=null,ai(t,e));do try{xT();break}catch(i){Wx(t,i)}while(!0);if(xp(),he=n,ku.current=r,Pe!==null)throw Error(V(261));return He=null,nt=0,Be}function xT(){for(;Pe!==null;)Kx(Pe)}function ST(){for(;Pe!==null&&!qE();)Kx(Pe)}function Kx(t){var e=Yx(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?Jx(t):Pe=e,Rp.current=null}function Jx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pT(n,e),n!==null){n.flags&=32767,Pe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Be=6,Pe=null;return}}else if(n=hT(n,e,Mt),n!==null){Pe=n;return}if(e=e.sibling,e!==null){Pe=e;return}Pe=e=t}while(e!==null);Be===0&&(Be=5)}function Kr(t,e,n){var r=ge,i=Kt.transition;try{Kt.transition=null,ge=1,bT(t,e,n,r)}finally{Kt.transition=i,ge=r}return null}function bT(t,e,n,r){do vs();while(gr!==null);if(he&6)throw Error(V(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(V(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(nC(t,s),t===He&&(Pe=He=null,nt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ca||(ca=!0,Xx(lu,function(){return vs(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Kt.transition,Kt.transition=null;var o=ge;ge=1;var l=he;he|=4,Rp.current=null,gT(t,n),Vx(n,t),VC(Rf),uu=!!If,Rf=If=null,t.current=n,yT(n),KE(),he=l,ge=o,Kt.transition=s}else t.current=n;if(ca&&(ca=!1,gr=t,Eu=i),s=t.pendingLanes,s===0&&(Cr=null),YE(n.stateNode),Et(t,Ie()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(_u)throw _u=!1,t=Zf,Zf=null,t;return Eu&1&&t.tag!==0&&vs(),s=t.pendingLanes,s&1?t===eh?Io++:(Io=0,eh=t):Io=0,zr(),null}function vs(){if(gr!==null){var t=Nw(Eu),e=Kt.transition,n=ge;try{if(Kt.transition=null,ge=16>t?16:t,gr===null)var r=!1;else{if(t=gr,gr=null,Eu=0,he&6)throw Error(V(331));var i=he;for(he|=4,K=t.current;K!==null;){var s=K,o=s.child;if(K.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(K=u;K!==null;){var c=K;switch(c.tag){case 0:case 11:case 15:Mo(8,c,s)}var d=c.child;if(d!==null)d.return=c,K=d;else for(;K!==null;){c=K;var f=c.sibling,h=c.return;if(zx(c),c===u){K=null;break}if(f!==null){f.return=h,K=f;break}K=h}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}K=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,K=o;else e:for(;K!==null;){if(s=K,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Mo(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,K=g;break e}K=s.return}}var w=t.current;for(K=w;K!==null;){o=K;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,K=y;else e:for(o=w;K!==null;){if(l=K,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:dc(9,l)}}catch(k){Me(l,l.return,k)}if(l===o){K=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,K=x;break e}K=l.return}}if(he=i,zr(),bn&&typeof bn.onPostCommitFiberRoot=="function")try{bn.onPostCommitFiberRoot(rc,t)}catch{}r=!0}return r}finally{ge=n,Kt.transition=e}}return!1}function Jg(t,e,n){e=Os(n,e),e=Nx(t,e,1),t=Er(t,e,1),e=pt(),t!==null&&(Il(t,1,e),Et(t,e))}function Me(t,e,n){if(t.tag===3)Jg(t,t,n);else for(;e!==null;){if(e.tag===3){Jg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cr===null||!Cr.has(r))){t=Os(n,t),t=Ox(e,t,1),e=Er(e,t,1),t=pt(),e!==null&&(Il(e,1,t),Et(e,t));break}}e=e.return}}function kT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pt(),t.pingedLanes|=t.suspendedLanes&n,He===t&&(nt&n)===n&&(Be===4||Be===3&&(nt&130023424)===nt&&500>Ie()-Dp?ai(t,0):Pp|=n),Et(t,e)}function Gx(t,e){e===0&&(t.mode&1?(e=ea,ea<<=1,!(ea&130023424)&&(ea=4194304)):e=1);var n=pt();t=Kn(t,e),t!==null&&(Il(t,e,n),Et(t,n))}function _T(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Gx(t,n)}function ET(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(e),Gx(t,n)}var Yx;Yx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||kt.current)St=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return St=!1,fT(t,e,n);St=!!(t.flags&131072)}else St=!1,ke&&e.flags&1048576&&ex(e,gu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Wa(t,e),t=e.pendingProps;var i=Es(e,ut.current);ys(e,n),i=Np(null,e,r,t,i,n);var s=Op();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_t(r)?(s=!0,pu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,kp(e),i.updater=cc,e.stateNode=i,i._reactInternals=e,Vf(e,r,t,n),e=Wf(null,e,r,!0,s,n)):(e.tag=0,ke&&s&&gp(e),ht(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Wa(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=TT(r),t=tn(r,t),i){case 0:e=Hf(null,e,r,t,n);break e;case 1:e=jg(null,e,r,t,n);break e;case 11:e=$g(null,e,r,t,n);break e;case 14:e=Lg(null,e,r,tn(r.type,t),n);break e}throw Error(V(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:tn(r,i),Hf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:tn(r,i),jg(t,e,r,i,n);case 3:e:{if(Rx(e),t===null)throw Error(V(387));r=e.pendingProps,s=e.memoizedState,i=s.element,ox(t,e),wu(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Os(Error(V(423)),e),e=zg(t,e,r,n,i);break e}else if(r!==i){i=Os(Error(V(424)),e),e=zg(t,e,r,n,i);break e}else for(Pt=_r(e.stateNode.containerInfo.firstChild),Dt=e,ke=!0,ln=null,n=ix(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Cs(),r===i){e=Jn(t,e,n);break e}ht(t,e,r,n)}e=e.child}return e;case 5:return lx(e),t===null&&zf(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Pf(r,i)?o=null:s!==null&&Pf(r,s)&&(e.flags|=32),Ix(t,e),ht(t,e,o,n),e.child;case 6:return t===null&&zf(e),null;case 13:return Px(t,e,n);case 4:return _p(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ts(e,null,r,n):ht(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:tn(r,i),$g(t,e,r,i,n);case 7:return ht(t,e,e.pendingProps,n),e.child;case 8:return ht(t,e,e.pendingProps.children,n),e.child;case 12:return ht(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,we(yu,r._currentValue),r._currentValue=o,s!==null)if(pn(s.value,o)){if(s.children===i.children&&!kt.current){e=Jn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Fn(-1,n&-n),a.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Bf(s.return,n,e),l.lanes|=n;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(V(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Bf(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ht(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ys(e,n),i=Yt(i),r=r(i),e.flags|=1,ht(t,e,r,n),e.child;case 14:return r=e.type,i=tn(r,e.pendingProps),i=tn(r.type,i),Lg(t,e,r,i,n);case 15:return Mx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:tn(r,i),Wa(t,e),e.tag=1,_t(r)?(t=!0,pu(e)):t=!1,ys(e,n),Tx(e,r,i),Vf(e,r,i,n),Wf(null,e,r,!0,t,n);case 19:return Dx(t,e,n);case 22:return Ax(t,e,n)}throw Error(V(156,e.tag))};function Xx(t,e){return _w(t,e)}function CT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wt(t,e,n,r){return new CT(t,e,n,r)}function zp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TT(t){if(typeof t=="function")return zp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ip)return 11;if(t===sp)return 14}return 2}function Nr(t,e){var n=t.alternate;return n===null?(n=Wt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ja(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")zp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Yi:return ui(n.children,i,s,e);case rp:o=8,i|=8;break;case ff:return t=Wt(12,n,e,i|2),t.elementType=ff,t.lanes=s,t;case hf:return t=Wt(13,n,e,i),t.elementType=hf,t.lanes=s,t;case pf:return t=Wt(19,n,e,i),t.elementType=pf,t.lanes=s,t;case lw:return hc(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case sw:o=10;break e;case ow:o=9;break e;case ip:o=11;break e;case sp:o=14;break e;case sr:o=16,r=null;break e}throw Error(V(130,t==null?t:typeof t,""))}return e=Wt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ui(t,e,n,r){return t=Wt(7,t,r,e),t.lanes=n,t}function hc(t,e,n,r){return t=Wt(22,t,r,e),t.elementType=lw,t.lanes=n,t.stateNode={isHidden:!1},t}function Sd(t,e,n){return t=Wt(6,t,null,e),t.lanes=n,t}function bd(t,e,n){return e=Wt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function NT(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nd(0),this.expirationTimes=nd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nd(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bp(t,e,n,r,i,s,o,l,a){return t=new NT(t,e,n,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Wt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kp(s),t}function OT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Qx(t){if(!t)return Dr;t=t._reactInternals;e:{if(Ai(t)!==t||t.tag!==1)throw Error(V(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_t(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(V(171))}if(t.tag===1){var n=t.type;if(_t(n))return Qw(t,n,e)}return e}function Zx(t,e,n,r,i,s,o,l,a){return t=Bp(n,r,!0,t,i,s,o,l,a),t.context=Qx(null),n=t.current,r=pt(),i=Tr(n),s=Fn(r,i),s.callback=e??null,Er(n,s,i),t.current.lanes=i,Il(t,i,r),Et(t,r),t}function pc(t,e,n,r){var i=e.current,s=pt(),o=Tr(i);return n=Qx(n),e.context===null?e.context=n:e.pendingContext=n,e=Fn(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Er(i,e,o),t!==null&&(hn(t,i,o,s),Va(t,i,o)),o}function Tu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Gg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Fp(t,e){Gg(t,e),(t=t.alternate)&&Gg(t,e)}function MT(){return null}var eS=typeof reportError=="function"?reportError:function(t){console.error(t)};function Vp(t){this._internalRoot=t}mc.prototype.render=Vp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(V(409));pc(t,e,null,null)};mc.prototype.unmount=Vp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Si(function(){pc(null,t,null,null)}),e[qn]=null}};function mc(t){this._internalRoot=t}mc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Aw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<cr.length&&e!==0&&e<cr[n].priority;n++);cr.splice(n,0,t),n===0&&Rw(t)}};function Up(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Yg(){}function AT(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Tu(o);s.call(u)}}var o=Zx(e,r,t,0,null,!1,!1,"",Yg);return t._reactRootContainer=o,t[qn]=o.current,Yo(t.nodeType===8?t.parentNode:t),Si(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Tu(a);l.call(u)}}var a=Bp(t,0,!1,null,null,!1,!1,"",Yg);return t._reactRootContainer=a,t[qn]=a.current,Yo(t.nodeType===8?t.parentNode:t),Si(function(){pc(e,a,n,r)}),a}function yc(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=Tu(o);l.call(a)}}pc(e,o,t,i)}else o=AT(n,e,t,i,r);return Tu(o)}Ow=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=go(e.pendingLanes);n!==0&&(ap(e,n|1),Et(e,Ie()),!(he&6)&&(Ms=Ie()+500,zr()))}break;case 13:Si(function(){var r=Kn(t,1);if(r!==null){var i=pt();hn(r,t,1,i)}}),Fp(t,1)}};up=function(t){if(t.tag===13){var e=Kn(t,134217728);if(e!==null){var n=pt();hn(e,t,134217728,n)}Fp(t,134217728)}};Mw=function(t){if(t.tag===13){var e=Tr(t),n=Kn(t,e);if(n!==null){var r=pt();hn(n,t,e,r)}Fp(t,e)}};Aw=function(){return ge};Iw=function(t,e){var n=ge;try{return ge=t,e()}finally{ge=n}};_f=function(t,e,n){switch(e){case"input":if(yf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=lc(r);if(!i)throw Error(V(90));uw(r),yf(r,i)}}}break;case"textarea":dw(t,n);break;case"select":e=n.value,e!=null&&hs(t,!!n.multiple,e,!1)}};vw=$p;ww=Si;var IT={usingClientEntryPoint:!1,Events:[Pl,es,lc,gw,yw,$p]},ao={findFiberByHostInstance:ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RT={bundleType:ao.bundleType,version:ao.version,rendererPackageName:ao.rendererPackageName,rendererConfig:ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=bw(t),t===null?null:t.stateNode},findFiberByHostInstance:ao.findFiberByHostInstance||MT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var da=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!da.isDisabled&&da.supportsFiber)try{rc=da.inject(RT),bn=da}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IT;zt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Up(e))throw Error(V(200));return OT(t,e,null,n)};zt.createRoot=function(t,e){if(!Up(t))throw Error(V(299));var n=!1,r="",i=eS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Bp(t,1,!1,null,null,n,!1,r,i),t[qn]=e.current,Yo(t.nodeType===8?t.parentNode:t),new Vp(e)};zt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(V(188)):(t=Object.keys(t).join(","),Error(V(268,t)));return t=bw(e),t=t===null?null:t.stateNode,t};zt.flushSync=function(t){return Si(t)};zt.hydrate=function(t,e,n){if(!gc(e))throw Error(V(200));return yc(null,t,e,!0,n)};zt.hydrateRoot=function(t,e,n){if(!Up(t))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=eS;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Zx(e,null,t,1,n??null,i,!1,s,o),t[qn]=e.current,Yo(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new mc(e)};zt.render=function(t,e,n){if(!gc(e))throw Error(V(200));return yc(null,t,e,!1,n)};zt.unmountComponentAtNode=function(t){if(!gc(t))throw Error(V(40));return t._reactRootContainer?(Si(function(){yc(null,null,t,!1,function(){t._reactRootContainer=null,t[qn]=null})}),!0):!1};zt.unstable_batchedUpdates=$p;zt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!gc(n))throw Error(V(200));if(t==null||t._reactInternals===void 0)throw Error(V(38));return yc(t,e,n,!1,r)};zt.version="18.3.1-next-f1338f8080-20240426";function tS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tS)}catch(t){console.error(t)}}tS(),tw.exports=zt;var nS=tw.exports;const PT=Gh(nS);var Xg=nS;cf.createRoot=Xg.createRoot,cf.hydrateRoot=Xg.hydrateRoot;function $e(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,r;n<t.length;n++)(r=$e(t[n]))!==""&&(e+=(e&&" ")+r);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var DT={value:()=>{}};function vc(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ga(n)}function Ga(t){this._=t}function $T(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ga.prototype=vc.prototype={constructor:Ga,on:function(t,e){var n=this._,r=$T(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=LT(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=Qg(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Qg(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ga(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function LT(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Qg(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=DT,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var rh="http://www.w3.org/1999/xhtml";const Zg={svg:"http://www.w3.org/2000/svg",xhtml:rh,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wc(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Zg.hasOwnProperty(e)?{space:Zg[e],local:t}:t}function jT(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===rh&&e.documentElement.namespaceURI===rh?e.createElement(t):e.createElementNS(n,t)}}function zT(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function rS(t){var e=wc(t);return(e.local?zT:jT)(e)}function BT(){}function Hp(t){return t==null?BT:function(){return this.querySelector(t)}}function FT(t){typeof t!="function"&&(t=Hp(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,l=r[i]=new Array(o),a,u,c=0;c<o;++c)(a=s[c])&&(u=t.call(a,a.__data__,c,s))&&("__data__"in a&&(u.__data__=a.__data__),l[c]=u);return new jt(r,this._parents)}function VT(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function UT(){return[]}function iS(t){return t==null?UT:function(){return this.querySelectorAll(t)}}function HT(t){return function(){return VT(t.apply(this,arguments))}}function WT(t){typeof t=="function"?t=HT(t):t=iS(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],l=o.length,a,u=0;u<l;++u)(a=o[u])&&(r.push(t.call(a,a.__data__,u,o)),i.push(a));return new jt(r,i)}function sS(t){return function(){return this.matches(t)}}function oS(t){return function(e){return e.matches(t)}}var qT=Array.prototype.find;function KT(t){return function(){return qT.call(this.children,t)}}function JT(){return this.firstElementChild}function GT(t){return this.select(t==null?JT:KT(typeof t=="function"?t:oS(t)))}var YT=Array.prototype.filter;function XT(){return Array.from(this.children)}function QT(t){return function(){return YT.call(this.children,t)}}function ZT(t){return this.selectAll(t==null?XT:QT(typeof t=="function"?t:oS(t)))}function eN(t){typeof t!="function"&&(t=sS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,l=r[i]=[],a,u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new jt(r,this._parents)}function lS(t){return new Array(t.length)}function tN(){return new jt(this._enter||this._groups.map(lS),this._parents)}function Nu(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Nu.prototype={constructor:Nu,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function nN(t){return function(){return t}}function rN(t,e,n,r,i,s){for(var o=0,l,a=e.length,u=s.length;o<u;++o)(l=e[o])?(l.__data__=s[o],r[o]=l):n[o]=new Nu(t,s[o]);for(;o<a;++o)(l=e[o])&&(i[o]=l)}function iN(t,e,n,r,i,s,o){var l,a,u=new Map,c=e.length,d=s.length,f=new Array(c),h;for(l=0;l<c;++l)(a=e[l])&&(f[l]=h=o.call(a,a.__data__,l,e)+"",u.has(h)?i[l]=a:u.set(h,a));for(l=0;l<d;++l)h=o.call(t,s[l],l,s)+"",(a=u.get(h))?(r[l]=a,a.__data__=s[l],u.delete(h)):n[l]=new Nu(t,s[l]);for(l=0;l<c;++l)(a=e[l])&&u.get(f[l])===a&&(i[l]=a)}function sN(t){return t.__data__}function oN(t,e){if(!arguments.length)return Array.from(this,sN);var n=e?iN:rN,r=this._parents,i=this._groups;typeof t!="function"&&(t=nN(t));for(var s=i.length,o=new Array(s),l=new Array(s),a=new Array(s),u=0;u<s;++u){var c=r[u],d=i[u],f=d.length,h=lN(t.call(c,c&&c.__data__,u,r)),p=h.length,m=l[u]=new Array(p),v=o[u]=new Array(p),g=a[u]=new Array(f);n(c,d,m,v,g,h,e);for(var w=0,y=0,x,k;w<p;++w)if(x=m[w]){for(w>=y&&(y=w+1);!(k=v[y])&&++y<p;);x._next=k||null}}return o=new jt(o,r),o._enter=l,o._exit=a,o}function lN(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function aN(){return new jt(this._exit||this._groups.map(lS),this._parents)}function uN(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function cN(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),l=new Array(i),a=0;a<o;++a)for(var u=n[a],c=r[a],d=u.length,f=l[a]=new Array(d),h,p=0;p<d;++p)(h=u[p]||c[p])&&(f[p]=h);for(;a<i;++a)l[a]=n[a];return new jt(l,this._parents)}function dN(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function fN(t){t||(t=hN);function e(d,f){return d&&f?t(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],l=o.length,a=i[s]=new Array(l),u,c=0;c<l;++c)(u=o[c])&&(a[c]=u);a.sort(e)}return new jt(i,this._parents).order()}function hN(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function pN(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function mN(){return Array.from(this)}function gN(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function yN(){let t=0;for(const e of this)++t;return t}function vN(){return!this.node()}function wN(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,l;s<o;++s)(l=i[s])&&t.call(l,l.__data__,s,i);return this}function xN(t){return function(){this.removeAttribute(t)}}function SN(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bN(t,e){return function(){this.setAttribute(t,e)}}function kN(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _N(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function EN(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function CN(t,e){var n=wc(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?SN:xN:typeof e=="function"?n.local?EN:_N:n.local?kN:bN)(n,e))}function aS(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function TN(t){return function(){this.style.removeProperty(t)}}function NN(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ON(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function MN(t,e,n){return arguments.length>1?this.each((e==null?TN:typeof e=="function"?ON:NN)(t,e,n??"")):As(this.node(),t)}function As(t,e){return t.style.getPropertyValue(e)||aS(t).getComputedStyle(t,null).getPropertyValue(e)}function AN(t){return function(){delete this[t]}}function IN(t,e){return function(){this[t]=e}}function RN(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function PN(t,e){return arguments.length>1?this.each((e==null?AN:typeof e=="function"?RN:IN)(t,e)):this.node()[t]}function uS(t){return t.trim().split(/^|\s+/)}function Wp(t){return t.classList||new cS(t)}function cS(t){this._node=t,this._names=uS(t.getAttribute("class")||"")}cS.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function dS(t,e){for(var n=Wp(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function fS(t,e){for(var n=Wp(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function DN(t){return function(){dS(this,t)}}function $N(t){return function(){fS(this,t)}}function LN(t,e){return function(){(e.apply(this,arguments)?dS:fS)(this,t)}}function jN(t,e){var n=uS(t+"");if(arguments.length<2){for(var r=Wp(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?LN:e?DN:$N)(n,e))}function zN(){this.textContent=""}function BN(t){return function(){this.textContent=t}}function FN(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function VN(t){return arguments.length?this.each(t==null?zN:(typeof t=="function"?FN:BN)(t)):this.node().textContent}function UN(){this.innerHTML=""}function HN(t){return function(){this.innerHTML=t}}function WN(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function qN(t){return arguments.length?this.each(t==null?UN:(typeof t=="function"?WN:HN)(t)):this.node().innerHTML}function KN(){this.nextSibling&&this.parentNode.appendChild(this)}function JN(){return this.each(KN)}function GN(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function YN(){return this.each(GN)}function XN(t){var e=typeof t=="function"?t:rS(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function QN(){return null}function ZN(t,e){var n=typeof t=="function"?t:rS(t),r=e==null?QN:typeof e=="function"?e:Hp(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function eO(){var t=this.parentNode;t&&t.removeChild(this)}function tO(){return this.each(eO)}function nO(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rO(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function iO(t){return this.select(t?rO:nO)}function sO(t){return arguments.length?this.property("__data__",t):this.node().__data__}function oO(t){return function(e){t.call(this,e,this.__data__)}}function lO(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function aO(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function uO(t,e,n){return function(){var r=this.__on,i,s=oO(e);if(r){for(var o=0,l=r.length;o<l;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function cO(t,e,n){var r=lO(t+""),i,s=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,u=l.length,c;a<u;++a)for(i=0,c=l[a];i<s;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(l=e?uO:aO,i=0;i<s;++i)this.each(l(r[i],e,n));return this}function hS(t,e,n){var r=aS(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dO(t,e){return function(){return hS(this,t,e)}}function fO(t,e){return function(){return hS(this,t,e.apply(this,arguments))}}function hO(t,e){return this.each((typeof e=="function"?fO:dO)(t,e))}function*pO(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var pS=[null];function jt(t,e){this._groups=t,this._parents=e}function $l(){return new jt([[document.documentElement]],pS)}function mO(){return this}jt.prototype=$l.prototype={constructor:jt,select:FT,selectAll:WT,selectChild:GT,selectChildren:ZT,filter:eN,data:oN,enter:tN,exit:aN,join:uN,merge:cN,selection:mO,order:dN,sort:fN,call:pN,nodes:mN,node:gN,size:yN,empty:vN,each:wN,attr:CN,style:MN,property:PN,classed:jN,text:VN,html:qN,raise:JN,lower:YN,append:XN,insert:ZN,remove:tO,clone:iO,datum:sO,on:cO,dispatch:hO,[Symbol.iterator]:pO};function At(t){return typeof t=="string"?new jt([[document.querySelector(t)]],[document.documentElement]):new jt([[t]],pS)}function gO(t){let e;for(;e=t.sourceEvent;)t=e;return t}function sn(t,e){if(t=gO(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const yO={passive:!1},sl={capture:!0,passive:!1};function kd(t){t.stopImmediatePropagation()}function ws(t){t.preventDefault(),t.stopImmediatePropagation()}function mS(t){var e=t.document.documentElement,n=At(t).on("dragstart.drag",ws,sl);"onselectstart"in e?n.on("selectstart.drag",ws,sl):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function gS(t,e){var n=t.document.documentElement,r=At(t).on("dragstart.drag",null);e&&(r.on("click.drag",ws,sl),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const fa=t=>()=>t;function ih(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:o,y:l,dx:a,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}ih.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function vO(t){return!t.ctrlKey&&!t.button}function wO(){return this.parentNode}function xO(t,e){return e??{x:t.x,y:t.y}}function SO(){return navigator.maxTouchPoints||"ontouchstart"in this}function yS(){var t=vO,e=wO,n=xO,r=SO,i={},s=vc("start","drag","end"),o=0,l,a,u,c,d=0;function f(x){x.on("mousedown.drag",h).filter(r).on("touchstart.drag",v).on("touchmove.drag",g,yO).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(x,k){if(!(c||!t.call(this,x,k))){var S=y(this,e.call(this,x,k),x,k,"mouse");S&&(At(x.view).on("mousemove.drag",p,sl).on("mouseup.drag",m,sl),mS(x.view),kd(x),u=!1,l=x.clientX,a=x.clientY,S("start",x))}}function p(x){if(ws(x),!u){var k=x.clientX-l,S=x.clientY-a;u=k*k+S*S>d}i.mouse("drag",x)}function m(x){At(x.view).on("mousemove.drag mouseup.drag",null),gS(x.view,u),ws(x),i.mouse("end",x)}function v(x,k){if(t.call(this,x,k)){var S=x.changedTouches,b=e.call(this,x,k),E=S.length,O,L;for(O=0;O<E;++O)(L=y(this,b,x,k,S[O].identifier,S[O]))&&(kd(x),L("start",x,S[O]))}}function g(x){var k=x.changedTouches,S=k.length,b,E;for(b=0;b<S;++b)(E=i[k[b].identifier])&&(ws(x),E("drag",x,k[b]))}function w(x){var k=x.changedTouches,S=k.length,b,E;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),b=0;b<S;++b)(E=i[k[b].identifier])&&(kd(x),E("end",x,k[b]))}function y(x,k,S,b,E,O){var L=s.copy(),A=sn(O||S,k),P,B,T;if((T=n.call(x,new ih("beforestart",{sourceEvent:S,target:f,identifier:E,active:o,x:A[0],y:A[1],dx:0,dy:0,dispatch:L}),b))!=null)return P=T.x-A[0]||0,B=T.y-A[1]||0,function D(M,$,C){var N=A,R;switch(M){case"start":i[E]=D,R=o++;break;case"end":delete i[E],--o;case"drag":A=sn(C||$,k),R=o;break}L.call(M,x,new ih(M,{sourceEvent:$,subject:T,target:f,identifier:E,active:R,x:A[0]+P,y:A[1]+B,dx:A[0]-N[0],dy:A[1]-N[1],dispatch:L}),b)}}return f.filter=function(x){return arguments.length?(t=typeof x=="function"?x:fa(!!x),f):t},f.container=function(x){return arguments.length?(e=typeof x=="function"?x:fa(x),f):e},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:fa(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:fa(!!x),f):r},f.on=function(){var x=s.on.apply(s,arguments);return x===s?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function qp(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function vS(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ll(){}var ol=.7,Ou=1/ol,xs="\\s*([+-]?\\d+)\\s*",ll="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bO=/^#([0-9a-f]{3,8})$/,kO=new RegExp(`^rgb\\(${xs},${xs},${xs}\\)$`),_O=new RegExp(`^rgb\\(${_n},${_n},${_n}\\)$`),EO=new RegExp(`^rgba\\(${xs},${xs},${xs},${ll}\\)$`),CO=new RegExp(`^rgba\\(${_n},${_n},${_n},${ll}\\)$`),TO=new RegExp(`^hsl\\(${ll},${_n},${_n}\\)$`),NO=new RegExp(`^hsla\\(${ll},${_n},${_n},${ll}\\)$`),ey={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qp(Ll,bi,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ty,formatHex:ty,formatHex8:OO,formatHsl:MO,formatRgb:ny,toString:ny});function ty(){return this.rgb().formatHex()}function OO(){return this.rgb().formatHex8()}function MO(){return wS(this).formatHsl()}function ny(){return this.rgb().formatRgb()}function bi(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=bO.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ry(e):n===3?new bt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ha(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ha(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=kO.exec(t))?new bt(e[1],e[2],e[3],1):(e=_O.exec(t))?new bt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=EO.exec(t))?ha(e[1],e[2],e[3],e[4]):(e=CO.exec(t))?ha(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=TO.exec(t))?oy(e[1],e[2]/100,e[3]/100,1):(e=NO.exec(t))?oy(e[1],e[2]/100,e[3]/100,e[4]):ey.hasOwnProperty(t)?ry(ey[t]):t==="transparent"?new bt(NaN,NaN,NaN,0):null}function ry(t){return new bt(t>>16&255,t>>8&255,t&255,1)}function ha(t,e,n,r){return r<=0&&(t=e=n=NaN),new bt(t,e,n,r)}function AO(t){return t instanceof Ll||(t=bi(t)),t?(t=t.rgb(),new bt(t.r,t.g,t.b,t.opacity)):new bt}function sh(t,e,n,r){return arguments.length===1?AO(t):new bt(t,e,n,r??1)}function bt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}qp(bt,sh,vS(Ll,{brighter(t){return t=t==null?Ou:Math.pow(Ou,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ol:Math.pow(ol,t),new bt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new bt(ci(this.r),ci(this.g),ci(this.b),Mu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iy,formatHex:iy,formatHex8:IO,formatRgb:sy,toString:sy}));function iy(){return`#${ri(this.r)}${ri(this.g)}${ri(this.b)}`}function IO(){return`#${ri(this.r)}${ri(this.g)}${ri(this.b)}${ri((isNaN(this.opacity)?1:this.opacity)*255)}`}function sy(){const t=Mu(this.opacity);return`${t===1?"rgb(":"rgba("}${ci(this.r)}, ${ci(this.g)}, ${ci(this.b)}${t===1?")":`, ${t})`}`}function Mu(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ci(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ri(t){return t=ci(t),(t<16?"0":"")+t.toString(16)}function oy(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new an(t,e,n,r)}function wS(t){if(t instanceof an)return new an(t.h,t.s,t.l,t.opacity);if(t instanceof Ll||(t=bi(t)),!t)return new an;if(t instanceof an)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,l=s-i,a=(s+i)/2;return l?(e===s?o=(n-r)/l+(n<r)*6:n===s?o=(r-e)/l+2:o=(e-n)/l+4,l/=a<.5?s+i:2-s-i,o*=60):l=a>0&&a<1?0:o,new an(o,l,a,t.opacity)}function RO(t,e,n,r){return arguments.length===1?wS(t):new an(t,e,n,r??1)}function an(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}qp(an,RO,vS(Ll,{brighter(t){return t=t==null?Ou:Math.pow(Ou,t),new an(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ol:Math.pow(ol,t),new an(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new bt(_d(t>=240?t-240:t+120,i,r),_d(t,i,r),_d(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new an(ly(this.h),pa(this.s),pa(this.l),Mu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Mu(this.opacity);return`${t===1?"hsl(":"hsla("}${ly(this.h)}, ${pa(this.s)*100}%, ${pa(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ly(t){return t=(t||0)%360,t<0?t+360:t}function pa(t){return Math.max(0,Math.min(1,t||0))}function _d(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Kp=t=>()=>t;function PO(t,e){return function(n){return t+n*e}}function DO(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function $O(t){return(t=+t)==1?xS:function(e,n){return n-e?DO(e,n,t):Kp(isNaN(e)?n:e)}}function xS(t,e){var n=e-t;return n?PO(t,n):Kp(isNaN(t)?e:t)}const Au=function t(e){var n=$O(e);function r(i,s){var o=n((i=sh(i)).r,(s=sh(s)).r),l=n(i.g,s.g),a=n(i.b,s.b),u=xS(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=l(c),i.b=a(c),i.opacity=u(c),i+""}}return r.gamma=t,r}(1);function LO(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function jO(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function zO(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=Ro(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(l){for(o=0;o<r;++o)s[o]=i[o](l);return s}}function BO(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function wn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function FO(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Ro(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var oh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ed=new RegExp(oh.source,"g");function VO(t){return function(){return t}}function UO(t){return function(e){return t(e)+""}}function SS(t,e){var n=oh.lastIndex=Ed.lastIndex=0,r,i,s,o=-1,l=[],a=[];for(t=t+"",e=e+"";(r=oh.exec(t))&&(i=Ed.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(r=r[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,a.push({i:o,x:wn(r,i)})),n=Ed.lastIndex;return n<e.length&&(s=e.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?a[0]?UO(a[0].x):VO(e):(e=a.length,function(u){for(var c=0,d;c<e;++c)l[(d=a[c]).i]=d.x(u);return l.join("")})}function Ro(t,e){var n=typeof e,r;return e==null||n==="boolean"?Kp(e):(n==="number"?wn:n==="string"?(r=bi(e))?(e=r,Au):SS:e instanceof bi?Au:e instanceof Date?BO:jO(e)?LO:Array.isArray(e)?zO:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?FO:wn)(t,e)}var ay=180/Math.PI,lh={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bS(t,e,n,r,i,s){var o,l,a;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(a=t*n+e*r)&&(n-=t*a,r-=e*a),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,a/=l),t*r<e*n&&(t=-t,e=-e,a=-a,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*ay,skewX:Math.atan(a)*ay,scaleX:o,scaleY:l}}var ma;function HO(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?lh:bS(e.a,e.b,e.c,e.d,e.e,e.f)}function WO(t){return t==null||(ma||(ma=document.createElementNS("http://www.w3.org/2000/svg","g")),ma.setAttribute("transform",t),!(t=ma.transform.baseVal.consolidate()))?lh:(t=t.matrix,bS(t.a,t.b,t.c,t.d,t.e,t.f))}function kS(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,d,f,h,p){if(u!==d||c!==f){var m=h.push("translate(",null,e,null,n);p.push({i:m-4,x:wn(u,d)},{i:m-2,x:wn(c,f)})}else(d||f)&&h.push("translate("+d+e+f+n)}function o(u,c,d,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:wn(u,c)})):c&&d.push(i(d)+"rotate("+c+r)}function l(u,c,d,f){u!==c?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:wn(u,c)}):c&&d.push(i(d)+"skewX("+c+r)}function a(u,c,d,f,h,p){if(u!==d||c!==f){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:wn(u,d)},{i:m-2,x:wn(c,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(u,c){var d=[],f=[];return u=t(u),c=t(c),s(u.translateX,u.translateY,c.translateX,c.translateY,d,f),o(u.rotate,c.rotate,d,f),l(u.skewX,c.skewX,d,f),a(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,f),u=c=null,function(h){for(var p=-1,m=f.length,v;++p<m;)d[(v=f[p]).i]=v.x(h);return d.join("")}}}var qO=kS(HO,"px, ","px)","deg)"),KO=kS(WO,", ",")",")"),JO=1e-12;function uy(t){return((t=Math.exp(t))+1/t)/2}function GO(t){return((t=Math.exp(t))-1/t)/2}function YO(t){return((t=Math.exp(2*t))-1)/(t+1)}const Ya=function t(e,n,r){function i(s,o){var l=s[0],a=s[1],u=s[2],c=o[0],d=o[1],f=o[2],h=c-l,p=d-a,m=h*h+p*p,v,g;if(m<JO)g=Math.log(f/u)/e,v=function(b){return[l+b*h,a+b*p,u*Math.exp(e*b*g)]};else{var w=Math.sqrt(m),y=(f*f-u*u+r*m)/(2*u*n*w),x=(f*f-u*u-r*m)/(2*f*n*w),k=Math.log(Math.sqrt(y*y+1)-y),S=Math.log(Math.sqrt(x*x+1)-x);g=(S-k)/e,v=function(b){var E=b*g,O=uy(k),L=u/(n*w)*(O*YO(e*E+k)-GO(k));return[l+L*h,a+L*p,u*O/uy(e*E+k)]}}return v.duration=g*1e3*e/Math.SQRT2,v}return i.rho=function(s){var o=Math.max(.001,+s),l=o*o,a=l*l;return t(o,l,a)},i}(Math.SQRT2,2,4);var Is=0,vo=0,uo=0,_S=1e3,Iu,wo,Ru=0,ki=0,xc=0,al=typeof performance=="object"&&performance.now?performance:Date,ES=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Jp(){return ki||(ES(XO),ki=al.now()+xc)}function XO(){ki=0}function Pu(){this._call=this._time=this._next=null}Pu.prototype=CS.prototype={constructor:Pu,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Jp():+n)+(e==null?0:+e),!this._next&&wo!==this&&(wo?wo._next=this:Iu=this,wo=this),this._call=t,this._time=n,ah()},stop:function(){this._call&&(this._call=null,this._time=1/0,ah())}};function CS(t,e,n){var r=new Pu;return r.restart(t,e,n),r}function QO(){Jp(),++Is;for(var t=Iu,e;t;)(e=ki-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Is}function cy(){ki=(Ru=al.now())+xc,Is=vo=0;try{QO()}finally{Is=0,eM(),ki=0}}function ZO(){var t=al.now(),e=t-Ru;e>_S&&(xc-=e,Ru=t)}function eM(){for(var t,e=Iu,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Iu=n);wo=t,ah(r)}function ah(t){if(!Is){vo&&(vo=clearTimeout(vo));var e=t-ki;e>24?(t<1/0&&(vo=setTimeout(cy,t-al.now()-xc)),uo&&(uo=clearInterval(uo))):(uo||(Ru=al.now(),uo=setInterval(ZO,_S)),Is=1,ES(cy))}}function dy(t,e,n){var r=new Pu;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var tM=vc("start","end","cancel","interrupt"),nM=[],TS=0,fy=1,uh=2,Xa=3,hy=4,ch=5,Qa=6;function Sc(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;rM(t,n,{name:e,index:r,group:i,on:tM,tween:nM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:TS})}function Gp(t,e){var n=mn(t,e);if(n.state>TS)throw new Error("too late; already scheduled");return n}function Nn(t,e){var n=mn(t,e);if(n.state>Xa)throw new Error("too late; already running");return n}function mn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function rM(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=CS(s,0,n.time);function s(u){n.state=fy,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var c,d,f,h;if(n.state!==fy)return a();for(c in r)if(h=r[c],h.name===n.name){if(h.state===Xa)return dy(o);h.state===hy?(h.state=Qa,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[c]):+c<e&&(h.state=Qa,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[c])}if(dy(function(){n.state===Xa&&(n.state=hy,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=uh,n.on.call("start",t,t.__data__,n.index,n.group),n.state===uh){for(n.state=Xa,i=new Array(f=n.tween.length),c=0,d=-1;c<f;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function l(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(a),n.state=ch,1),d=-1,f=i.length;++d<f;)i[d].call(t,c);n.state===ch&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=Qa,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function Za(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>uh&&r.state<ch,r.state=Qa,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function iM(t){return this.each(function(){Za(this,t)})}function sM(t,e){var n,r;return function(){var i=Nn(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,l=r.length;o<l;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function oM(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Nn(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var l={name:e,value:n},a=0,u=i.length;a<u;++a)if(i[a].name===e){i[a]=l;break}a===u&&i.push(l)}s.tween=i}}function lM(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=mn(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?sM:oM)(n,t,e))}function Yp(t,e,n){var r=t._id;return t.each(function(){var i=Nn(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return mn(i,r).value[e]}}function NS(t,e){var n;return(typeof e=="number"?wn:e instanceof bi?Au:(n=bi(e))?(e=n,Au):SS)(t,e)}function aM(t){return function(){this.removeAttribute(t)}}function uM(t){return function(){this.removeAttributeNS(t.space,t.local)}}function cM(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function dM(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function fM(t,e,n){var r,i,s;return function(){var o,l=n(this),a;return l==null?void this.removeAttribute(t):(o=this.getAttribute(t),a=l+"",o===a?null:o===r&&a===i?s:(i=a,s=e(r=o,l)))}}function hM(t,e,n){var r,i,s;return function(){var o,l=n(this),a;return l==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),a=l+"",o===a?null:o===r&&a===i?s:(i=a,s=e(r=o,l)))}}function pM(t,e){var n=wc(t),r=n==="transform"?KO:NS;return this.attrTween(t,typeof e=="function"?(n.local?hM:fM)(n,r,Yp(this,"attr."+t,e)):e==null?(n.local?uM:aM)(n):(n.local?dM:cM)(n,r,e))}function mM(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function gM(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function yM(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&gM(t,s)),n}return i._value=e,i}function vM(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&mM(t,s)),n}return i._value=e,i}function wM(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=wc(t);return this.tween(n,(r.local?yM:vM)(r,e))}function xM(t,e){return function(){Gp(this,t).delay=+e.apply(this,arguments)}}function SM(t,e){return e=+e,function(){Gp(this,t).delay=e}}function bM(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?xM:SM)(e,t)):mn(this.node(),e).delay}function kM(t,e){return function(){Nn(this,t).duration=+e.apply(this,arguments)}}function _M(t,e){return e=+e,function(){Nn(this,t).duration=e}}function EM(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?kM:_M)(e,t)):mn(this.node(),e).duration}function CM(t,e){if(typeof e!="function")throw new Error;return function(){Nn(this,t).ease=e}}function TM(t){var e=this._id;return arguments.length?this.each(CM(e,t)):mn(this.node(),e).ease}function NM(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Nn(this,t).ease=n}}function OM(t){if(typeof t!="function")throw new Error;return this.each(NM(this._id,t))}function MM(t){typeof t!="function"&&(t=sS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,l=r[i]=[],a,u=0;u<o;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&l.push(a);return new Gn(r,this._parents,this._name,this._id)}function AM(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),l=0;l<s;++l)for(var a=e[l],u=n[l],c=a.length,d=o[l]=new Array(c),f,h=0;h<c;++h)(f=a[h]||u[h])&&(d[h]=f);for(;l<r;++l)o[l]=e[l];return new Gn(o,this._parents,this._name,this._id)}function IM(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function RM(t,e,n){var r,i,s=IM(e)?Gp:Nn;return function(){var o=s(this,t),l=o.on;l!==r&&(i=(r=l).copy()).on(e,n),o.on=i}}function PM(t,e){var n=this._id;return arguments.length<2?mn(this.node(),n).on.on(t):this.each(RM(n,t,e))}function DM(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function $M(){return this.on("end.remove",DM(this._id))}function LM(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Hp(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var l=r[o],a=l.length,u=s[o]=new Array(a),c,d,f=0;f<a;++f)(c=l[f])&&(d=t.call(c,c.__data__,f,l))&&("__data__"in c&&(d.__data__=c.__data__),u[f]=d,Sc(u[f],e,n,f,u,mn(c,n)));return new Gn(s,this._parents,e,n)}function jM(t){var e=this._name,n=this._id;typeof t!="function"&&(t=iS(t));for(var r=this._groups,i=r.length,s=[],o=[],l=0;l<i;++l)for(var a=r[l],u=a.length,c,d=0;d<u;++d)if(c=a[d]){for(var f=t.call(c,c.__data__,d,a),h,p=mn(c,n),m=0,v=f.length;m<v;++m)(h=f[m])&&Sc(h,e,n,m,f,p);s.push(f),o.push(c)}return new Gn(s,o,e,n)}var zM=$l.prototype.constructor;function BM(){return new zM(this._groups,this._parents)}function FM(t,e){var n,r,i;return function(){var s=As(this,t),o=(this.style.removeProperty(t),As(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function OS(t){return function(){this.style.removeProperty(t)}}function VM(t,e,n){var r,i=n+"",s;return function(){var o=As(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function UM(t,e,n){var r,i,s;return function(){var o=As(this,t),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(t),As(this,t))),o===a?null:o===r&&a===i?s:(i=a,s=e(r=o,l))}}function HM(t,e){var n,r,i,s="style."+e,o="end."+s,l;return function(){var a=Nn(this,t),u=a.on,c=a.value[s]==null?l||(l=OS(e)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(o,i=c),a.on=r}}function WM(t,e,n){var r=(t+="")=="transform"?qO:NS;return e==null?this.styleTween(t,FM(t,r)).on("end.style."+t,OS(t)):typeof e=="function"?this.styleTween(t,UM(t,r,Yp(this,"style."+t,e))).each(HM(this._id,t)):this.styleTween(t,VM(t,r,e),n).on("end.style."+t,null)}function qM(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function KM(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&qM(t,o,n)),r}return s._value=e,s}function JM(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,KM(t,e,n??""))}function GM(t){return function(){this.textContent=t}}function YM(t){return function(){var e=t(this);this.textContent=e??""}}function XM(t){return this.tween("text",typeof t=="function"?YM(Yp(this,"text",t)):GM(t==null?"":t+""))}function QM(t){return function(e){this.textContent=t.call(this,e)}}function ZM(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&QM(i)),e}return r._value=t,r}function eA(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,ZM(t))}function tA(){for(var t=this._name,e=this._id,n=MS(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,a,u=0;u<l;++u)if(a=o[u]){var c=mn(a,e);Sc(a,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Gn(r,this._parents,t,n)}function nA(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var l={value:o},a={value:function(){--i===0&&s()}};n.each(function(){var u=Nn(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(a)),u.on=e}),i===0&&s()})}var rA=0;function Gn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function MS(){return++rA}var An=$l.prototype;Gn.prototype={constructor:Gn,select:LM,selectAll:jM,selectChild:An.selectChild,selectChildren:An.selectChildren,filter:MM,merge:AM,selection:BM,transition:tA,call:An.call,nodes:An.nodes,node:An.node,size:An.size,empty:An.empty,each:An.each,on:PM,attr:pM,attrTween:wM,style:WM,styleTween:JM,text:XM,textTween:eA,remove:$M,tween:lM,delay:bM,duration:EM,ease:TM,easeVarying:OM,end:nA,[Symbol.iterator]:An[Symbol.iterator]};function iA(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var sA={time:null,delay:0,duration:250,ease:iA};function oA(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function lA(t){var e,n;t instanceof Gn?(e=t._id,t=t._name):(e=MS(),(n=sA).time=Jp(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],l=o.length,a,u=0;u<l;++u)(a=o[u])&&Sc(a,t,e,u,o,n||oA(a,e));return new Gn(r,this._parents,t,e)}$l.prototype.interrupt=iM;$l.prototype.transition=lA;const ga=t=>()=>t;function aA(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function zn(t,e,n){this.k=t,this.x=e,this.y=n}zn.prototype={constructor:zn,scale:function(t){return t===1?this:new zn(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new zn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bc=new zn(1,0,0);AS.prototype=zn.prototype;function AS(t){for(;!t.__zoom;)if(!(t=t.parentNode))return bc;return t.__zoom}function Cd(t){t.stopImmediatePropagation()}function co(t){t.preventDefault(),t.stopImmediatePropagation()}function uA(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function cA(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function py(){return this.__zoom||bc}function dA(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function fA(){return navigator.maxTouchPoints||"ontouchstart"in this}function hA(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function IS(){var t=uA,e=cA,n=hA,r=dA,i=fA,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,a=Ya,u=vc("start","zoom","end"),c,d,f,h=500,p=150,m=0,v=10;function g(T){T.property("__zoom",py).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",L).filter(i).on("touchstart.zoom",A).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(T,D,M,$){var C=T.selection?T.selection():T;C.property("__zoom",py),T!==C?k(T,D,M,$):C.interrupt().each(function(){S(this,arguments).event($).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},g.scaleBy=function(T,D,M,$){g.scaleTo(T,function(){var C=this.__zoom.k,N=typeof D=="function"?D.apply(this,arguments):D;return C*N},M,$)},g.scaleTo=function(T,D,M,$){g.transform(T,function(){var C=e.apply(this,arguments),N=this.__zoom,R=M==null?x(C):typeof M=="function"?M.apply(this,arguments):M,z=N.invert(R),j=typeof D=="function"?D.apply(this,arguments):D;return n(y(w(N,j),R,z),C,o)},M,$)},g.translateBy=function(T,D,M,$){g.transform(T,function(){return n(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof M=="function"?M.apply(this,arguments):M),e.apply(this,arguments),o)},null,$)},g.translateTo=function(T,D,M,$,C){g.transform(T,function(){var N=e.apply(this,arguments),R=this.__zoom,z=$==null?x(N):typeof $=="function"?$.apply(this,arguments):$;return n(bc.translate(z[0],z[1]).scale(R.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof M=="function"?-M.apply(this,arguments):-M),N,o)},$,C)};function w(T,D){return D=Math.max(s[0],Math.min(s[1],D)),D===T.k?T:new zn(D,T.x,T.y)}function y(T,D,M){var $=D[0]-M[0]*T.k,C=D[1]-M[1]*T.k;return $===T.x&&C===T.y?T:new zn(T.k,$,C)}function x(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function k(T,D,M,$){T.on("start.zoom",function(){S(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event($).end()}).tween("zoom",function(){var C=this,N=arguments,R=S(C,N).event($),z=e.apply(C,N),j=M==null?x(z):typeof M=="function"?M.apply(C,N):M,q=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),H=C.__zoom,X=typeof D=="function"?D.apply(C,N):D,Q=a(H.invert(j).concat(q/H.k),X.invert(j).concat(q/X.k));return function(Z){if(Z===1)Z=X;else{var U=Q(Z),te=q/U[2];Z=new zn(te,j[0]-U[0]*te,j[1]-U[1]*te)}R.zoom(null,Z)}})}function S(T,D,M){return!M&&T.__zooming||new b(T,D)}function b(T,D){this.that=T,this.args=D,this.active=0,this.sourceEvent=null,this.extent=e.apply(T,D),this.taps=0}b.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,D){return this.mouse&&T!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var D=At(this.that).datum();u.call(T,this.that,new aA(T,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:u}),D)}};function E(T,...D){if(!t.apply(this,arguments))return;var M=S(this,D).event(T),$=this.__zoom,C=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,r.apply(this,arguments)))),N=sn(T);if(M.wheel)(M.mouse[0][0]!==N[0]||M.mouse[0][1]!==N[1])&&(M.mouse[1]=$.invert(M.mouse[0]=N)),clearTimeout(M.wheel);else{if($.k===C)return;M.mouse=[N,$.invert(N)],Za(this),M.start()}co(T),M.wheel=setTimeout(R,p),M.zoom("mouse",n(y(w($,C),M.mouse[0],M.mouse[1]),M.extent,o));function R(){M.wheel=null,M.end()}}function O(T,...D){if(f||!t.apply(this,arguments))return;var M=T.currentTarget,$=S(this,D,!0).event(T),C=At(T.view).on("mousemove.zoom",j,!0).on("mouseup.zoom",q,!0),N=sn(T,M),R=T.clientX,z=T.clientY;mS(T.view),Cd(T),$.mouse=[N,this.__zoom.invert(N)],Za(this),$.start();function j(H){if(co(H),!$.moved){var X=H.clientX-R,Q=H.clientY-z;$.moved=X*X+Q*Q>m}$.event(H).zoom("mouse",n(y($.that.__zoom,$.mouse[0]=sn(H,M),$.mouse[1]),$.extent,o))}function q(H){C.on("mousemove.zoom mouseup.zoom",null),gS(H.view,$.moved),co(H),$.event(H).end()}}function L(T,...D){if(t.apply(this,arguments)){var M=this.__zoom,$=sn(T.changedTouches?T.changedTouches[0]:T,this),C=M.invert($),N=M.k*(T.shiftKey?.5:2),R=n(y(w(M,N),$,C),e.apply(this,D),o);co(T),l>0?At(this).transition().duration(l).call(k,R,$,T):At(this).call(g.transform,R,$,T)}}function A(T,...D){if(t.apply(this,arguments)){var M=T.touches,$=M.length,C=S(this,D,T.changedTouches.length===$).event(T),N,R,z,j;for(Cd(T),R=0;R<$;++R)z=M[R],j=sn(z,this),j=[j,this.__zoom.invert(j),z.identifier],C.touch0?!C.touch1&&C.touch0[2]!==j[2]&&(C.touch1=j,C.taps=0):(C.touch0=j,N=!0,C.taps=1+!!c);c&&(c=clearTimeout(c)),N&&(C.taps<2&&(d=j[0],c=setTimeout(function(){c=null},h)),Za(this),C.start())}}function P(T,...D){if(this.__zooming){var M=S(this,D).event(T),$=T.changedTouches,C=$.length,N,R,z,j;for(co(T),N=0;N<C;++N)R=$[N],z=sn(R,this),M.touch0&&M.touch0[2]===R.identifier?M.touch0[0]=z:M.touch1&&M.touch1[2]===R.identifier&&(M.touch1[0]=z);if(R=M.that.__zoom,M.touch1){var q=M.touch0[0],H=M.touch0[1],X=M.touch1[0],Q=M.touch1[1],Z=(Z=X[0]-q[0])*Z+(Z=X[1]-q[1])*Z,U=(U=Q[0]-H[0])*U+(U=Q[1]-H[1])*U;R=w(R,Math.sqrt(Z/U)),z=[(q[0]+X[0])/2,(q[1]+X[1])/2],j=[(H[0]+Q[0])/2,(H[1]+Q[1])/2]}else if(M.touch0)z=M.touch0[0],j=M.touch0[1];else return;M.zoom("touch",n(y(R,z,j),M.extent,o))}}function B(T,...D){if(this.__zooming){var M=S(this,D).event(T),$=T.changedTouches,C=$.length,N,R;for(Cd(T),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),N=0;N<C;++N)R=$[N],M.touch0&&M.touch0[2]===R.identifier?delete M.touch0:M.touch1&&M.touch1[2]===R.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(R=sn(R,this),Math.hypot(d[0]-R[0],d[1]-R[1])<v)){var z=At(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return g.wheelDelta=function(T){return arguments.length?(r=typeof T=="function"?T:ga(+T),g):r},g.filter=function(T){return arguments.length?(t=typeof T=="function"?T:ga(!!T),g):t},g.touchable=function(T){return arguments.length?(i=typeof T=="function"?T:ga(!!T),g):i},g.extent=function(T){return arguments.length?(e=typeof T=="function"?T:ga([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),g):e},g.scaleExtent=function(T){return arguments.length?(s[0]=+T[0],s[1]=+T[1],g):[s[0],s[1]]},g.translateExtent=function(T){return arguments.length?(o[0][0]=+T[0][0],o[1][0]=+T[1][0],o[0][1]=+T[0][1],o[1][1]=+T[1][1],g):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},g.constrain=function(T){return arguments.length?(n=T,g):n},g.duration=function(T){return arguments.length?(l=+T,g):l},g.interpolate=function(T){return arguments.length?(a=T,g):a},g.on=function(){var T=u.on.apply(u,arguments);return T===u?g:T},g.clickDistance=function(T){return arguments.length?(m=(T=+T)*T,g):Math.sqrt(m)},g.tapDistance=function(T){return arguments.length?(v=+T,g):v},g}const En={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:r}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},ul=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],RS=["Enter"," ","Escape"],PS={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Rs;(function(t){t.Strict="strict",t.Loose="loose"})(Rs||(Rs={}));var di;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(di||(di={}));var cl;(function(t){t.Partial="partial",t.Full="full"})(cl||(cl={}));const DS={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var fr;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(fr||(fr={}));var Du;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Du||(Du={}));var Y;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(Y||(Y={}));const my={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top};function $S(t){return t===null?null:t?"valid":"invalid"}const LS=t=>"id"in t&&"source"in t&&"target"in t,pA=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),Xp=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),jl=(t,e=[0,0])=>{const{width:n,height:r}=Qn(t),i=t.origin??e,s=n*i[0],o=r*i[1];return{x:t.position.x-s,y:t.position.y-o}},mA=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((r,i)=>{const s=typeof i=="string";let o=!e.nodeLookup&&!s?i:void 0;e.nodeLookup&&(o=s?e.nodeLookup.get(i):Xp(i)?i:e.nodeLookup.get(i.id));const l=o?$u(o,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return kc(r,l)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return _c(n)},zl=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},r=!1;return t.forEach(i=>{(e.filter===void 0||e.filter(i))&&(n=kc(n,$u(i)),r=!0)}),r?_c(n):{x:0,y:0,width:0,height:0}},Qp=(t,e,[n,r,i]=[0,0,1],s=!1,o=!1)=>{const l={...Fl(e,[n,r,i]),width:e.width/i,height:e.height/i},a=[];for(const u of t.values()){const{measured:c,selectable:d=!0,hidden:f=!1}=u;if(o&&!d||f)continue;const h=c.width??u.width??u.initialWidth??null,p=c.height??u.height??u.initialHeight??null,m=dl(l,Ds(u)),v=(h??0)*(p??0),g=s&&m>0;(!u.internals.handleBounds||g||m>=v||u.dragging)&&a.push(u)}return a},gA=(t,e)=>{const n=new Set;return t.forEach(r=>{n.add(r.id)}),e.filter(r=>n.has(r.source)||n.has(r.target))};function yA(t,e){const n=new Map,r=e!=null&&e.nodes?new Set(e.nodes.map(i=>i.id)):null;return t.forEach(i=>{i.measured.width&&i.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!i.hidden)&&(!r||r.has(i.id))&&n.set(i.id,i)}),n}async function vA({nodes:t,width:e,height:n,panZoom:r,minZoom:i,maxZoom:s},o){if(t.size===0)return Promise.resolve(!0);const l=yA(t,o),a=zl(l),u=Zp(a,e,n,(o==null?void 0:o.minZoom)??i,(o==null?void 0:o.maxZoom)??s,(o==null?void 0:o.padding)??.1);return await r.setViewport(u,{duration:o==null?void 0:o.duration,ease:o==null?void 0:o.ease,interpolate:o==null?void 0:o.interpolate}),Promise.resolve(!0)}function jS({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:i,onError:s}){const o=n.get(t),l=o.parentId?n.get(o.parentId):void 0,{x:a,y:u}=l?l.internals.positionAbsolute:{x:0,y:0},c=o.origin??r;let d=o.extent||i;if(o.extent==="parent"&&!o.expandParent)if(!l)s==null||s("005",En.error005());else{const h=l.measured.width,p=l.measured.height;h&&p&&(d=[[a,u],[a+h,u+p]])}else l&&$s(o.extent)&&(d=[[o.extent[0][0]+a,o.extent[0][1]+u],[o.extent[1][0]+a,o.extent[1][1]+u]]);const f=$s(d)?_i(e,d,o.measured):e;return(o.measured.width===void 0||o.measured.height===void 0)&&(s==null||s("015",En.error015())),{position:{x:f.x-a+(o.measured.width??0)*c[0],y:f.y-u+(o.measured.height??0)*c[1]},positionAbsolute:f}}async function wA({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:r,onBeforeDelete:i}){const s=new Set(t.map(f=>f.id)),o=[];for(const f of n){if(f.deletable===!1)continue;const h=s.has(f.id),p=!h&&f.parentId&&o.find(m=>m.id===f.parentId);(h||p)&&o.push(f)}const l=new Set(e.map(f=>f.id)),a=r.filter(f=>f.deletable!==!1),c=gA(o,a);for(const f of a)l.has(f.id)&&!c.find(p=>p.id===f.id)&&c.push(f);if(!i)return{edges:c,nodes:o};const d=await i({nodes:o,edges:c});return typeof d=="boolean"?d?{edges:c,nodes:o}:{edges:[],nodes:[]}:d}const Ps=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),_i=(t={x:0,y:0},e,n)=>({x:Ps(t.x,e[0][0],e[1][0]-((n==null?void 0:n.width)??0)),y:Ps(t.y,e[0][1],e[1][1]-((n==null?void 0:n.height)??0))});function zS(t,e,n){const{width:r,height:i}=Qn(n),{x:s,y:o}=n.internals.positionAbsolute;return _i(t,[[s,o],[s+r,o+i]],e)}const gy=(t,e,n)=>t<e?Ps(Math.abs(t-e),1,e)/e:t>n?-Ps(Math.abs(t-n),1,e)/e:0,BS=(t,e,n=15,r=40)=>{const i=gy(t.x,r,e.width-r)*n,s=gy(t.y,r,e.height-r)*n;return[i,s]},kc=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),dh=({x:t,y:e,width:n,height:r})=>({x:t,y:e,x2:t+n,y2:e+r}),_c=({x:t,y:e,x2:n,y2:r})=>({x:t,y:e,width:n-t,height:r-e}),Ds=(t,e=[0,0])=>{var i,s;const{x:n,y:r}=Xp(t)?t.internals.positionAbsolute:jl(t,e);return{x:n,y:r,width:((i=t.measured)==null?void 0:i.width)??t.width??t.initialWidth??0,height:((s=t.measured)==null?void 0:s.height)??t.height??t.initialHeight??0}},$u=(t,e=[0,0])=>{var i,s;const{x:n,y:r}=Xp(t)?t.internals.positionAbsolute:jl(t,e);return{x:n,y:r,x2:n+(((i=t.measured)==null?void 0:i.width)??t.width??t.initialWidth??0),y2:r+(((s=t.measured)==null?void 0:s.height)??t.height??t.initialHeight??0)}},FS=(t,e)=>_c(kc(dh(t),dh(e))),dl=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),r=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*r)},yy=t=>cn(t.width)&&cn(t.height)&&cn(t.x)&&cn(t.y),cn=t=>!isNaN(t)&&isFinite(t),xA=(t,e)=>{},Bl=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),Fl=({x:t,y:e},[n,r,i],s=!1,o=[1,1])=>{const l={x:(t-n)/i,y:(e-r)/i};return s?Bl(l,o):l},Lu=({x:t,y:e},[n,r,i])=>({x:t*i+n,y:e*i+r});function Di(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function SA(t,e,n){if(typeof t=="string"||typeof t=="number"){const r=Di(t,n),i=Di(t,e);return{top:r,right:i,bottom:r,left:i,x:i*2,y:r*2}}if(typeof t=="object"){const r=Di(t.top??t.y??0,n),i=Di(t.bottom??t.y??0,n),s=Di(t.left??t.x??0,e),o=Di(t.right??t.x??0,e);return{top:r,right:o,bottom:i,left:s,x:s+o,y:r+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function bA(t,e,n,r,i,s){const{x:o,y:l}=Lu(t,[e,n,r]),{x:a,y:u}=Lu({x:t.x+t.width,y:t.y+t.height},[e,n,r]),c=i-a,d=s-u;return{left:Math.floor(o),top:Math.floor(l),right:Math.floor(c),bottom:Math.floor(d)}}const Zp=(t,e,n,r,i,s)=>{const o=SA(s,e,n),l=(e-o.x)/t.width,a=(n-o.y)/t.height,u=Math.min(l,a),c=Ps(u,r,i),d=t.x+t.width/2,f=t.y+t.height/2,h=e/2-d*c,p=n/2-f*c,m=bA(t,h,p,c,e,n),v={left:Math.min(m.left-o.left,0),top:Math.min(m.top-o.top,0),right:Math.min(m.right-o.right,0),bottom:Math.min(m.bottom-o.bottom,0)};return{x:h-v.left+v.right,y:p-v.top+v.bottom,zoom:c}},fl=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0};function $s(t){return t!=null&&t!=="parent"}function Qn(t){var e,n;return{width:((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth??0,height:((n=t.measured)==null?void 0:n.height)??t.height??t.initialHeight??0}}function VS(t){var e,n;return(((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth)!==void 0&&(((n=t.measured)==null?void 0:n.height)??t.height??t.initialHeight)!==void 0}function US(t,e={width:0,height:0},n,r,i){const s={...t},o=r.get(n);if(o){const l=o.origin||i;s.x+=o.internals.positionAbsolute.x-(e.width??0)*l[0],s.y+=o.internals.positionAbsolute.y-(e.height??0)*l[1]}return s}function vy(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function kA(){let t,e;return{promise:new Promise((r,i)=>{t=r,e=i}),resolve:t,reject:e}}function _A(t){return{...PS,...t||{}}}function Po(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:r,containerBounds:i}){const{x:s,y:o}=dn(t),l=Fl({x:s-((i==null?void 0:i.left)??0),y:o-((i==null?void 0:i.top)??0)},r),{x:a,y:u}=n?Bl(l,e):l;return{xSnapped:a,ySnapped:u,...l}}const em=t=>({width:t.offsetWidth,height:t.offsetHeight}),HS=t=>{var e;return((e=t==null?void 0:t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},EA=["INPUT","SELECT","TEXTAREA"];function WS(t){var r,i;const e=((i=(r=t.composedPath)==null?void 0:r.call(t))==null?void 0:i[0])||t.target;return(e==null?void 0:e.nodeType)!==1?!1:EA.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const qS=t=>"clientX"in t,dn=(t,e)=>{var s,o;const n=qS(t),r=n?t.clientX:(s=t.touches)==null?void 0:s[0].clientX,i=n?t.clientY:(o=t.touches)==null?void 0:o[0].clientY;return{x:r-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},wy=(t,e,n,r,i)=>{const s=e.querySelectorAll(`.${t}`);return!s||!s.length?null:Array.from(s).map(o=>{const l=o.getBoundingClientRect();return{id:o.getAttribute("data-handleid"),type:t,nodeId:i,position:o.getAttribute("data-handlepos"),x:(l.left-n.left)/r,y:(l.top-n.top)/r,...em(o)}})};function KS({sourceX:t,sourceY:e,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:l}){const a=t*.125+i*.375+o*.375+n*.125,u=e*.125+s*.375+l*.375+r*.125,c=Math.abs(a-t),d=Math.abs(u-e);return[a,u,c,d]}function ya(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function xy({pos:t,x1:e,y1:n,x2:r,y2:i,c:s}){switch(t){case Y.Left:return[e-ya(e-r,s),n];case Y.Right:return[e+ya(r-e,s),n];case Y.Top:return[e,n-ya(n-i,s)];case Y.Bottom:return[e,n+ya(i-n,s)]}}function JS({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:r,targetY:i,targetPosition:s=Y.Top,curvature:o=.25}){const[l,a]=xy({pos:n,x1:t,y1:e,x2:r,y2:i,c:o}),[u,c]=xy({pos:s,x1:r,y1:i,x2:t,y2:e,c:o}),[d,f,h,p]=KS({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:l,sourceControlY:a,targetControlX:u,targetControlY:c});return[`M${t},${e} C${l},${a} ${u},${c} ${r},${i}`,d,f,h,p]}function GS({sourceX:t,sourceY:e,targetX:n,targetY:r}){const i=Math.abs(n-t)/2,s=n<t?n+i:n-i,o=Math.abs(r-e)/2,l=r<e?r+o:r-o;return[s,l,i,o]}function CA({sourceNode:t,targetNode:e,selected:n=!1,zIndex:r=0,elevateOnSelect:i=!1,zIndexMode:s="basic"}){if(s==="manual")return r;const o=i&&n?r+1e3:r,l=Math.max(t.parentId||i&&t.selected?t.internals.z:0,e.parentId||i&&e.selected?e.internals.z:0);return o+l}function TA({sourceNode:t,targetNode:e,width:n,height:r,transform:i}){const s=kc($u(t),$u(e));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const o={x:-i[0]/i[2],y:-i[1]/i[2],width:n/i[2],height:r/i[2]};return dl(o,_c(s))>0}const NA=({source:t,sourceHandle:e,target:n,targetHandle:r})=>`xy-edge__${t}${e||""}-${n}${r||""}`,OA=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),YS=(t,e,n={})=>{if(!t.source||!t.target)return e;const r=n.getEdgeId||NA;let i;return LS(t)?i={...t}:i={...t,id:r(t)},OA(i,e)?e:(i.sourceHandle===null&&delete i.sourceHandle,i.targetHandle===null&&delete i.targetHandle,e.concat(i))};function XS({sourceX:t,sourceY:e,targetX:n,targetY:r}){const[i,s,o,l]=GS({sourceX:t,sourceY:e,targetX:n,targetY:r});return[`M ${t},${e}L ${n},${r}`,i,s,o,l]}const Sy={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},MA=({source:t,sourcePosition:e=Y.Bottom,target:n})=>e===Y.Left||e===Y.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},by=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function AA({source:t,sourcePosition:e=Y.Bottom,target:n,targetPosition:r=Y.Top,center:i,offset:s,stepPosition:o}){const l=Sy[e],a=Sy[r],u={x:t.x+l.x*s,y:t.y+l.y*s},c={x:n.x+a.x*s,y:n.y+a.y*s},d=MA({source:u,sourcePosition:e,target:c}),f=d.x!==0?"x":"y",h=d[f];let p=[],m,v;const g={x:0,y:0},w={x:0,y:0},[,,y,x]=GS({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(l[f]*a[f]===-1){f==="x"?(m=i.x??u.x+(c.x-u.x)*o,v=i.y??(u.y+c.y)/2):(m=i.x??(u.x+c.x)/2,v=i.y??u.y+(c.y-u.y)*o);const S=[{x:m,y:u.y},{x:m,y:c.y}],b=[{x:u.x,y:v},{x:c.x,y:v}];l[f]===h?p=f==="x"?S:b:p=f==="x"?b:S}else{const S=[{x:u.x,y:c.y}],b=[{x:c.x,y:u.y}];if(f==="x"?p=l.x===h?b:S:p=l.y===h?S:b,e===r){const P=Math.abs(t[f]-n[f]);if(P<=s){const B=Math.min(s-1,s-P);l[f]===h?g[f]=(u[f]>t[f]?-1:1)*B:w[f]=(c[f]>n[f]?-1:1)*B}}if(e!==r){const P=f==="x"?"y":"x",B=l[f]===a[P],T=u[P]>c[P],D=u[P]<c[P];(l[f]===1&&(!B&&T||B&&D)||l[f]!==1&&(!B&&D||B&&T))&&(p=f==="x"?S:b)}const E={x:u.x+g.x,y:u.y+g.y},O={x:c.x+w.x,y:c.y+w.y},L=Math.max(Math.abs(E.x-p[0].x),Math.abs(O.x-p[0].x)),A=Math.max(Math.abs(E.y-p[0].y),Math.abs(O.y-p[0].y));L>=A?(m=(E.x+O.x)/2,v=p[0].y):(m=p[0].x,v=(E.y+O.y)/2)}return[[t,{x:u.x+g.x,y:u.y+g.y},...p,{x:c.x+w.x,y:c.y+w.y},n],m,v,y,x]}function IA(t,e,n,r){const i=Math.min(by(t,e)/2,by(e,n)/2,r),{x:s,y:o}=e;if(t.x===s&&s===n.x||t.y===o&&o===n.y)return`L${s} ${o}`;if(t.y===o){const u=t.x<n.x?-1:1,c=t.y<n.y?1:-1;return`L ${s+i*u},${o}Q ${s},${o} ${s},${o+i*c}`}const l=t.x<n.x?1:-1,a=t.y<n.y?-1:1;return`L ${s},${o+i*a}Q ${s},${o} ${s+i*l},${o}`}function fh({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:r,targetY:i,targetPosition:s=Y.Top,borderRadius:o=5,centerX:l,centerY:a,offset:u=20,stepPosition:c=.5}){const[d,f,h,p,m]=AA({source:{x:t,y:e},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:l,y:a},offset:u,stepPosition:c});return[d.reduce((g,w,y)=>{let x="";return y>0&&y<d.length-1?x=IA(d[y-1],w,d[y+1],o):x=`${y===0?"M":"L"}${w.x} ${w.y}`,g+=x,g},""),f,h,p,m]}function ky(t){var e;return t&&!!(t.internals.handleBounds||(e=t.handles)!=null&&e.length)&&!!(t.measured.width||t.width||t.initialWidth)}function RA(t){var d;const{sourceNode:e,targetNode:n}=t;if(!ky(e)||!ky(n))return null;const r=e.internals.handleBounds||_y(e.handles),i=n.internals.handleBounds||_y(n.handles),s=Ey((r==null?void 0:r.source)??[],t.sourceHandle),o=Ey(t.connectionMode===Rs.Strict?(i==null?void 0:i.target)??[]:((i==null?void 0:i.target)??[]).concat((i==null?void 0:i.source)??[]),t.targetHandle);if(!s||!o)return(d=t.onError)==null||d.call(t,"008",En.error008(s?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const l=(s==null?void 0:s.position)||Y.Bottom,a=(o==null?void 0:o.position)||Y.Top,u=Ei(e,s,l),c=Ei(n,o,a);return{sourceX:u.x,sourceY:u.y,targetX:c.x,targetY:c.y,sourcePosition:l,targetPosition:a}}function _y(t){if(!t)return null;const e=[],n=[];for(const r of t)r.width=r.width??1,r.height=r.height??1,r.type==="source"?e.push(r):r.type==="target"&&n.push(r);return{source:e,target:n}}function Ei(t,e,n=Y.Left,r=!1){const i=((e==null?void 0:e.x)??0)+t.internals.positionAbsolute.x,s=((e==null?void 0:e.y)??0)+t.internals.positionAbsolute.y,{width:o,height:l}=e??Qn(t);if(r)return{x:i+o/2,y:s+l/2};switch((e==null?void 0:e.position)??n){case Y.Top:return{x:i+o/2,y:s};case Y.Right:return{x:i+o,y:s+l/2};case Y.Bottom:return{x:i+o/2,y:s+l};case Y.Left:return{x:i,y:s+l/2}}}function Ey(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function hh(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(r=>`${r}=${t[r]}`).join("&")}`:""}function PA(t,{id:e,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:i}){const s=new Set;return t.reduce((o,l)=>([l.markerStart||r,l.markerEnd||i].forEach(a=>{if(a&&typeof a=="object"){const u=hh(a,e);s.has(u)||(o.push({id:u,color:a.color||n,...a}),s.add(u))}}),o),[]).sort((o,l)=>o.id.localeCompare(l.id))}const QS=1e3,DA=10,tm={nodeOrigin:[0,0],nodeExtent:ul,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},$A={...tm,checkEquality:!0};function nm(t,e){const n={...t};for(const r in e)e[r]!==void 0&&(n[r]=e[r]);return n}function LA(t,e,n){const r=nm(tm,n);for(const i of t.values())if(i.parentId)im(i,t,e,r);else{const s=jl(i,r.nodeOrigin),o=$s(i.extent)?i.extent:r.nodeExtent,l=_i(s,o,Qn(i));i.internals.positionAbsolute=l}}function jA(t,e){if(!t.handles)return t.measured?e==null?void 0:e.internals.handleBounds:void 0;const n=[],r=[];for(const i of t.handles){const s={id:i.id,width:i.width??1,height:i.height??1,nodeId:t.id,x:i.x,y:i.y,position:i.position,type:i.type};i.type==="source"?n.push(s):i.type==="target"&&r.push(s)}return{source:n,target:r}}function rm(t){return t==="manual"}function ph(t,e,n,r={}){var u,c;const i=nm($A,r),s={i:0},o=new Map(e),l=i!=null&&i.elevateNodesOnSelect&&!rm(i.zIndexMode)?QS:0;let a=t.length>0;e.clear(),n.clear();for(const d of t){let f=o.get(d.id);if(i.checkEquality&&d===(f==null?void 0:f.internals.userNode))e.set(d.id,f);else{const h=jl(d,i.nodeOrigin),p=$s(d.extent)?d.extent:i.nodeExtent,m=_i(h,p,Qn(d));f={...i.defaults,...d,measured:{width:(u=d.measured)==null?void 0:u.width,height:(c=d.measured)==null?void 0:c.height},internals:{positionAbsolute:m,handleBounds:jA(d,f),z:ZS(d,l,i.zIndexMode),userNode:d}},e.set(d.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(a=!1),d.parentId&&im(f,e,n,r,s)}return a}function zA(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function im(t,e,n,r,i){const{elevateNodesOnSelect:s,nodeOrigin:o,nodeExtent:l,zIndexMode:a}=nm(tm,r),u=t.parentId,c=e.get(u);if(!c){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}zA(t,n),i&&!c.parentId&&c.internals.rootParentIndex===void 0&&a==="auto"&&(c.internals.rootParentIndex=++i.i,c.internals.z=c.internals.z+i.i*DA),i&&c.internals.rootParentIndex!==void 0&&(i.i=c.internals.rootParentIndex);const d=s&&!rm(a)?QS:0,{x:f,y:h,z:p}=BA(t,c,o,l,d,a),{positionAbsolute:m}=t.internals,v=f!==m.x||h!==m.y;(v||p!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:v?{x:f,y:h}:m,z:p}})}function ZS(t,e,n){const r=cn(t.zIndex)?t.zIndex:0;return rm(n)?r:r+(t.selected?e:0)}function BA(t,e,n,r,i,s){const{x:o,y:l}=e.internals.positionAbsolute,a=Qn(t),u=jl(t,n),c=$s(t.extent)?_i(u,t.extent,a):u;let d=_i({x:o+c.x,y:l+c.y},r,a);t.extent==="parent"&&(d=zS(d,a,e));const f=ZS(t,i,s),h=e.internals.z??0;return{x:d.x,y:d.y,z:h>=f?h+1:f}}function sm(t,e,n,r=[0,0]){var o;const i=[],s=new Map;for(const l of t){const a=e.get(l.parentId);if(!a)continue;const u=((o=s.get(l.parentId))==null?void 0:o.expandedRect)??Ds(a),c=FS(u,l.rect);s.set(l.parentId,{expandedRect:c,parent:a})}return s.size>0&&s.forEach(({expandedRect:l,parent:a},u)=>{var y;const c=a.internals.positionAbsolute,d=Qn(a),f=a.origin??r,h=l.x<c.x?Math.round(Math.abs(c.x-l.x)):0,p=l.y<c.y?Math.round(Math.abs(c.y-l.y)):0,m=Math.max(d.width,Math.round(l.width)),v=Math.max(d.height,Math.round(l.height)),g=(m-d.width)*f[0],w=(v-d.height)*f[1];(h>0||p>0||g||w)&&(i.push({id:u,type:"position",position:{x:a.position.x-h+g,y:a.position.y-p+w}}),(y=n.get(u))==null||y.forEach(x=>{t.some(k=>k.id===x.id)||i.push({id:x.id,type:"position",position:{x:x.position.x+h,y:x.position.y+p}})})),(d.width<l.width||d.height<l.height||h||p)&&i.push({id:u,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?f[0]*h-g:0),height:v+(p?f[1]*p-w:0)}})}),i}function FA(t,e,n,r,i,s,o){const l=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!l)return{changes:[],updatedInternals:a};const u=[],c=window.getComputedStyle(l),{m22:d}=new window.DOMMatrixReadOnly(c.transform),f=[];for(const h of t.values()){const p=e.get(h.id);if(!p)continue;if(p.hidden){e.set(p.id,{...p,internals:{...p.internals,handleBounds:void 0}}),a=!0;continue}const m=em(h.nodeElement),v=p.measured.width!==m.width||p.measured.height!==m.height;if(!!(m.width&&m.height&&(v||!p.internals.handleBounds||h.force))){const w=h.nodeElement.getBoundingClientRect(),y=$s(p.extent)?p.extent:s;let{positionAbsolute:x}=p.internals;p.parentId&&p.extent==="parent"?x=zS(x,m,e.get(p.parentId)):y&&(x=_i(x,y,m));const k={...p,measured:m,internals:{...p.internals,positionAbsolute:x,handleBounds:{source:wy("source",h.nodeElement,w,d,p.id),target:wy("target",h.nodeElement,w,d,p.id)}}};e.set(p.id,k),p.parentId&&im(k,e,n,{nodeOrigin:i,zIndexMode:o}),a=!0,v&&(u.push({id:p.id,type:"dimensions",dimensions:m}),p.expandParent&&p.parentId&&f.push({id:p.id,parentId:p.parentId,rect:Ds(k,i)}))}}if(f.length>0){const h=sm(f,e,n,i);u.push(...h)}return{changes:u,updatedInternals:a}}async function VA({delta:t,panZoom:e,transform:n,translateExtent:r,width:i,height:s}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const o=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[i,s]],r),l=!!o&&(o.x!==n[0]||o.y!==n[1]||o.k!==n[2]);return Promise.resolve(l)}function Cy(t,e,n,r,i,s){let o=i;const l=r.get(o)||new Map;r.set(o,l.set(n,e)),o=`${i}-${t}`;const a=r.get(o)||new Map;if(r.set(o,a.set(n,e)),s){o=`${i}-${t}-${s}`;const u=r.get(o)||new Map;r.set(o,u.set(n,e))}}function eb(t,e,n){t.clear(),e.clear();for(const r of n){const{source:i,target:s,sourceHandle:o=null,targetHandle:l=null}=r,a={edgeId:r.id,source:i,target:s,sourceHandle:o,targetHandle:l},u=`${i}-${o}--${s}-${l}`,c=`${s}-${l}--${i}-${o}`;Cy("source",a,c,t,i,o),Cy("target",a,u,t,s,l),e.set(r.id,r)}}function tb(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:tb(n,e):!1}function Ty(t,e,n){var i;let r=t;do{if((i=r==null?void 0:r.matches)!=null&&i.call(r,e))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function UA(t,e,n,r){const i=new Map;for(const[s,o]of t)if((o.selected||o.id===r)&&(!o.parentId||!tb(o,t))&&(o.draggable||e&&typeof o.draggable>"u")){const l=t.get(s);l&&i.set(s,{id:s,position:l.position||{x:0,y:0},distance:{x:n.x-l.internals.positionAbsolute.x,y:n.y-l.internals.positionAbsolute.y},extent:l.extent,parentId:l.parentId,origin:l.origin,expandParent:l.expandParent,internals:{positionAbsolute:l.internals.positionAbsolute||{x:0,y:0}},measured:{width:l.measured.width??0,height:l.measured.height??0}})}return i}function Td({nodeId:t,dragItems:e,nodeLookup:n,dragging:r=!0}){var o,l,a;const i=[];for(const[u,c]of e){const d=(o=n.get(u))==null?void 0:o.internals.userNode;d&&i.push({...d,position:c.position,dragging:r})}if(!t)return[i[0],i];const s=(l=n.get(t))==null?void 0:l.internals.userNode;return[s?{...s,position:((a=e.get(t))==null?void 0:a.position)||s.position,dragging:r}:i[0],i]}function HA({dragItems:t,snapGrid:e,x:n,y:r}){const i=t.values().next().value;if(!i)return null;const s={x:n-i.distance.x,y:r-i.distance.y},o=Bl(s,e);return{x:o.x-s.x,y:o.y-s.y}}function WA({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:r,onDragStop:i}){let s={x:null,y:null},o=0,l=new Map,a=!1,u={x:0,y:0},c=null,d=!1,f=null,h=!1,p=!1,m=null;function v({noDragClassName:w,handleSelector:y,domNode:x,isSelectable:k,nodeId:S,nodeClickDistance:b=0}){f=At(x);function E({x:P,y:B}){const{nodeLookup:T,nodeExtent:D,snapGrid:M,snapToGrid:$,nodeOrigin:C,onNodeDrag:N,onSelectionDrag:R,onError:z,updateNodePositions:j}=e();s={x:P,y:B};let q=!1;const H=l.size>1,X=H&&D?dh(zl(l)):null,Q=H&&$?HA({dragItems:l,snapGrid:M,x:P,y:B}):null;for(const[Z,U]of l){if(!T.has(Z))continue;let te={x:P-U.distance.x,y:B-U.distance.y};$&&(te=Q?{x:Math.round(te.x+Q.x),y:Math.round(te.y+Q.y)}:Bl(te,M));let ce=null;if(H&&D&&!U.extent&&X){const{positionAbsolute:re}=U.internals,me=re.x-X.x+D[0][0],xe=re.x+U.measured.width-X.x2+D[1][0],pe=re.y-X.y+D[0][1],it=re.y+U.measured.height-X.y2+D[1][1];ce=[[me,pe],[xe,it]]}const{position:le,positionAbsolute:se}=jS({nodeId:Z,nextPosition:te,nodeLookup:T,nodeExtent:ce||D,nodeOrigin:C,onError:z});q=q||U.position.x!==le.x||U.position.y!==le.y,U.position=le,U.internals.positionAbsolute=se}if(p=p||q,!!q&&(j(l,!0),m&&(r||N||!S&&R))){const[Z,U]=Td({nodeId:S,dragItems:l,nodeLookup:T});r==null||r(m,l,Z,U),N==null||N(m,Z,U),S||R==null||R(m,U)}}async function O(){if(!c)return;const{transform:P,panBy:B,autoPanSpeed:T,autoPanOnNodeDrag:D}=e();if(!D){a=!1,cancelAnimationFrame(o);return}const[M,$]=BS(u,c,T);(M!==0||$!==0)&&(s.x=(s.x??0)-M/P[2],s.y=(s.y??0)-$/P[2],await B({x:M,y:$})&&E(s)),o=requestAnimationFrame(O)}function L(P){var H;const{nodeLookup:B,multiSelectionActive:T,nodesDraggable:D,transform:M,snapGrid:$,snapToGrid:C,selectNodesOnDrag:N,onNodeDragStart:R,onSelectionDragStart:z,unselectNodesAndEdges:j}=e();d=!0,(!N||!k)&&!T&&S&&((H=B.get(S))!=null&&H.selected||j()),k&&N&&S&&(t==null||t(S));const q=Po(P.sourceEvent,{transform:M,snapGrid:$,snapToGrid:C,containerBounds:c});if(s=q,l=UA(B,D,q,S),l.size>0&&(n||R||!S&&z)){const[X,Q]=Td({nodeId:S,dragItems:l,nodeLookup:B});n==null||n(P.sourceEvent,l,X,Q),R==null||R(P.sourceEvent,X,Q),S||z==null||z(P.sourceEvent,Q)}}const A=yS().clickDistance(b).on("start",P=>{const{domNode:B,nodeDragThreshold:T,transform:D,snapGrid:M,snapToGrid:$}=e();c=(B==null?void 0:B.getBoundingClientRect())||null,h=!1,p=!1,m=P.sourceEvent,T===0&&L(P),s=Po(P.sourceEvent,{transform:D,snapGrid:M,snapToGrid:$,containerBounds:c}),u=dn(P.sourceEvent,c)}).on("drag",P=>{const{autoPanOnNodeDrag:B,transform:T,snapGrid:D,snapToGrid:M,nodeDragThreshold:$,nodeLookup:C}=e(),N=Po(P.sourceEvent,{transform:T,snapGrid:D,snapToGrid:M,containerBounds:c});if(m=P.sourceEvent,(P.sourceEvent.type==="touchmove"&&P.sourceEvent.touches.length>1||S&&!C.has(S))&&(h=!0),!h){if(!a&&B&&d&&(a=!0,O()),!d){const R=dn(P.sourceEvent,c),z=R.x-u.x,j=R.y-u.y;Math.sqrt(z*z+j*j)>$&&L(P)}(s.x!==N.xSnapped||s.y!==N.ySnapped)&&l&&d&&(u=dn(P.sourceEvent,c),E(N))}}).on("end",P=>{if(!(!d||h)&&(a=!1,d=!1,cancelAnimationFrame(o),l.size>0)){const{nodeLookup:B,updateNodePositions:T,onNodeDragStop:D,onSelectionDragStop:M}=e();if(p&&(T(l,!1),p=!1),i||D||!S&&M){const[$,C]=Td({nodeId:S,dragItems:l,nodeLookup:B,dragging:!1});i==null||i(P.sourceEvent,l,$,C),D==null||D(P.sourceEvent,$,C),S||M==null||M(P.sourceEvent,C)}}}).filter(P=>{const B=P.target;return!P.button&&(!w||!Ty(B,`.${w}`,x))&&(!y||Ty(B,y,x))});f.call(A)}function g(){f==null||f.on(".drag",null)}return{update:v,destroy:g}}function qA(t,e,n){const r=[],i={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const s of e.values())dl(i,Ds(s))>0&&r.push(s);return r}const KA=250;function JA(t,e,n,r){var l,a;let i=[],s=1/0;const o=qA(t,n,e+KA);for(const u of o){const c=[...((l=u.internals.handleBounds)==null?void 0:l.source)??[],...((a=u.internals.handleBounds)==null?void 0:a.target)??[]];for(const d of c){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:h}=Ei(u,d,d.position,!0),p=Math.sqrt(Math.pow(f-t.x,2)+Math.pow(h-t.y,2));p>e||(p<s?(i=[{...d,x:f,y:h}],s=p):p===s&&i.push({...d,x:f,y:h}))}}if(!i.length)return null;if(i.length>1){const u=r.type==="source"?"target":"source";return i.find(c=>c.type===u)??i[0]}return i[0]}function nb(t,e,n,r,i,s=!1){var u,c,d;const o=r.get(t);if(!o)return null;const l=i==="strict"?(u=o.internals.handleBounds)==null?void 0:u[e]:[...((c=o.internals.handleBounds)==null?void 0:c.source)??[],...((d=o.internals.handleBounds)==null?void 0:d.target)??[]],a=(n?l==null?void 0:l.find(f=>f.id===n):l==null?void 0:l[0])??null;return a&&s?{...a,...Ei(o,a,a.position,!0)}:a}function rb(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function GA(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const ib=()=>!0;function YA(t,{connectionMode:e,connectionRadius:n,handleId:r,nodeId:i,edgeUpdaterType:s,isTarget:o,domNode:l,nodeLookup:a,lib:u,autoPanOnConnect:c,flowId:d,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:m,onConnectEnd:v,isValidConnection:g=ib,onReconnectEnd:w,updateConnection:y,getTransform:x,getFromHandle:k,autoPanSpeed:S,dragThreshold:b=1,handleDomNode:E}){const O=HS(t.target);let L=0,A;const{x:P,y:B}=dn(t),T=rb(s,E),D=l==null?void 0:l.getBoundingClientRect();let M=!1;if(!D||!T)return;const $=nb(i,T,r,a,e);if(!$)return;let C=dn(t,D),N=!1,R=null,z=!1,j=null;function q(){if(!c||!D)return;const[le,se]=BS(C,D,S);f({x:le,y:se}),L=requestAnimationFrame(q)}const H={...$,nodeId:i,type:T,position:$.position},X=a.get(i);let Z={inProgress:!0,isValid:null,from:Ei(X,H,Y.Left,!0),fromHandle:H,fromPosition:H.position,fromNode:X,to:C,toHandle:null,toPosition:my[H.position],toNode:null,pointer:C};function U(){M=!0,y(Z),p==null||p(t,{nodeId:i,handleId:r,handleType:T})}b===0&&U();function te(le){if(!M){const{x:it,y:er}=dn(le),Mn=it-P,Ur=er-B;if(!(Mn*Mn+Ur*Ur>b*b))return;U()}if(!k()||!H){ce(le);return}const se=x();C=dn(le,D),A=JA(Fl(C,se,!1,[1,1]),n,a,H),N||(q(),N=!0);const re=sb(le,{handle:A,connectionMode:e,fromNodeId:i,fromHandleId:r,fromType:o?"target":"source",isValidConnection:g,doc:O,lib:u,flowId:d,nodeLookup:a});j=re.handleDomNode,R=re.connection,z=GA(!!A,re.isValid);const me=a.get(i),xe=me?Ei(me,H,Y.Left,!0):Z.from,pe={...Z,from:xe,isValid:z,to:re.toHandle&&z?Lu({x:re.toHandle.x,y:re.toHandle.y},se):C,toHandle:re.toHandle,toPosition:z&&re.toHandle?re.toHandle.position:my[H.position],toNode:re.toHandle?a.get(re.toHandle.nodeId):null,pointer:C};y(pe),Z=pe}function ce(le){if(!("touches"in le&&le.touches.length>0)){if(M){(A||j)&&R&&z&&(m==null||m(R));const{inProgress:se,...re}=Z,me={...re,toPosition:Z.toHandle?Z.toPosition:null};v==null||v(le,me),s&&(w==null||w(le,me))}h(),cancelAnimationFrame(L),N=!1,z=!1,R=null,j=null,O.removeEventListener("mousemove",te),O.removeEventListener("mouseup",ce),O.removeEventListener("touchmove",te),O.removeEventListener("touchend",ce)}}O.addEventListener("mousemove",te),O.addEventListener("mouseup",ce),O.addEventListener("touchmove",te),O.addEventListener("touchend",ce)}function sb(t,{handle:e,connectionMode:n,fromNodeId:r,fromHandleId:i,fromType:s,doc:o,lib:l,flowId:a,isValidConnection:u=ib,nodeLookup:c}){const d=s==="target",f=e?o.querySelector(`.${l}-flow__handle[data-id="${a}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:h,y:p}=dn(t),m=o.elementFromPoint(h,p),v=m!=null&&m.classList.contains(`${l}-flow__handle`)?m:f,g={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=rb(void 0,v),y=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),k=v.classList.contains("connectable"),S=v.classList.contains("connectableend");if(!y||!w)return g;const b={source:d?y:r,sourceHandle:d?x:i,target:d?r:y,targetHandle:d?i:x};g.connection=b;const O=k&&S&&(n===Rs.Strict?d&&w==="source"||!d&&w==="target":y!==r||x!==i);g.isValid=O&&u(b),g.toHandle=nb(y,w,x,c,n,!0)}return g}const mh={onPointerDown:YA,isValid:sb};function XA({domNode:t,panZoom:e,getTransform:n,getViewScale:r}){const i=At(t);function s({translateExtent:l,width:a,height:u,zoomStep:c=1,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){const p=y=>{if(y.sourceEvent.type!=="wheel"||!e)return;const x=n(),k=y.sourceEvent.ctrlKey&&fl()?10:1,S=-y.sourceEvent.deltaY*(y.sourceEvent.deltaMode===1?.05:y.sourceEvent.deltaMode?1:.002)*c,b=x[2]*Math.pow(2,S*k);e.scaleTo(b)};let m=[0,0];const v=y=>{(y.sourceEvent.type==="mousedown"||y.sourceEvent.type==="touchstart")&&(m=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY])},g=y=>{const x=n();if(y.sourceEvent.type!=="mousemove"&&y.sourceEvent.type!=="touchmove"||!e)return;const k=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY],S=[k[0]-m[0],k[1]-m[1]];m=k;const b=r()*Math.max(x[2],Math.log(x[2]))*(h?-1:1),E={x:x[0]-S[0]*b,y:x[1]-S[1]*b},O=[[0,0],[a,u]];e.setViewportConstrained({x:E.x,y:E.y,zoom:x[2]},O,l)},w=IS().on("start",v).on("zoom",d?g:null).on("zoom.wheel",f?p:null);i.call(w,{})}function o(){i.on("zoom",null)}return{update:s,destroy:o,pointer:sn}}const Ec=t=>({x:t.x,y:t.y,zoom:t.k}),Nd=({x:t,y:e,zoom:n})=>bc.translate(t,e).scale(n),as=(t,e)=>t.target.closest(`.${e}`),ob=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),QA=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,Od=(t,e=0,n=QA,r=()=>{})=>{const i=typeof e=="number"&&e>0;return i||r(),i?t.transition().duration(e).ease(n).on("end",r):t},lb=t=>{const e=t.ctrlKey&&fl()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function ZA({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:r,panOnScrollMode:i,panOnScrollSpeed:s,zoomOnPinch:o,onPanZoomStart:l,onPanZoom:a,onPanZoomEnd:u}){return c=>{if(as(c,e))return c.ctrlKey&&c.preventDefault(),!1;c.preventDefault(),c.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(c.ctrlKey&&o){const v=sn(c),g=lb(c),w=d*Math.pow(2,g);r.scaleTo(n,w,v,c);return}const f=c.deltaMode===1?20:1;let h=i===di.Vertical?0:c.deltaX*f,p=i===di.Horizontal?0:c.deltaY*f;!fl()&&c.shiftKey&&i!==di.Vertical&&(h=c.deltaY*f,p=0),r.translateBy(n,-(h/d)*s,-(p/d)*s,{internal:!0});const m=Ec(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(a==null||a(c,m),t.panScrollTimeout=setTimeout(()=>{u==null||u(c,m),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,l==null||l(c,m))}}function eI({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(r,i){const s=r.type==="wheel",o=!e&&s&&!r.ctrlKey,l=as(r,t);if(r.ctrlKey&&s&&l&&r.preventDefault(),o||l)return null;r.preventDefault(),n.call(this,r,i)}}function tI({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return r=>{var s,o,l;if((s=r.sourceEvent)!=null&&s.internal)return;const i=Ec(r.transform);t.mouseButton=((o=r.sourceEvent)==null?void 0:o.button)||0,t.isZoomingOrPanning=!0,t.prevViewport=i,((l=r.sourceEvent)==null?void 0:l.type)==="mousedown"&&e(!0),n&&(n==null||n(r.sourceEvent,i))}}function nI({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:r,onPanZoom:i}){return s=>{var o,l;t.usedRightMouseButton=!!(n&&ob(e,t.mouseButton??0)),(o=s.sourceEvent)!=null&&o.sync||r([s.transform.x,s.transform.y,s.transform.k]),i&&!((l=s.sourceEvent)!=null&&l.internal)&&(i==null||i(s.sourceEvent,Ec(s.transform)))}}function rI({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:i,onPaneContextMenu:s}){return o=>{var l;if(!((l=o.sourceEvent)!=null&&l.internal)&&(t.isZoomingOrPanning=!1,s&&ob(e,t.mouseButton??0)&&!t.usedRightMouseButton&&o.sourceEvent&&s(o.sourceEvent),t.usedRightMouseButton=!1,r(!1),i)){const a=Ec(o.transform);t.prevViewport=a,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{i==null||i(o.sourceEvent,a)},n?150:0)}}}function iI({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:r,panOnScroll:i,zoomOnDoubleClick:s,userSelectionActive:o,noWheelClassName:l,noPanClassName:a,lib:u,connectionInProgress:c}){return d=>{var v;const f=t||e,h=n&&d.ctrlKey,p=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(as(d,`${u}-flow__node`)||as(d,`${u}-flow__edge`)))return!0;if(!r&&!f&&!i&&!s&&!n||o||c&&!p||as(d,l)&&p||as(d,a)&&(!p||i&&p&&!t)||!n&&d.ctrlKey&&p)return!1;if(!n&&d.type==="touchstart"&&((v=d.touches)==null?void 0:v.length)>1)return d.preventDefault(),!1;if(!f&&!i&&!h&&p||!r&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(r)&&!r.includes(d.button)&&d.type==="mousedown")return!1;const m=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||p)&&m}}function sI({domNode:t,minZoom:e,maxZoom:n,translateExtent:r,viewport:i,onPanZoom:s,onPanZoomStart:o,onPanZoomEnd:l,onDraggingChange:a}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},c=t.getBoundingClientRect(),d=IS().scaleExtent([e,n]).translateExtent(r),f=At(t).call(d);w({x:i.x,y:i.y,zoom:Ps(i.zoom,e,n)},[[0,0],[c.width,c.height]],r);const h=f.on("wheel.zoom"),p=f.on("dblclick.zoom");d.wheelDelta(lb);function m(A,P){return f?new Promise(B=>{d==null||d.interpolate((P==null?void 0:P.interpolate)==="linear"?Ro:Ya).transform(Od(f,P==null?void 0:P.duration,P==null?void 0:P.ease,()=>B(!0)),A)}):Promise.resolve(!1)}function v({noWheelClassName:A,noPanClassName:P,onPaneContextMenu:B,userSelectionActive:T,panOnScroll:D,panOnDrag:M,panOnScrollMode:$,panOnScrollSpeed:C,preventScrolling:N,zoomOnPinch:R,zoomOnScroll:z,zoomOnDoubleClick:j,zoomActivationKeyPressed:q,lib:H,onTransformChange:X,connectionInProgress:Q,paneClickDistance:Z,selectionOnDrag:U}){T&&!u.isZoomingOrPanning&&g();const te=D&&!q&&!T;d.clickDistance(U?1/0:!cn(Z)||Z<0?0:Z);const ce=te?ZA({zoomPanValues:u,noWheelClassName:A,d3Selection:f,d3Zoom:d,panOnScrollMode:$,panOnScrollSpeed:C,zoomOnPinch:R,onPanZoomStart:o,onPanZoom:s,onPanZoomEnd:l}):eI({noWheelClassName:A,preventScrolling:N,d3ZoomHandler:h});if(f.on("wheel.zoom",ce,{passive:!1}),!T){const se=tI({zoomPanValues:u,onDraggingChange:a,onPanZoomStart:o});d.on("start",se);const re=nI({zoomPanValues:u,panOnDrag:M,onPaneContextMenu:!!B,onPanZoom:s,onTransformChange:X});d.on("zoom",re);const me=rI({zoomPanValues:u,panOnDrag:M,panOnScroll:D,onPaneContextMenu:B,onPanZoomEnd:l,onDraggingChange:a});d.on("end",me)}const le=iI({zoomActivationKeyPressed:q,panOnDrag:M,zoomOnScroll:z,panOnScroll:D,zoomOnDoubleClick:j,zoomOnPinch:R,userSelectionActive:T,noPanClassName:P,noWheelClassName:A,lib:H,connectionInProgress:Q});d.filter(le),j?f.on("dblclick.zoom",p):f.on("dblclick.zoom",null)}function g(){d.on("zoom",null)}async function w(A,P,B){const T=Nd(A),D=d==null?void 0:d.constrain()(T,P,B);return D&&await m(D),new Promise(M=>M(D))}async function y(A,P){const B=Nd(A);return await m(B,P),new Promise(T=>T(B))}function x(A){if(f){const P=Nd(A),B=f.property("__zoom");(B.k!==A.zoom||B.x!==A.x||B.y!==A.y)&&(d==null||d.transform(f,P,null,{sync:!0}))}}function k(){const A=f?AS(f.node()):{x:0,y:0,k:1};return{x:A.x,y:A.y,zoom:A.k}}function S(A,P){return f?new Promise(B=>{d==null||d.interpolate((P==null?void 0:P.interpolate)==="linear"?Ro:Ya).scaleTo(Od(f,P==null?void 0:P.duration,P==null?void 0:P.ease,()=>B(!0)),A)}):Promise.resolve(!1)}function b(A,P){return f?new Promise(B=>{d==null||d.interpolate((P==null?void 0:P.interpolate)==="linear"?Ro:Ya).scaleBy(Od(f,P==null?void 0:P.duration,P==null?void 0:P.ease,()=>B(!0)),A)}):Promise.resolve(!1)}function E(A){d==null||d.scaleExtent(A)}function O(A){d==null||d.translateExtent(A)}function L(A){const P=!cn(A)||A<0?0:A;d==null||d.clickDistance(P)}return{update:v,destroy:g,setViewport:y,setViewportConstrained:w,getViewport:k,scaleTo:S,scaleBy:b,setScaleExtent:E,setTranslateExtent:O,syncViewport:x,setClickDistance:L}}var Ls;(function(t){t.Line="line",t.Handle="handle"})(Ls||(Ls={}));function oI({width:t,prevWidth:e,height:n,prevHeight:r,affectsX:i,affectsY:s}){const o=t-e,l=n-r,a=[o>0?1:o<0?-1:0,l>0?1:l<0?-1:0];return o&&i&&(a[0]=a[0]*-1),l&&s&&(a[1]=a[1]*-1),a}function Ny(t){const e=t.includes("right")||t.includes("left"),n=t.includes("bottom")||t.includes("top"),r=t.includes("left"),i=t.includes("top");return{isHorizontal:e,isVertical:n,affectsX:r,affectsY:i}}function nr(t,e){return Math.max(0,e-t)}function rr(t,e){return Math.max(0,t-e)}function va(t,e,n){return Math.max(0,e-t,t-n)}function Oy(t,e){return t?!e:e}function lI(t,e,n,r,i,s,o,l){let{affectsX:a,affectsY:u}=e;const{isHorizontal:c,isVertical:d}=e,f=c&&d,{xSnapped:h,ySnapped:p}=n,{minWidth:m,maxWidth:v,minHeight:g,maxHeight:w}=r,{x:y,y:x,width:k,height:S,aspectRatio:b}=t;let E=Math.floor(c?h-t.pointerX:0),O=Math.floor(d?p-t.pointerY:0);const L=k+(a?-E:E),A=S+(u?-O:O),P=-s[0]*k,B=-s[1]*S;let T=va(L,m,v),D=va(A,g,w);if(o){let C=0,N=0;a&&E<0?C=nr(y+E+P,o[0][0]):!a&&E>0&&(C=rr(y+L+P,o[1][0])),u&&O<0?N=nr(x+O+B,o[0][1]):!u&&O>0&&(N=rr(x+A+B,o[1][1])),T=Math.max(T,C),D=Math.max(D,N)}if(l){let C=0,N=0;a&&E>0?C=rr(y+E,l[0][0]):!a&&E<0&&(C=nr(y+L,l[1][0])),u&&O>0?N=rr(x+O,l[0][1]):!u&&O<0&&(N=nr(x+A,l[1][1])),T=Math.max(T,C),D=Math.max(D,N)}if(i){if(c){const C=va(L/b,g,w)*b;if(T=Math.max(T,C),o){let N=0;!a&&!u||a&&!u&&f?N=rr(x+B+L/b,o[1][1])*b:N=nr(x+B+(a?E:-E)/b,o[0][1])*b,T=Math.max(T,N)}if(l){let N=0;!a&&!u||a&&!u&&f?N=nr(x+L/b,l[1][1])*b:N=rr(x+(a?E:-E)/b,l[0][1])*b,T=Math.max(T,N)}}if(d){const C=va(A*b,m,v)/b;if(D=Math.max(D,C),o){let N=0;!a&&!u||u&&!a&&f?N=rr(y+A*b+P,o[1][0])/b:N=nr(y+(u?O:-O)*b+P,o[0][0])/b,D=Math.max(D,N)}if(l){let N=0;!a&&!u||u&&!a&&f?N=nr(y+A*b,l[1][0])/b:N=rr(y+(u?O:-O)*b,l[0][0])/b,D=Math.max(D,N)}}}O=O+(O<0?D:-D),E=E+(E<0?T:-T),i&&(f?L>A*b?O=(Oy(a,u)?-E:E)/b:E=(Oy(a,u)?-O:O)*b:c?(O=E/b,u=a):(E=O*b,a=u));const M=a?y+E:y,$=u?x+O:x;return{width:k+(a?-E:E),height:S+(u?-O:O),x:s[0]*E*(a?-1:1)+M,y:s[1]*O*(u?-1:1)+$}}const ab={width:0,height:0,x:0,y:0},aI={...ab,pointerX:0,pointerY:0,aspectRatio:1};function uI(t){return[[0,0],[t.measured.width,t.measured.height]]}function cI(t,e,n){const r=e.position.x+t.position.x,i=e.position.y+t.position.y,s=t.measured.width??0,o=t.measured.height??0,l=n[0]*s,a=n[1]*o;return[[r-l,i-a],[r+s-l,i+o-a]]}function dI({domNode:t,nodeId:e,getStoreItems:n,onChange:r,onEnd:i}){const s=At(t);let o={controlDirection:Ny("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function l({controlPosition:u,boundaries:c,keepAspectRatio:d,resizeDirection:f,onResizeStart:h,onResize:p,onResizeEnd:m,shouldResize:v}){let g={...ab},w={...aI};o={boundaries:c,resizeDirection:f,keepAspectRatio:d,controlDirection:Ny(u)};let y,x=null,k=[],S,b,E,O=!1;const L=yS().on("start",A=>{const{nodeLookup:P,transform:B,snapGrid:T,snapToGrid:D,nodeOrigin:M,paneDomNode:$}=n();if(y=P.get(e),!y)return;x=($==null?void 0:$.getBoundingClientRect())??null;const{xSnapped:C,ySnapped:N}=Po(A.sourceEvent,{transform:B,snapGrid:T,snapToGrid:D,containerBounds:x});g={width:y.measured.width??0,height:y.measured.height??0,x:y.position.x??0,y:y.position.y??0},w={...g,pointerX:C,pointerY:N,aspectRatio:g.width/g.height},S=void 0,y.parentId&&(y.extent==="parent"||y.expandParent)&&(S=P.get(y.parentId),b=S&&y.extent==="parent"?uI(S):void 0),k=[],E=void 0;for(const[R,z]of P)if(z.parentId===e&&(k.push({id:R,position:{...z.position},extent:z.extent}),z.extent==="parent"||z.expandParent)){const j=cI(z,y,z.origin??M);E?E=[[Math.min(j[0][0],E[0][0]),Math.min(j[0][1],E[0][1])],[Math.max(j[1][0],E[1][0]),Math.max(j[1][1],E[1][1])]]:E=j}h==null||h(A,{...g})}).on("drag",A=>{const{transform:P,snapGrid:B,snapToGrid:T,nodeOrigin:D}=n(),M=Po(A.sourceEvent,{transform:P,snapGrid:B,snapToGrid:T,containerBounds:x}),$=[];if(!y)return;const{x:C,y:N,width:R,height:z}=g,j={},q=y.origin??D,{width:H,height:X,x:Q,y:Z}=lI(w,o.controlDirection,M,o.boundaries,o.keepAspectRatio,q,b,E),U=H!==R,te=X!==z,ce=Q!==C&&U,le=Z!==N&&te;if(!ce&&!le&&!U&&!te)return;if((ce||le||q[0]===1||q[1]===1)&&(j.x=ce?Q:g.x,j.y=le?Z:g.y,g.x=j.x,g.y=j.y,k.length>0)){const xe=Q-C,pe=Z-N;for(const it of k)it.position={x:it.position.x-xe+q[0]*(H-R),y:it.position.y-pe+q[1]*(X-z)},$.push(it)}if((U||te)&&(j.width=U&&(!o.resizeDirection||o.resizeDirection==="horizontal")?H:g.width,j.height=te&&(!o.resizeDirection||o.resizeDirection==="vertical")?X:g.height,g.width=j.width,g.height=j.height),S&&y.expandParent){const xe=q[0]*(j.width??0);j.x&&j.x<xe&&(g.x=xe,w.x=w.x-(j.x-xe));const pe=q[1]*(j.height??0);j.y&&j.y<pe&&(g.y=pe,w.y=w.y-(j.y-pe))}const se=oI({width:g.width,prevWidth:R,height:g.height,prevHeight:z,affectsX:o.controlDirection.affectsX,affectsY:o.controlDirection.affectsY}),re={...g,direction:se};(v==null?void 0:v(A,re))!==!1&&(O=!0,p==null||p(A,re),r(j,$))}).on("end",A=>{O&&(m==null||m(A,{...g}),i==null||i({...g}),O=!1)});s.call(L)}function a(){s.on(".drag",null)}return{update:l,destroy:a}}var ub={exports:{}},cb={},db={exports:{}},fb={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var js=I;function fI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hI=typeof Object.is=="function"?Object.is:fI,pI=js.useState,mI=js.useEffect,gI=js.useLayoutEffect,yI=js.useDebugValue;function vI(t,e){var n=e(),r=pI({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return gI(function(){i.value=n,i.getSnapshot=e,Md(i)&&s({inst:i})},[t,n,e]),mI(function(){return Md(i)&&s({inst:i}),t(function(){Md(i)&&s({inst:i})})},[t]),yI(n),n}function Md(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hI(t,n)}catch{return!0}}function wI(t,e){return e()}var xI=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?wI:vI;fb.useSyncExternalStore=js.useSyncExternalStore!==void 0?js.useSyncExternalStore:xI;db.exports=fb;var SI=db.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cc=I,bI=SI;function kI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var _I=typeof Object.is=="function"?Object.is:kI,EI=bI.useSyncExternalStore,CI=Cc.useRef,TI=Cc.useEffect,NI=Cc.useMemo,OI=Cc.useDebugValue;cb.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=CI(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=NI(function(){function a(h){if(!u){if(u=!0,c=h,h=r(h),i!==void 0&&o.hasValue){var p=o.value;if(i(p,h))return d=p}return d=h}if(p=d,_I(c,h))return p;var m=r(h);return i!==void 0&&i(p,m)?(c=h,p):(c=h,d=m)}var u=!1,c,d,f=n===void 0?null:n;return[function(){return a(e())},f===null?void 0:function(){return a(f())}]},[e,n,r,i]);var l=EI(t,s[0],s[1]);return TI(function(){o.hasValue=!0,o.value=l},[l]),OI(l),l};ub.exports=cb;var MI=ub.exports;const hb=Gh(MI),AI={},My=t=>{let e;const n=new Set,r=(c,d)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const h=e;e=d??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(p=>p(e,h))}},i=()=>e,a={setState:r,getState:i,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(AI?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=e=t(r,i,a);return a},pb=t=>t?My(t):My,{useDebugValue:II}=Ve,{useSyncExternalStoreWithSelector:RI}=hb,PI=t=>t;function mb(t,e=PI,n){const r=RI(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return II(r),r}const Ay=(t,e)=>{const n=pb(t),r=(i,s=e)=>mb(n,i,s);return Object.assign(r,n),r},DI=(t,e)=>t?Ay(t,e):Ay;function _e(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}const Tc=I.createContext(null),$I=Tc.Provider,gb=En.error001();function fe(t,e){const n=I.useContext(Tc);if(n===null)throw new Error(gb);return mb(n,t,e)}function Ee(){const t=I.useContext(Tc);if(t===null)throw new Error(gb);return I.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Iy={display:"none"},LI={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},yb="react-flow__node-desc",vb="react-flow__edge-desc",jI="react-flow__aria-live",zI=t=>t.ariaLiveMessage,BI=t=>t.ariaLabelConfig;function FI({rfId:t}){const e=fe(zI);return _.jsx("div",{id:`${jI}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:LI,children:e})}function VI({rfId:t,disableKeyboardA11y:e}){const n=fe(BI);return _.jsxs(_.Fragment,{children:[_.jsx("div",{id:`${yb}-${t}`,style:Iy,children:e?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),_.jsx("div",{id:`${vb}-${t}`,style:Iy,children:n["edge.a11yDescription.default"]}),!e&&_.jsx(FI,{rfId:t})]})}const Vl=I.forwardRef(({position:t="top-left",children:e,className:n,style:r,...i},s)=>{const o=`${t}`.split("-");return _.jsx("div",{className:$e(["react-flow__panel",n,...o]),style:r,ref:s,...i,children:e})});Vl.displayName="Panel";function UI({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:_.jsx(Vl,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:_.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const HI=t=>{const e=[],n=[];for(const[,r]of t.nodeLookup)r.selected&&e.push(r.internals.userNode);for(const[,r]of t.edgeLookup)r.selected&&n.push(r);return{selectedNodes:e,selectedEdges:n}},wa=t=>t.id;function WI(t,e){return _e(t.selectedNodes.map(wa),e.selectedNodes.map(wa))&&_e(t.selectedEdges.map(wa),e.selectedEdges.map(wa))}function qI({onSelectionChange:t}){const e=Ee(),{selectedNodes:n,selectedEdges:r}=fe(HI,WI);return I.useEffect(()=>{const i={nodes:n,edges:r};t==null||t(i),e.getState().onSelectionChangeHandlers.forEach(s=>s(i))},[n,r,t]),null}const KI=t=>!!t.onSelectionChangeHandlers;function JI({onSelectionChange:t}){const e=fe(KI);return t||e?_.jsx(qI,{onSelectionChange:t}):null}const wb=[0,0],GI={x:0,y:0,zoom:1},YI=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Ry=[...YI,"rfId"],XI=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges}),Py={translateExtent:ul,nodeOrigin:wb,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function QI(t){const{setNodes:e,setEdges:n,setMinZoom:r,setMaxZoom:i,setTranslateExtent:s,setNodeExtent:o,reset:l,setDefaultNodesAndEdges:a}=fe(XI,_e),u=Ee();I.useEffect(()=>(a(t.defaultNodes,t.defaultEdges),()=>{c.current=Py,l()}),[]);const c=I.useRef(Py);return I.useEffect(()=>{for(const d of Ry){const f=t[d],h=c.current[d];f!==h&&(typeof t[d]>"u"||(d==="nodes"?e(f):d==="edges"?n(f):d==="minZoom"?r(f):d==="maxZoom"?i(f):d==="translateExtent"?s(f):d==="nodeExtent"?o(f):d==="ariaLabelConfig"?u.setState({ariaLabelConfig:_A(f)}):d==="fitView"?u.setState({fitViewQueued:f}):d==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[d]:f})))}c.current=t},Ry.map(d=>t[d])),null}function Dy(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function ZI(t){var r;const[e,n]=I.useState(t==="system"?null:t);return I.useEffect(()=>{if(t!=="system"){n(t);return}const i=Dy(),s=()=>n(i!=null&&i.matches?"dark":"light");return s(),i==null||i.addEventListener("change",s),()=>{i==null||i.removeEventListener("change",s)}},[t]),e!==null?e:(r=Dy())!=null&&r.matches?"dark":"light"}const $y=typeof document<"u"?document:null;function hl(t=null,e={target:$y,actInsideInputWithModifier:!0}){const[n,r]=I.useState(!1),i=I.useRef(!1),s=I.useRef(new Set([])),[o,l]=I.useMemo(()=>{if(t!==null){const u=(Array.isArray(t)?t:[t]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),c=u.reduce((d,f)=>d.concat(...f),[]);return[u,c]}return[[],[]]},[t]);return I.useEffect(()=>{const a=(e==null?void 0:e.target)??$y,u=(e==null?void 0:e.actInsideInputWithModifier)??!0;if(t!==null){const c=h=>{var v,g;if(i.current=h.ctrlKey||h.metaKey||h.shiftKey||h.altKey,(!i.current||i.current&&!u)&&WS(h))return!1;const m=jy(h.code,l);if(s.current.add(h[m]),Ly(o,s.current,!1)){const w=((g=(v=h.composedPath)==null?void 0:v.call(h))==null?void 0:g[0])||h.target,y=(w==null?void 0:w.nodeName)==="BUTTON"||(w==null?void 0:w.nodeName)==="A";e.preventDefault!==!1&&(i.current||!y)&&h.preventDefault(),r(!0)}},d=h=>{const p=jy(h.code,l);Ly(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(h[p]),h.key==="Meta"&&s.current.clear(),i.current=!1},f=()=>{s.current.clear(),r(!1)};return a==null||a.addEventListener("keydown",c),a==null||a.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{a==null||a.removeEventListener("keydown",c),a==null||a.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[t,r]),n}function Ly(t,e,n){return t.filter(r=>n||r.length===e.size).some(r=>r.every(i=>e.has(i)))}function jy(t,e){return e.includes(t)?"code":"key"}const eR=()=>{const t=Ee();return I.useMemo(()=>({zoomIn:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1.2,{duration:e==null?void 0:e.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:n}=t.getState();return n?n.scaleBy(1/1.2,{duration:e==null?void 0:e.duration}):Promise.resolve(!1)},zoomTo:(e,n)=>{const{panZoom:r}=t.getState();return r?r.scaleTo(e,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,n)=>{const{transform:[r,i,s],panZoom:o}=t.getState();return o?(await o.setViewport({x:e.x??r,y:e.y??i,zoom:e.zoom??s},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,n,r]=t.getState().transform;return{x:e,y:n,zoom:r}},setCenter:async(e,n,r)=>t.getState().setCenter(e,n,r),fitBounds:async(e,n)=>{const{width:r,height:i,minZoom:s,maxZoom:o,panZoom:l}=t.getState(),a=Zp(e,r,i,s,o,(n==null?void 0:n.padding)??.1);return l?(await l.setViewport(a,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(e,n={})=>{const{transform:r,snapGrid:i,snapToGrid:s,domNode:o}=t.getState();if(!o)return e;const{x:l,y:a}=o.getBoundingClientRect(),u={x:e.x-l,y:e.y-a},c=n.snapGrid??i,d=n.snapToGrid??s;return Fl(u,r,d,c)},flowToScreenPosition:e=>{const{transform:n,domNode:r}=t.getState();if(!r)return e;const{x:i,y:s}=r.getBoundingClientRect(),o=Lu(e,n);return{x:o.x+i,y:o.y+s}}}),[])};function xb(t,e){const n=[],r=new Map,i=[];for(const s of t)if(s.type==="add"){i.push(s);continue}else if(s.type==="remove"||s.type==="replace")r.set(s.id,[s]);else{const o=r.get(s.id);o?o.push(s):r.set(s.id,[s])}for(const s of e){const o=r.get(s.id);if(!o){n.push(s);continue}if(o[0].type==="remove")continue;if(o[0].type==="replace"){n.push({...o[0].item});continue}const l={...s};for(const a of o)tR(a,l);n.push(l)}return i.length&&i.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function tR(t,e){switch(t.type){case"select":{e.selected=t.selected;break}case"position":{typeof t.position<"u"&&(e.position=t.position),typeof t.dragging<"u"&&(e.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(e.measured={...t.dimensions},t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(e.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(e.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(e.resizing=t.resizing);break}}}function Sb(t,e){return xb(t,e)}function bb(t,e){return xb(t,e)}function Jr(t,e){return{id:t,type:"select",selected:e}}function us(t,e=new Set,n=!1){const r=[];for(const[i,s]of t){const o=e.has(i);!(s.selected===void 0&&!o)&&s.selected!==o&&(n&&(s.selected=o),r.push(Jr(s.id,o)))}return r}function zy({items:t=[],lookup:e}){var i;const n=[],r=new Map(t.map(s=>[s.id,s]));for(const[s,o]of t.entries()){const l=e.get(o.id),a=((i=l==null?void 0:l.internals)==null?void 0:i.userNode)??l;a!==void 0&&a!==o&&n.push({id:o.id,item:o,type:"replace"}),a===void 0&&n.push({item:o,type:"add",index:s})}for(const[s]of e)r.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function By(t){return{id:t.id,type:"remove"}}const Fy=t=>pA(t),nR=t=>LS(t);function kb(t){return I.forwardRef(t)}const rR=typeof window<"u"?I.useLayoutEffect:I.useEffect;function Vy(t){const[e,n]=I.useState(BigInt(0)),[r]=I.useState(()=>iR(()=>n(i=>i+BigInt(1))));return rR(()=>{const i=r.get();i.length&&(t(i),r.reset())},[e]),r}function iR(t){let e=[];return{get:()=>e,reset:()=>{e=[]},push:n=>{e.push(n),t()}}}const _b=I.createContext(null);function sR({children:t}){const e=Ee(),n=I.useCallback(l=>{const{nodes:a=[],setNodes:u,hasDefaultNodes:c,onNodesChange:d,nodeLookup:f,fitViewQueued:h,onNodesChangeMiddlewareMap:p}=e.getState();let m=a;for(const g of l)m=typeof g=="function"?g(m):g;let v=zy({items:m,lookup:f});for(const g of p.values())v=g(v);c&&u(m),v.length>0?d==null||d(v):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:g,nodes:w,setNodes:y}=e.getState();g&&y(w)})},[]),r=Vy(n),i=I.useCallback(l=>{const{edges:a=[],setEdges:u,hasDefaultEdges:c,onEdgesChange:d,edgeLookup:f}=e.getState();let h=a;for(const p of l)h=typeof p=="function"?p(h):p;c?u(h):d&&d(zy({items:h,lookup:f}))},[]),s=Vy(i),o=I.useMemo(()=>({nodeQueue:r,edgeQueue:s}),[]);return _.jsx(_b.Provider,{value:o,children:t})}function oR(){const t=I.useContext(_b);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const lR=t=>!!t.panZoom;function Nc(){const t=eR(),e=Ee(),n=oR(),r=fe(lR),i=I.useMemo(()=>{const s=d=>e.getState().nodeLookup.get(d),o=d=>{n.nodeQueue.push(d)},l=d=>{n.edgeQueue.push(d)},a=d=>{var g,w;const{nodeLookup:f,nodeOrigin:h}=e.getState(),p=Fy(d)?d:f.get(d.id),m=p.parentId?US(p.position,p.measured,p.parentId,f,h):p.position,v={...p,position:m,width:((g=p.measured)==null?void 0:g.width)??p.width,height:((w=p.measured)==null?void 0:w.height)??p.height};return Ds(v)},u=(d,f,h={replace:!1})=>{o(p=>p.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return h.replace&&Fy(v)?v:{...m,...v}}return m}))},c=(d,f,h={replace:!1})=>{l(p=>p.map(m=>{if(m.id===d){const v=typeof f=="function"?f(m):f;return h.replace&&nR(v)?v:{...m,...v}}return m}))};return{getNodes:()=>e.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=s(d))==null?void 0:f.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:d=[]}=e.getState();return d.map(f=>({...f}))},getEdge:d=>e.getState().edgeLookup.get(d),setNodes:o,setEdges:l,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:h}=e.getState(),[p,m,v]=h;return{nodes:d.map(g=>({...g})),edges:f.map(g=>({...g})),viewport:{x:p,y:m,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:h,edges:p,onNodesDelete:m,onEdgesDelete:v,triggerNodeChanges:g,triggerEdgeChanges:w,onDelete:y,onBeforeDelete:x}=e.getState(),{nodes:k,edges:S}=await wA({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:x}),b=S.length>0,E=k.length>0;if(b){const O=S.map(By);v==null||v(S),w(O)}if(E){const O=k.map(By);m==null||m(k),g(O)}return(E||b)&&(y==null||y({nodes:k,edges:S})),{deletedNodes:k,deletedEdges:S}},getIntersectingNodes:(d,f=!0,h)=>{const p=yy(d),m=p?d:a(d),v=h!==void 0;return m?(h||e.getState().nodes).filter(g=>{const w=e.getState().nodeLookup.get(g.id);if(w&&!p&&(g.id===d.id||!w.internals.positionAbsolute))return!1;const y=Ds(v?g:w),x=dl(y,m);return f&&x>0||x>=y.width*y.height||x>=m.width*m.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{const m=yy(d)?d:a(d);if(!m)return!1;const v=dl(m,f);return h&&v>0||v>=f.width*f.height||v>=m.width*m.height},updateNode:u,updateNodeData:(d,f,h={replace:!1})=>{u(d,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},updateEdge:c,updateEdgeData:(d,f,h={replace:!1})=>{c(d,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:h}=e.getState();return mA(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>{var p;return Array.from(((p=e.getState().connectionLookup.get(`${h}-${d}${f?`-${f}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:d,handleId:f,nodeId:h})=>{var p;return Array.from(((p=e.getState().connectionLookup.get(`${h}${d?f?`-${d}-${f}`:`-${d}`:""}`))==null?void 0:p.values())??[])},fitView:async d=>{const f=e.getState().fitViewResolver??kA();return e.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:f}),n.nodeQueue.push(h=>[...h]),f.promise}}},[]);return I.useMemo(()=>({...i,...t,viewportInitialized:r}),[r])}const Uy=t=>t.selected,aR=typeof window<"u"?window:void 0;function uR({deleteKeyCode:t,multiSelectionKeyCode:e}){const n=Ee(),{deleteElements:r}=Nc(),i=hl(t,{actInsideInputWithModifier:!1}),s=hl(e,{target:aR});I.useEffect(()=>{if(i){const{edges:o,nodes:l}=n.getState();r({nodes:l.filter(Uy),edges:o.filter(Uy)}),n.setState({nodesSelectionActive:!1})}},[i]),I.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function cR(t){const e=Ee();I.useEffect(()=>{const n=()=>{var i,s,o,l;if(!t.current||!(((s=(i=t.current).checkVisibility)==null?void 0:s.call(i))??!0))return!1;const r=em(t.current);(r.height===0||r.width===0)&&((l=(o=e.getState()).onError)==null||l.call(o,"004",En.error004())),e.setState({width:r.width||500,height:r.height||500})};if(t.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(t.current),()=>{window.removeEventListener("resize",n),r&&t.current&&r.unobserve(t.current)}}},[])}const Oc={position:"absolute",width:"100%",height:"100%",top:0,left:0},dR=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function fR({onPaneContextMenu:t,zoomOnScroll:e=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:i=.5,panOnScrollMode:s=di.Free,zoomOnDoubleClick:o=!0,panOnDrag:l=!0,defaultViewport:a,translateExtent:u,minZoom:c,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:m,noPanClassName:v,onViewportChange:g,isControlledViewport:w,paneClickDistance:y,selectionOnDrag:x}){const k=Ee(),S=I.useRef(null),{userSelectionActive:b,lib:E,connectionInProgress:O}=fe(dR,_e),L=hl(f),A=I.useRef();cR(S);const P=I.useCallback(B=>{g==null||g({x:B[0],y:B[1],zoom:B[2]}),w||k.setState({transform:B})},[g,w]);return I.useEffect(()=>{if(S.current){A.current=sI({domNode:S.current,minZoom:c,maxZoom:d,translateExtent:u,viewport:a,onDraggingChange:M=>k.setState({paneDragging:M}),onPanZoomStart:(M,$)=>{const{onViewportChangeStart:C,onMoveStart:N}=k.getState();N==null||N(M,$),C==null||C($)},onPanZoom:(M,$)=>{const{onViewportChange:C,onMove:N}=k.getState();N==null||N(M,$),C==null||C($)},onPanZoomEnd:(M,$)=>{const{onViewportChangeEnd:C,onMoveEnd:N}=k.getState();N==null||N(M,$),C==null||C($)}});const{x:B,y:T,zoom:D}=A.current.getViewport();return k.setState({panZoom:A.current,transform:[B,T,D],domNode:S.current.closest(".react-flow")}),()=>{var M;(M=A.current)==null||M.destroy()}}},[]),I.useEffect(()=>{var B;(B=A.current)==null||B.update({onPaneContextMenu:t,zoomOnScroll:e,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:i,panOnScrollMode:s,zoomOnDoubleClick:o,panOnDrag:l,zoomActivationKeyPressed:L,preventScrolling:h,noPanClassName:v,userSelectionActive:b,noWheelClassName:m,lib:E,onTransformChange:P,connectionInProgress:O,selectionOnDrag:x,paneClickDistance:y})},[t,e,n,r,i,s,o,l,L,h,v,b,m,E,P,O,x,y]),_.jsx("div",{className:"react-flow__renderer",ref:S,style:Oc,children:p})}const hR=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function pR(){const{userSelectionActive:t,userSelectionRect:e}=fe(hR,_e);return t&&e?_.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}const Ad=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},mR=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function gR({isSelecting:t,selectionKeyPressed:e,selectionMode:n=cl.Full,panOnDrag:r,paneClickDistance:i,selectionOnDrag:s,onSelectionStart:o,onSelectionEnd:l,onPaneClick:a,onPaneContextMenu:u,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:h,children:p}){const m=Ee(),{userSelectionActive:v,elementsSelectable:g,dragging:w,connectionInProgress:y}=fe(mR,_e),x=g&&(t||v),k=I.useRef(null),S=I.useRef(),b=I.useRef(new Set),E=I.useRef(new Set),O=I.useRef(!1),L=C=>{if(O.current||y){O.current=!1;return}a==null||a(C),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},A=C=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){C.preventDefault();return}u==null||u(C)},P=c?C=>c(C):void 0,B=C=>{O.current&&(C.stopPropagation(),O.current=!1)},T=C=>{var X,Q;const{domNode:N}=m.getState();if(S.current=N==null?void 0:N.getBoundingClientRect(),!S.current)return;const R=C.target===k.current;if(!R&&!!C.target.closest(".nokey")||!t||!(s&&R||e)||C.button!==0||!C.isPrimary)return;(Q=(X=C.target)==null?void 0:X.setPointerCapture)==null||Q.call(X,C.pointerId),O.current=!1;const{x:q,y:H}=dn(C.nativeEvent,S.current);m.setState({userSelectionRect:{width:0,height:0,startX:q,startY:H,x:q,y:H}}),R||(C.stopPropagation(),C.preventDefault())},D=C=>{const{userSelectionRect:N,transform:R,nodeLookup:z,edgeLookup:j,connectionLookup:q,triggerNodeChanges:H,triggerEdgeChanges:X,defaultEdgeOptions:Q,resetSelectedElements:Z}=m.getState();if(!S.current||!N)return;const{x:U,y:te}=dn(C.nativeEvent,S.current),{startX:ce,startY:le}=N;if(!O.current){const pe=e?0:i;if(Math.hypot(U-ce,te-le)<=pe)return;Z(),o==null||o(C)}O.current=!0;const se={startX:ce,startY:le,x:U<ce?U:ce,y:te<le?te:le,width:Math.abs(U-ce),height:Math.abs(te-le)},re=b.current,me=E.current;b.current=new Set(Qp(z,se,R,n===cl.Partial,!0).map(pe=>pe.id)),E.current=new Set;const xe=(Q==null?void 0:Q.selectable)??!0;for(const pe of b.current){const it=q.get(pe);if(it)for(const{edgeId:er}of it.values()){const Mn=j.get(er);Mn&&(Mn.selectable??xe)&&E.current.add(er)}}if(!vy(re,b.current)){const pe=us(z,b.current,!0);H(pe)}if(!vy(me,E.current)){const pe=us(j,E.current);X(pe)}m.setState({userSelectionRect:se,userSelectionActive:!0,nodesSelectionActive:!1})},M=C=>{var N,R;C.button===0&&((R=(N=C.target)==null?void 0:N.releasePointerCapture)==null||R.call(N,C.pointerId),!v&&C.target===k.current&&m.getState().userSelectionRect&&(L==null||L(C)),m.setState({userSelectionActive:!1,userSelectionRect:null}),O.current&&(l==null||l(C),m.setState({nodesSelectionActive:b.current.size>0})))},$=r===!0||Array.isArray(r)&&r.includes(0);return _.jsxs("div",{className:$e(["react-flow__pane",{draggable:$,dragging:w,selection:t}]),onClick:x?void 0:Ad(L,k),onContextMenu:Ad(A,k),onWheel:Ad(P,k),onPointerEnter:x?void 0:d,onPointerMove:x?D:f,onPointerUp:x?M:void 0,onPointerDownCapture:x?T:void 0,onClickCapture:x?B:void 0,onPointerLeave:h,ref:k,style:Oc,children:[p,_.jsx(pR,{})]})}function gh({id:t,store:e,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeLookup:l,onError:a}=e.getState(),u=l.get(t);if(!u){a==null||a("012",En.error012(t));return}e.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&o)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var c;return(c=r==null?void 0:r.current)==null?void 0:c.blur()})):i([t])}function Eb({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,nodeClickDistance:o}){const l=Ee(),[a,u]=I.useState(!1),c=I.useRef();return I.useEffect(()=>{c.current=WA({getStoreItems:()=>l.getState(),onNodeMouseDown:d=>{gh({id:d,store:l,nodeRef:t})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),I.useEffect(()=>{var d,f;if(e)(d=c.current)==null||d.destroy();else if(t.current)return(f=c.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:t.current,isSelectable:s,nodeId:i,nodeClickDistance:o}),()=>{var h;(h=c.current)==null||h.destroy()}},[n,r,e,s,t,i]),a}const yR=t=>e=>e.selected&&(e.draggable||t&&typeof e.draggable>"u");function Cb(){const t=Ee();return I.useCallback(n=>{const{nodeExtent:r,snapToGrid:i,snapGrid:s,nodesDraggable:o,onError:l,updateNodePositions:a,nodeLookup:u,nodeOrigin:c}=t.getState(),d=new Map,f=yR(o),h=i?s[0]:5,p=i?s[1]:5,m=n.direction.x*h*n.factor,v=n.direction.y*p*n.factor;for(const[,g]of u){if(!f(g))continue;let w={x:g.internals.positionAbsolute.x+m,y:g.internals.positionAbsolute.y+v};i&&(w=Bl(w,s));const{position:y,positionAbsolute:x}=jS({nodeId:g.id,nextPosition:w,nodeLookup:u,nodeExtent:r,nodeOrigin:c,onError:l});g.position=y,g.internals.positionAbsolute=x,d.set(g.id,g)}a(d)},[])}const om=I.createContext(null),vR=om.Provider;om.Consumer;const Tb=()=>I.useContext(om),wR=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),xR=(t,e,n)=>r=>{const{connectionClickStartHandle:i,connectionMode:s,connection:o}=r,{fromHandle:l,toHandle:a,isValid:u}=o,c=(a==null?void 0:a.nodeId)===t&&(a==null?void 0:a.id)===e&&(a==null?void 0:a.type)===n;return{connectingFrom:(l==null?void 0:l.nodeId)===t&&(l==null?void 0:l.id)===e&&(l==null?void 0:l.type)===n,connectingTo:c,clickConnecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.id)===e&&(i==null?void 0:i.type)===n,isPossibleEndHandle:s===Rs.Strict?(l==null?void 0:l.type)!==n:t!==(l==null?void 0:l.nodeId)||e!==(l==null?void 0:l.id),connectionInProcess:!!l,clickConnectionInProcess:!!i,valid:c&&u}};function SR({type:t="source",position:e=Y.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:l,children:a,className:u,onMouseDown:c,onTouchStart:d,...f},h){var D,M;const p=o||null,m=t==="target",v=Ee(),g=Tb(),{connectOnClick:w,noPanClassName:y,rfId:x}=fe(wR,_e),{connectingFrom:k,connectingTo:S,clickConnecting:b,isPossibleEndHandle:E,connectionInProcess:O,clickConnectionInProcess:L,valid:A}=fe(xR(g,p,t),_e);g||(M=(D=v.getState()).onError)==null||M.call(D,"010",En.error010());const P=$=>{const{defaultEdgeOptions:C,onConnect:N,hasDefaultEdges:R}=v.getState(),z={...C,...$};if(R){const{edges:j,setEdges:q}=v.getState();q(YS(z,j))}N==null||N(z),l==null||l(z)},B=$=>{if(!g)return;const C=qS($.nativeEvent);if(i&&(C&&$.button===0||!C)){const N=v.getState();mh.onPointerDown($.nativeEvent,{handleDomNode:$.currentTarget,autoPanOnConnect:N.autoPanOnConnect,connectionMode:N.connectionMode,connectionRadius:N.connectionRadius,domNode:N.domNode,nodeLookup:N.nodeLookup,lib:N.lib,isTarget:m,handleId:p,nodeId:g,flowId:N.rfId,panBy:N.panBy,cancelConnection:N.cancelConnection,onConnectStart:N.onConnectStart,onConnectEnd:N.onConnectEnd,updateConnection:N.updateConnection,onConnect:P,isValidConnection:n||N.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:N.autoPanSpeed,dragThreshold:N.connectionDragThreshold})}C?c==null||c($):d==null||d($)},T=$=>{const{onClickConnectStart:C,onClickConnectEnd:N,connectionClickStartHandle:R,connectionMode:z,isValidConnection:j,lib:q,rfId:H,nodeLookup:X,connection:Q}=v.getState();if(!g||!R&&!i)return;if(!R){C==null||C($.nativeEvent,{nodeId:g,handleId:p,handleType:t}),v.setState({connectionClickStartHandle:{nodeId:g,type:t,id:p}});return}const Z=HS($.target),U=n||j,{connection:te,isValid:ce}=mh.isValid($.nativeEvent,{handle:{nodeId:g,id:p,type:t},connectionMode:z,fromNodeId:R.nodeId,fromHandleId:R.id||null,fromType:R.type,isValidConnection:U,flowId:H,doc:Z,lib:q,nodeLookup:X});ce&&te&&P(te);const le=structuredClone(Q);delete le.inProgress,le.toPosition=le.toHandle?le.toHandle.position:null,N==null||N($,le),v.setState({connectionClickStartHandle:null})};return _.jsx("div",{"data-handleid":p,"data-nodeid":g,"data-handlepos":e,"data-id":`${x}-${g}-${p}-${t}`,className:$e(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",y,u,{source:!m,target:m,connectable:r,connectablestart:i,connectableend:s,clickconnecting:b,connectingfrom:k,connectingto:S,valid:A,connectionindicator:r&&(!O||E)&&(O||L?s:i)}]),onMouseDown:B,onTouchStart:B,onClick:w?T:void 0,ref:h,...f,children:a})}const yr=I.memo(kb(SR));function bR({data:t,isConnectable:e,sourcePosition:n=Y.Bottom}){return _.jsxs(_.Fragment,{children:[t==null?void 0:t.label,_.jsx(yr,{type:"source",position:n,isConnectable:e})]})}function kR({data:t,isConnectable:e,targetPosition:n=Y.Top,sourcePosition:r=Y.Bottom}){return _.jsxs(_.Fragment,{children:[_.jsx(yr,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,_.jsx(yr,{type:"source",position:r,isConnectable:e})]})}function _R(){return null}function ER({data:t,isConnectable:e,targetPosition:n=Y.Top}){return _.jsxs(_.Fragment,{children:[_.jsx(yr,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label]})}const ju={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Hy={input:bR,default:kR,output:ER,group:_R};function CR(t){var e,n,r,i;return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??((e=t.style)==null?void 0:e.width),height:t.height??t.initialHeight??((n=t.style)==null?void 0:n.height)}:{width:t.width??((r=t.style)==null?void 0:r.width),height:t.height??((i=t.style)==null?void 0:i.height)}}const TR=t=>{const{width:e,height:n,x:r,y:i}=zl(t.nodeLookup,{filter:s=>!!s.selected});return{width:cn(e)?e:null,height:cn(n)?n:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${r}px,${i}px)`}};function NR({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const r=Ee(),{width:i,height:s,transformString:o,userSelectionActive:l}=fe(TR,_e),a=Cb(),u=I.useRef(null);if(I.useEffect(()=>{var f;n||(f=u.current)==null||f.focus({preventScroll:!0})},[n]),Eb({nodeRef:u}),l||!i||!s)return null;const c=t?f=>{const h=r.getState().nodes.filter(p=>p.selected);t(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(ju,f.key)&&(f.preventDefault(),a({direction:ju[f.key],factor:f.shiftKey?4:1}))};return _.jsx("div",{className:$e(["react-flow__nodesselection","react-flow__container",e]),style:{transform:o},children:_.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:c,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:i,height:s}})})}const Wy=typeof window<"u"?window:void 0,OR=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function Nb({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,paneClickDistance:l,deleteKeyCode:a,selectionKeyCode:u,selectionOnDrag:c,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:m,zoomActivationKeyCode:v,elementsSelectable:g,zoomOnScroll:w,zoomOnPinch:y,panOnScroll:x,panOnScrollSpeed:k,panOnScrollMode:S,zoomOnDoubleClick:b,panOnDrag:E,defaultViewport:O,translateExtent:L,minZoom:A,maxZoom:P,preventScrolling:B,onSelectionContextMenu:T,noWheelClassName:D,noPanClassName:M,disableKeyboardA11y:$,onViewportChange:C,isControlledViewport:N}){const{nodesSelectionActive:R,userSelectionActive:z}=fe(OR,_e),j=hl(u,{target:Wy}),q=hl(m,{target:Wy}),H=q||E,X=q||x,Q=c&&H!==!0,Z=j||z||Q;return uR({deleteKeyCode:a,multiSelectionKeyCode:p}),_.jsx(fR,{onPaneContextMenu:s,elementsSelectable:g,zoomOnScroll:w,zoomOnPinch:y,panOnScroll:X,panOnScrollSpeed:k,panOnScrollMode:S,zoomOnDoubleClick:b,panOnDrag:!j&&H,defaultViewport:O,translateExtent:L,minZoom:A,maxZoom:P,zoomActivationKeyCode:v,preventScrolling:B,noWheelClassName:D,noPanClassName:M,onViewportChange:C,isControlledViewport:N,paneClickDistance:l,selectionOnDrag:Q,children:_.jsxs(gR,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:H,isSelecting:!!Z,selectionMode:d,selectionKeyPressed:j,paneClickDistance:l,selectionOnDrag:Q,children:[t,R&&_.jsx(NR,{onSelectionContextMenu:T,noPanClassName:M,disableKeyboardA11y:$})]})})}Nb.displayName="FlowRenderer";const MR=I.memo(Nb),AR=t=>e=>t?Qp(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(n=>n.id):Array.from(e.nodeLookup.keys());function IR(t){return fe(I.useCallback(AR(t),[t]),_e)}const RR=t=>t.updateNodeInternals;function PR(){const t=fe(RR),[e]=I.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(i=>{const s=i.target.getAttribute("data-id");r.set(s,{id:s,nodeElement:i.target,force:!0})}),t(r)}));return I.useEffect(()=>()=>{e==null||e.disconnect()},[e]),e}function DR({node:t,nodeType:e,hasDimensions:n,resizeObserver:r}){const i=Ee(),s=I.useRef(null),o=I.useRef(null),l=I.useRef(t.sourcePosition),a=I.useRef(t.targetPosition),u=I.useRef(e),c=n&&!!t.internals.handleBounds;return I.useEffect(()=>{s.current&&!t.hidden&&(!c||o.current!==s.current)&&(o.current&&(r==null||r.unobserve(o.current)),r==null||r.observe(s.current),o.current=s.current)},[c,t.hidden]),I.useEffect(()=>()=>{o.current&&(r==null||r.unobserve(o.current),o.current=null)},[]),I.useEffect(()=>{if(s.current){const d=u.current!==e,f=l.current!==t.sourcePosition,h=a.current!==t.targetPosition;(d||f||h)&&(u.current=e,l.current=t.sourcePosition,a.current=t.targetPosition,i.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:s.current,force:!0}]])))}},[t.id,e,t.sourcePosition,t.targetPosition]),s}function $R({id:t,onClick:e,onMouseEnter:n,onMouseMove:r,onMouseLeave:i,onContextMenu:s,onDoubleClick:o,nodesDraggable:l,elementsSelectable:a,nodesConnectable:u,nodesFocusable:c,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:m,nodeTypes:v,nodeClickDistance:g,onError:w}){const{node:y,internals:x,isParent:k}=fe(U=>{const te=U.nodeLookup.get(t),ce=U.parentLookup.has(t);return{node:te,internals:te.internals,isParent:ce}},_e);let S=y.type||"default",b=(v==null?void 0:v[S])||Hy[S];b===void 0&&(w==null||w("003",En.error003(S)),S="default",b=(v==null?void 0:v.default)||Hy.default);const E=!!(y.draggable||l&&typeof y.draggable>"u"),O=!!(y.selectable||a&&typeof y.selectable>"u"),L=!!(y.connectable||u&&typeof y.connectable>"u"),A=!!(y.focusable||c&&typeof y.focusable>"u"),P=Ee(),B=VS(y),T=DR({node:y,nodeType:S,hasDimensions:B,resizeObserver:d}),D=Eb({nodeRef:T,disabled:y.hidden||!E,noDragClassName:f,handleSelector:y.dragHandle,nodeId:t,isSelectable:O,nodeClickDistance:g}),M=Cb();if(y.hidden)return null;const $=Qn(y),C=CR(y),N=O||E||e||n||r||i,R=n?U=>n(U,{...x.userNode}):void 0,z=r?U=>r(U,{...x.userNode}):void 0,j=i?U=>i(U,{...x.userNode}):void 0,q=s?U=>s(U,{...x.userNode}):void 0,H=o?U=>o(U,{...x.userNode}):void 0,X=U=>{const{selectNodesOnDrag:te,nodeDragThreshold:ce}=P.getState();O&&(!te||!E||ce>0)&&gh({id:t,store:P,nodeRef:T}),e&&e(U,{...x.userNode})},Q=U=>{if(!(WS(U.nativeEvent)||p)){if(RS.includes(U.key)&&O){const te=U.key==="Escape";gh({id:t,store:P,unselect:te,nodeRef:T})}else if(E&&y.selected&&Object.prototype.hasOwnProperty.call(ju,U.key)){U.preventDefault();const{ariaLabelConfig:te}=P.getState();P.setState({ariaLiveMessage:te["node.a11yDescription.ariaLiveMessage"]({direction:U.key.replace("Arrow","").toLowerCase(),x:~~x.positionAbsolute.x,y:~~x.positionAbsolute.y})}),M({direction:ju[U.key],factor:U.shiftKey?4:1})}}},Z=()=>{var me;if(p||!((me=T.current)!=null&&me.matches(":focus-visible")))return;const{transform:U,width:te,height:ce,autoPanOnNodeFocus:le,setCenter:se}=P.getState();if(!le)return;Qp(new Map([[t,y]]),{x:0,y:0,width:te,height:ce},U,!0).length>0||se(y.position.x+$.width/2,y.position.y+$.height/2,{zoom:U[2]})};return _.jsx("div",{className:$e(["react-flow__node",`react-flow__node-${S}`,{[h]:E},y.className,{selected:y.selected,selectable:O,parent:k,draggable:E,dragging:D}]),ref:T,style:{zIndex:x.z,transform:`translate(${x.positionAbsolute.x}px,${x.positionAbsolute.y}px)`,pointerEvents:N?"all":"none",visibility:B?"visible":"hidden",...y.style,...C},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:R,onMouseMove:z,onMouseLeave:j,onContextMenu:q,onClick:X,onDoubleClick:H,onKeyDown:A?Q:void 0,tabIndex:A?0:void 0,onFocus:A?Z:void 0,role:y.ariaRole??(A?"group":void 0),"aria-roledescription":"node","aria-describedby":p?void 0:`${yb}-${m}`,"aria-label":y.ariaLabel,...y.domAttributes,children:_.jsx(vR,{value:t,children:_.jsx(b,{id:t,data:y.data,type:S,positionAbsoluteX:x.positionAbsolute.x,positionAbsoluteY:x.positionAbsolute.y,selected:y.selected??!1,selectable:O,draggable:E,deletable:y.deletable??!0,isConnectable:L,sourcePosition:y.sourcePosition,targetPosition:y.targetPosition,dragging:D,dragHandle:y.dragHandle,zIndex:x.z,parentId:y.parentId,...$})})})}var LR=I.memo($R);const jR=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function Ob(t){const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,onError:s}=fe(jR,_e),o=IR(t.onlyRenderVisibleElements),l=PR();return _.jsx("div",{className:"react-flow__nodes",style:Oc,children:o.map(a=>_.jsx(LR,{id:a,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:l,nodesDraggable:e,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,nodeClickDistance:t.nodeClickDistance,onError:s},a))})}Ob.displayName="NodeRenderer";const zR=I.memo(Ob);function BR(t){return fe(I.useCallback(n=>{if(!t)return n.edges.map(i=>i.id);const r=[];if(n.width&&n.height)for(const i of n.edges){const s=n.nodeLookup.get(i.source),o=n.nodeLookup.get(i.target);s&&o&&TA({sourceNode:s,targetNode:o,width:n.width,height:n.height,transform:n.transform})&&r.push(i.id)}return r},[t]),_e)}const FR=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t}};return _.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},VR=({color:t="none",strokeWidth:e=1})=>{const n={strokeWidth:e,...t&&{stroke:t,fill:t}};return _.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},qy={[Du.Arrow]:FR,[Du.ArrowClosed]:VR};function UR(t){const e=Ee();return I.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(qy,t)?qy[t]:((s=(i=e.getState()).onError)==null||s.call(i,"009",En.error009(t)),null)},[t])}const HR=({id:t,type:e,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const a=UR(e);return a?_.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0",children:_.jsx(a,{color:n,strokeWidth:o})}):null},Mb=({defaultColor:t,rfId:e})=>{const n=fe(s=>s.edges),r=fe(s=>s.defaultEdgeOptions),i=I.useMemo(()=>PA(n,{id:e,defaultColor:t,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,e,t]);return i.length?_.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:_.jsx("defs",{children:i.map(s=>_.jsx(HR,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Mb.displayName="MarkerDefinitions";var WR=I.memo(Mb);function Ab({x:t,y:e,label:n,labelStyle:r,labelShowBg:i=!0,labelBgStyle:s,labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:a,className:u,...c}){const[d,f]=I.useState({x:1,y:0,width:0,height:0}),h=$e(["react-flow__edge-textwrapper",u]),p=I.useRef(null);return I.useEffect(()=>{if(p.current){const m=p.current.getBBox();f({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n?_.jsxs("g",{transform:`translate(${t-d.width/2} ${e-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...c,children:[i&&_.jsx("rect",{width:d.width+2*o[0],x:-o[0],y:-o[1],height:d.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),_.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:p,style:r,children:n}),a]}):null}Ab.displayName="EdgeText";const qR=I.memo(Ab);function Mc({path:t,labelX:e,labelY:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:l,labelBgBorderRadius:a,interactionWidth:u=20,...c}){return _.jsxs(_.Fragment,{children:[_.jsx("path",{...c,d:t,fill:"none",className:$e(["react-flow__edge-path",c.className])}),u?_.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,r&&cn(e)&&cn(n)?_.jsx(qR,{x:e,y:n,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:o,labelBgPadding:l,labelBgBorderRadius:a}):null]})}function Ky({pos:t,x1:e,y1:n,x2:r,y2:i}){return t===Y.Left||t===Y.Right?[.5*(e+r),n]:[e,.5*(n+i)]}function Ib({sourceX:t,sourceY:e,sourcePosition:n=Y.Bottom,targetX:r,targetY:i,targetPosition:s=Y.Top}){const[o,l]=Ky({pos:n,x1:t,y1:e,x2:r,y2:i}),[a,u]=Ky({pos:s,x1:r,y1:i,x2:t,y2:e}),[c,d,f,h]=KS({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:o,sourceControlY:l,targetControlX:a,targetControlY:u});return[`M${t},${e} C${o},${l} ${a},${u} ${r},${i}`,c,d,f,h]}function Rb(t){return I.memo(({id:e,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o,targetPosition:l,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:v,interactionWidth:g})=>{const[w,y,x]=Ib({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:l}),k=t.isInternal?void 0:e;return _.jsx(Mc,{id:k,path:w,labelX:y,labelY:x,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:v,interactionWidth:g})})}const KR=Rb({isInternal:!1}),Pb=Rb({isInternal:!0});KR.displayName="SimpleBezierEdge";Pb.displayName="SimpleBezierEdgeInternal";function Db(t){return I.memo(({id:e,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:l,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,sourcePosition:h=Y.Bottom,targetPosition:p=Y.Top,markerEnd:m,markerStart:v,pathOptions:g,interactionWidth:w})=>{const[y,x,k]=fh({sourceX:n,sourceY:r,sourcePosition:h,targetX:i,targetY:s,targetPosition:p,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset,stepPosition:g==null?void 0:g.stepPosition}),S=t.isInternal?void 0:e;return _.jsx(Mc,{id:S,path:y,labelX:x,labelY:k,label:o,labelStyle:l,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,markerEnd:m,markerStart:v,interactionWidth:w})})}const $b=Db({isInternal:!1}),Lb=Db({isInternal:!0});$b.displayName="SmoothStepEdge";Lb.displayName="SmoothStepEdgeInternal";function jb(t){return I.memo(({id:e,...n})=>{var i;const r=t.isInternal?void 0:e;return _.jsx($b,{...n,id:r,pathOptions:I.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(i=n.pathOptions)==null?void 0:i.offset])})})}const JR=jb({isInternal:!1}),zb=jb({isInternal:!0});JR.displayName="StepEdge";zb.displayName="StepEdgeInternal";function Bb(t){return I.memo(({id:e,sourceX:n,sourceY:r,targetX:i,targetY:s,label:o,labelStyle:l,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:m})=>{const[v,g,w]=XS({sourceX:n,sourceY:r,targetX:i,targetY:s}),y=t.isInternal?void 0:e;return _.jsx(Mc,{id:y,path:v,labelX:g,labelY:w,label:o,labelStyle:l,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:m})})}const GR=Bb({isInternal:!1}),Fb=Bb({isInternal:!0});GR.displayName="StraightEdge";Fb.displayName="StraightEdgeInternal";function Vb(t){return I.memo(({id:e,sourceX:n,sourceY:r,targetX:i,targetY:s,sourcePosition:o=Y.Bottom,targetPosition:l=Y.Top,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:v,pathOptions:g,interactionWidth:w})=>{const[y,x,k]=JS({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:s,targetPosition:l,curvature:g==null?void 0:g.curvature}),S=t.isInternal?void 0:e;return _.jsx(Mc,{id:S,path:y,labelX:x,labelY:k,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:v,interactionWidth:w})})}const YR=Vb({isInternal:!1}),Ub=Vb({isInternal:!0});YR.displayName="BezierEdge";Ub.displayName="BezierEdgeInternal";const Jy={default:Ub,straight:Fb,step:zb,smoothstep:Lb,simplebezier:Pb},Gy={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},XR=(t,e,n)=>n===Y.Left?t-e:n===Y.Right?t+e:t,QR=(t,e,n)=>n===Y.Top?t-e:n===Y.Bottom?t+e:t,Yy="react-flow__edgeupdater";function Xy({position:t,centerX:e,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:l}){return _.jsx("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:$e([Yy,`${Yy}-${l}`]),cx:XR(e,r,t),cy:QR(n,r,t),r,stroke:"transparent",fill:"transparent"})}function ZR({isReconnectable:t,reconnectRadius:e,edge:n,sourceX:r,sourceY:i,targetX:s,targetY:o,sourcePosition:l,targetPosition:a,onReconnect:u,onReconnectStart:c,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){const p=Ee(),m=(x,k)=>{if(x.button!==0)return;const{autoPanOnConnect:S,domNode:b,isValidConnection:E,connectionMode:O,connectionRadius:L,lib:A,onConnectStart:P,onConnectEnd:B,cancelConnection:T,nodeLookup:D,rfId:M,panBy:$,updateConnection:C}=p.getState(),N=k.type==="target",R=(q,H)=>{f(!1),d==null||d(q,n,k.type,H)},z=q=>u==null?void 0:u(n,q),j=(q,H)=>{f(!0),c==null||c(x,n,k.type),P==null||P(q,H)};mh.onPointerDown(x.nativeEvent,{autoPanOnConnect:S,connectionMode:O,connectionRadius:L,domNode:b,handleId:k.id,nodeId:k.nodeId,nodeLookup:D,isTarget:N,edgeUpdaterType:k.type,lib:A,flowId:M,cancelConnection:T,panBy:$,isValidConnection:E,onConnect:z,onConnectStart:j,onConnectEnd:B,onReconnectEnd:R,updateConnection:C,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle,dragThreshold:p.getState().connectionDragThreshold,handleDomNode:x.currentTarget})},v=x=>m(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),g=x=>m(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>h(!0),y=()=>h(!1);return _.jsxs(_.Fragment,{children:[(t===!0||t==="source")&&_.jsx(Xy,{position:l,centerX:r,centerY:i,radius:e,onMouseDown:v,onMouseEnter:w,onMouseOut:y,type:"source"}),(t===!0||t==="target")&&_.jsx(Xy,{position:a,centerX:s,centerY:o,radius:e,onMouseDown:g,onMouseEnter:w,onMouseOut:y,type:"target"})]})}function eP({id:t,edgesFocusable:e,edgesReconnectable:n,elementsSelectable:r,onClick:i,onDoubleClick:s,onContextMenu:o,onMouseEnter:l,onMouseMove:a,onMouseLeave:u,reconnectRadius:c,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:m,noPanClassName:v,onError:g,disableKeyboardA11y:w}){let y=fe(se=>se.edgeLookup.get(t));const x=fe(se=>se.defaultEdgeOptions);y=x?{...x,...y}:y;let k=y.type||"default",S=(m==null?void 0:m[k])||Jy[k];S===void 0&&(g==null||g("011",En.error011(k)),k="default",S=(m==null?void 0:m.default)||Jy.default);const b=!!(y.focusable||e&&typeof y.focusable>"u"),E=typeof d<"u"&&(y.reconnectable||n&&typeof y.reconnectable>"u"),O=!!(y.selectable||r&&typeof y.selectable>"u"),L=I.useRef(null),[A,P]=I.useState(!1),[B,T]=I.useState(!1),D=Ee(),{zIndex:M,sourceX:$,sourceY:C,targetX:N,targetY:R,sourcePosition:z,targetPosition:j}=fe(I.useCallback(se=>{const re=se.nodeLookup.get(y.source),me=se.nodeLookup.get(y.target);if(!re||!me)return{zIndex:y.zIndex,...Gy};const xe=RA({id:t,sourceNode:re,targetNode:me,sourceHandle:y.sourceHandle||null,targetHandle:y.targetHandle||null,connectionMode:se.connectionMode,onError:g});return{zIndex:CA({selected:y.selected,zIndex:y.zIndex,sourceNode:re,targetNode:me,elevateOnSelect:se.elevateEdgesOnSelect,zIndexMode:se.zIndexMode}),...xe||Gy}},[y.source,y.target,y.sourceHandle,y.targetHandle,y.selected,y.zIndex]),_e),q=I.useMemo(()=>y.markerStart?`url('#${hh(y.markerStart,p)}')`:void 0,[y.markerStart,p]),H=I.useMemo(()=>y.markerEnd?`url('#${hh(y.markerEnd,p)}')`:void 0,[y.markerEnd,p]);if(y.hidden||$===null||C===null||N===null||R===null)return null;const X=se=>{var pe;const{addSelectedEdges:re,unselectNodesAndEdges:me,multiSelectionActive:xe}=D.getState();O&&(D.setState({nodesSelectionActive:!1}),y.selected&&xe?(me({nodes:[],edges:[y]}),(pe=L.current)==null||pe.blur()):re([t])),i&&i(se,y)},Q=s?se=>{s(se,{...y})}:void 0,Z=o?se=>{o(se,{...y})}:void 0,U=l?se=>{l(se,{...y})}:void 0,te=a?se=>{a(se,{...y})}:void 0,ce=u?se=>{u(se,{...y})}:void 0,le=se=>{var re;if(!w&&RS.includes(se.key)&&O){const{unselectNodesAndEdges:me,addSelectedEdges:xe}=D.getState();se.key==="Escape"?((re=L.current)==null||re.blur(),me({edges:[y]})):xe([t])}};return _.jsx("svg",{style:{zIndex:M},children:_.jsxs("g",{className:$e(["react-flow__edge",`react-flow__edge-${k}`,y.className,v,{selected:y.selected,animated:y.animated,inactive:!O&&!i,updating:A,selectable:O}]),onClick:X,onDoubleClick:Q,onContextMenu:Z,onMouseEnter:U,onMouseMove:te,onMouseLeave:ce,onKeyDown:b?le:void 0,tabIndex:b?0:void 0,role:y.ariaRole??(b?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":y.ariaLabel===null?void 0:y.ariaLabel||`Edge from ${y.source} to ${y.target}`,"aria-describedby":b?`${vb}-${p}`:void 0,ref:L,...y.domAttributes,children:[!B&&_.jsx(S,{id:t,source:y.source,target:y.target,type:y.type,selected:y.selected,animated:y.animated,selectable:O,deletable:y.deletable??!0,label:y.label,labelStyle:y.labelStyle,labelShowBg:y.labelShowBg,labelBgStyle:y.labelBgStyle,labelBgPadding:y.labelBgPadding,labelBgBorderRadius:y.labelBgBorderRadius,sourceX:$,sourceY:C,targetX:N,targetY:R,sourcePosition:z,targetPosition:j,data:y.data,style:y.style,sourceHandleId:y.sourceHandle,targetHandleId:y.targetHandle,markerStart:q,markerEnd:H,pathOptions:"pathOptions"in y?y.pathOptions:void 0,interactionWidth:y.interactionWidth}),E&&_.jsx(ZR,{edge:y,isReconnectable:E,reconnectRadius:c,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:$,sourceY:C,targetX:N,targetY:R,sourcePosition:z,targetPosition:j,setUpdateHover:P,setReconnecting:T})]})})}var tP=I.memo(eP);const nP=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function Hb({defaultMarkerColor:t,onlyRenderVisibleElements:e,rfId:n,edgeTypes:r,noPanClassName:i,onReconnect:s,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:a,onEdgeMouseLeave:u,onEdgeClick:c,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:m}){const{edgesFocusable:v,edgesReconnectable:g,elementsSelectable:w,onError:y}=fe(nP,_e),x=BR(e);return _.jsxs("div",{className:"react-flow__edges",children:[_.jsx(WR,{defaultColor:t,rfId:n}),x.map(k=>_.jsx(tP,{id:k,edgesFocusable:v,edgesReconnectable:g,elementsSelectable:w,noPanClassName:i,onReconnect:s,onContextMenu:o,onMouseEnter:l,onMouseMove:a,onMouseLeave:u,onClick:c,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:y,edgeTypes:r,disableKeyboardA11y:m},k))]})}Hb.displayName="EdgeRenderer";const rP=I.memo(Hb),iP=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function sP({children:t}){const e=fe(iP);return _.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:e},children:t})}function oP(t){const e=Nc(),n=I.useRef(!1);I.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const lP=t=>{var e;return(e=t.panZoom)==null?void 0:e.syncViewport};function aP(t){const e=fe(lP),n=Ee();return I.useEffect(()=>{t&&(e==null||e(t),n.setState({transform:[t.x,t.y,t.zoom]}))},[t,e]),null}function uP(t){return t.connection.inProgress?{...t.connection,to:Fl(t.connection.to,t.transform)}:{...t.connection}}function cP(t){return uP}function dP(t){const e=cP();return fe(e,_e)}const fP=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function hP({containerStyle:t,style:e,type:n,component:r}){const{nodesConnectable:i,width:s,height:o,isValid:l,inProgress:a}=fe(fP,_e);return!(s&&i&&a)?null:_.jsx("svg",{style:t,width:s,height:o,className:"react-flow__connectionline react-flow__container",children:_.jsx("g",{className:$e(["react-flow__connection",$S(l)]),children:_.jsx(Wb,{style:e,type:n,CustomComponent:r,isValid:l})})})}const Wb=({style:t,type:e=fr.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:i,from:s,fromNode:o,fromHandle:l,fromPosition:a,to:u,toNode:c,toHandle:d,toPosition:f,pointer:h}=dP();if(!i)return;if(n)return _.jsx(n,{connectionLineType:e,connectionLineStyle:t,fromNode:o,fromHandle:l,fromX:s.x,fromY:s.y,toX:u.x,toY:u.y,fromPosition:a,toPosition:f,connectionStatus:$S(r),toNode:c,toHandle:d,pointer:h});let p="";const m={sourceX:s.x,sourceY:s.y,sourcePosition:a,targetX:u.x,targetY:u.y,targetPosition:f};switch(e){case fr.Bezier:[p]=JS(m);break;case fr.SimpleBezier:[p]=Ib(m);break;case fr.Step:[p]=fh({...m,borderRadius:0});break;case fr.SmoothStep:[p]=fh(m);break;default:[p]=XS(m)}return _.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:t})};Wb.displayName="ConnectionLine";const pP={};function Qy(t=pP){I.useRef(t),Ee(),I.useEffect(()=>{},[t])}function mP(){Ee(),I.useRef(!1),I.useEffect(()=>{},[])}function qb({nodeTypes:t,edgeTypes:e,onInit:n,onNodeClick:r,onEdgeClick:i,onNodeDoubleClick:s,onEdgeDoubleClick:o,onNodeMouseEnter:l,onNodeMouseMove:a,onNodeMouseLeave:u,onNodeContextMenu:c,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:m,connectionLineComponent:v,connectionLineContainerStyle:g,selectionKeyCode:w,selectionOnDrag:y,selectionMode:x,multiSelectionKeyCode:k,panActivationKeyCode:S,zoomActivationKeyCode:b,deleteKeyCode:E,onlyRenderVisibleElements:O,elementsSelectable:L,defaultViewport:A,translateExtent:P,minZoom:B,maxZoom:T,preventScrolling:D,defaultMarkerColor:M,zoomOnScroll:$,zoomOnPinch:C,panOnScroll:N,panOnScrollSpeed:R,panOnScrollMode:z,zoomOnDoubleClick:j,panOnDrag:q,onPaneClick:H,onPaneMouseEnter:X,onPaneMouseMove:Q,onPaneMouseLeave:Z,onPaneScroll:U,onPaneContextMenu:te,paneClickDistance:ce,nodeClickDistance:le,onEdgeContextMenu:se,onEdgeMouseEnter:re,onEdgeMouseMove:me,onEdgeMouseLeave:xe,reconnectRadius:pe,onReconnect:it,onReconnectStart:er,onReconnectEnd:Mn,noDragClassName:Ur,noWheelClassName:Xs,noPanClassName:Qs,disableKeyboardA11y:Zs,nodeExtent:Jc,rfId:Kl,viewport:Ri,onViewportChange:eo}){return Qy(t),Qy(e),mP(),oP(n),aP(Ri),_.jsx(MR,{onPaneClick:H,onPaneMouseEnter:X,onPaneMouseMove:Q,onPaneMouseLeave:Z,onPaneContextMenu:te,onPaneScroll:U,paneClickDistance:ce,deleteKeyCode:E,selectionKeyCode:w,selectionOnDrag:y,selectionMode:x,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:k,panActivationKeyCode:S,zoomActivationKeyCode:b,elementsSelectable:L,zoomOnScroll:$,zoomOnPinch:C,zoomOnDoubleClick:j,panOnScroll:N,panOnScrollSpeed:R,panOnScrollMode:z,panOnDrag:q,defaultViewport:A,translateExtent:P,minZoom:B,maxZoom:T,onSelectionContextMenu:d,preventScrolling:D,noDragClassName:Ur,noWheelClassName:Xs,noPanClassName:Qs,disableKeyboardA11y:Zs,onViewportChange:eo,isControlledViewport:!!Ri,children:_.jsxs(sP,{children:[_.jsx(rP,{edgeTypes:e,onEdgeClick:i,onEdgeDoubleClick:o,onReconnect:it,onReconnectStart:er,onReconnectEnd:Mn,onlyRenderVisibleElements:O,onEdgeContextMenu:se,onEdgeMouseEnter:re,onEdgeMouseMove:me,onEdgeMouseLeave:xe,reconnectRadius:pe,defaultMarkerColor:M,noPanClassName:Qs,disableKeyboardA11y:Zs,rfId:Kl}),_.jsx(hP,{style:m,type:p,component:v,containerStyle:g}),_.jsx("div",{className:"react-flow__edgelabel-renderer"}),_.jsx(zR,{nodeTypes:t,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:l,onNodeMouseMove:a,onNodeMouseLeave:u,onNodeContextMenu:c,nodeClickDistance:le,onlyRenderVisibleElements:O,noPanClassName:Qs,noDragClassName:Ur,disableKeyboardA11y:Zs,nodeExtent:Jc,rfId:Kl}),_.jsx("div",{className:"react-flow__viewport-portal"})]})})}qb.displayName="GraphView";const gP=I.memo(qb),Zy=({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,fitViewOptions:l,minZoom:a=.5,maxZoom:u=2,nodeOrigin:c,nodeExtent:d,zIndexMode:f="basic"}={})=>{const h=new Map,p=new Map,m=new Map,v=new Map,g=r??e??[],w=n??t??[],y=c??[0,0],x=d??ul;eb(m,v,g);const k=ph(w,h,p,{nodeOrigin:y,nodeExtent:x,zIndexMode:f});let S=[0,0,1];if(o&&i&&s){const b=zl(h,{filter:A=>!!((A.width||A.initialWidth)&&(A.height||A.initialHeight))}),{x:E,y:O,zoom:L}=Zp(b,i,s,a,u,(l==null?void 0:l.padding)??.1);S=[E,O,L]}return{rfId:"1",width:i??0,height:s??0,transform:S,nodes:w,nodesInitialized:k,nodeLookup:h,parentLookup:p,edges:g,edgeLookup:v,connectionLookup:m,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:a,maxZoom:u,translateExtent:ul,nodeExtent:x,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Rs.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:y,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:o??!1,fitViewOptions:l,fitViewResolver:null,connection:{...DS},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:xA,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:PS,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},yP=({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:o,fitViewOptions:l,minZoom:a,maxZoom:u,nodeOrigin:c,nodeExtent:d,zIndexMode:f})=>DI((h,p)=>{async function m(){const{nodeLookup:v,panZoom:g,fitViewOptions:w,fitViewResolver:y,width:x,height:k,minZoom:S,maxZoom:b}=p();g&&(await vA({nodes:v,width:x,height:k,panZoom:g,minZoom:S,maxZoom:b},w),y==null||y.resolve(!0),h({fitViewResolver:null}))}return{...Zy({nodes:t,edges:e,width:i,height:s,fitView:o,fitViewOptions:l,minZoom:a,maxZoom:u,nodeOrigin:c,nodeExtent:d,defaultNodes:n,defaultEdges:r,zIndexMode:f}),setNodes:v=>{const{nodeLookup:g,parentLookup:w,nodeOrigin:y,elevateNodesOnSelect:x,fitViewQueued:k,zIndexMode:S}=p(),b=ph(v,g,w,{nodeOrigin:y,nodeExtent:d,elevateNodesOnSelect:x,checkEquality:!0,zIndexMode:S});k&&b?(m(),h({nodes:v,nodesInitialized:b,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:v,nodesInitialized:b})},setEdges:v=>{const{connectionLookup:g,edgeLookup:w}=p();eb(g,w,v),h({edges:v})},setDefaultNodesAndEdges:(v,g)=>{if(v){const{setNodes:w}=p();w(v),h({hasDefaultNodes:!0})}if(g){const{setEdges:w}=p();w(g),h({hasDefaultEdges:!0})}},updateNodeInternals:v=>{const{triggerNodeChanges:g,nodeLookup:w,parentLookup:y,domNode:x,nodeOrigin:k,nodeExtent:S,debug:b,fitViewQueued:E,zIndexMode:O}=p(),{changes:L,updatedInternals:A}=FA(v,w,y,x,k,S,O);A&&(LA(w,y,{nodeOrigin:k,nodeExtent:S,zIndexMode:O}),E?(m(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),(L==null?void 0:L.length)>0&&(b&&console.log("React Flow: trigger node changes",L),g==null||g(L)))},updateNodePositions:(v,g=!1)=>{const w=[];let y=[];const{nodeLookup:x,triggerNodeChanges:k,connection:S,updateConnection:b,onNodesChangeMiddlewareMap:E}=p();for(const[O,L]of v){const A=x.get(O),P=!!(A!=null&&A.expandParent&&(A!=null&&A.parentId)&&(L!=null&&L.position)),B={id:O,type:"position",position:P?{x:Math.max(0,L.position.x),y:Math.max(0,L.position.y)}:L.position,dragging:g};if(A&&S.inProgress&&S.fromNode.id===A.id){const T=Ei(A,S.fromHandle,Y.Left,!0);b({...S,from:T})}P&&A.parentId&&w.push({id:O,parentId:A.parentId,rect:{...L.internals.positionAbsolute,width:L.measured.width??0,height:L.measured.height??0}}),y.push(B)}if(w.length>0){const{parentLookup:O,nodeOrigin:L}=p(),A=sm(w,x,O,L);y.push(...A)}for(const O of E.values())y=O(y);k(y)},triggerNodeChanges:v=>{const{onNodesChange:g,setNodes:w,nodes:y,hasDefaultNodes:x,debug:k}=p();if(v!=null&&v.length){if(x){const S=Sb(v,y);w(S)}k&&console.log("React Flow: trigger node changes",v),g==null||g(v)}},triggerEdgeChanges:v=>{const{onEdgesChange:g,setEdges:w,edges:y,hasDefaultEdges:x,debug:k}=p();if(v!=null&&v.length){if(x){const S=bb(v,y);w(S)}k&&console.log("React Flow: trigger edge changes",v),g==null||g(v)}},addSelectedNodes:v=>{const{multiSelectionActive:g,edgeLookup:w,nodeLookup:y,triggerNodeChanges:x,triggerEdgeChanges:k}=p();if(g){const S=v.map(b=>Jr(b,!0));x(S);return}x(us(y,new Set([...v]),!0)),k(us(w))},addSelectedEdges:v=>{const{multiSelectionActive:g,edgeLookup:w,nodeLookup:y,triggerNodeChanges:x,triggerEdgeChanges:k}=p();if(g){const S=v.map(b=>Jr(b,!0));k(S);return}k(us(w,new Set([...v]))),x(us(y,new Set,!0))},unselectNodesAndEdges:({nodes:v,edges:g}={})=>{const{edges:w,nodes:y,nodeLookup:x,triggerNodeChanges:k,triggerEdgeChanges:S}=p(),b=v||y,E=g||w,O=b.map(A=>{const P=x.get(A.id);return P&&(P.selected=!1),Jr(A.id,!1)}),L=E.map(A=>Jr(A.id,!1));k(O),S(L)},setMinZoom:v=>{const{panZoom:g,maxZoom:w}=p();g==null||g.setScaleExtent([v,w]),h({minZoom:v})},setMaxZoom:v=>{const{panZoom:g,minZoom:w}=p();g==null||g.setScaleExtent([w,v]),h({maxZoom:v})},setTranslateExtent:v=>{var g;(g=p().panZoom)==null||g.setTranslateExtent(v),h({translateExtent:v})},resetSelectedElements:()=>{const{edges:v,nodes:g,triggerNodeChanges:w,triggerEdgeChanges:y,elementsSelectable:x}=p();if(!x)return;const k=g.reduce((b,E)=>E.selected?[...b,Jr(E.id,!1)]:b,[]),S=v.reduce((b,E)=>E.selected?[...b,Jr(E.id,!1)]:b,[]);w(k),y(S)},setNodeExtent:v=>{const{nodes:g,nodeLookup:w,parentLookup:y,nodeOrigin:x,elevateNodesOnSelect:k,nodeExtent:S,zIndexMode:b}=p();v[0][0]===S[0][0]&&v[0][1]===S[0][1]&&v[1][0]===S[1][0]&&v[1][1]===S[1][1]||(ph(g,w,y,{nodeOrigin:x,nodeExtent:v,elevateNodesOnSelect:k,checkEquality:!1,zIndexMode:b}),h({nodeExtent:v}))},panBy:v=>{const{transform:g,width:w,height:y,panZoom:x,translateExtent:k}=p();return VA({delta:v,panZoom:x,transform:g,translateExtent:k,width:w,height:y})},setCenter:async(v,g,w)=>{const{width:y,height:x,maxZoom:k,panZoom:S}=p();if(!S)return Promise.resolve(!1);const b=typeof(w==null?void 0:w.zoom)<"u"?w.zoom:k;return await S.setViewport({x:y/2-v*b,y:x/2-g*b,zoom:b},{duration:w==null?void 0:w.duration,ease:w==null?void 0:w.ease,interpolate:w==null?void 0:w.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{h({connection:{...DS}})},updateConnection:v=>{h({connection:v})},reset:()=>h({...Zy()})}},Object.is);function Kb({initialNodes:t,initialEdges:e,defaultNodes:n,defaultEdges:r,initialWidth:i,initialHeight:s,initialMinZoom:o,initialMaxZoom:l,initialFitViewOptions:a,fitView:u,nodeOrigin:c,nodeExtent:d,zIndexMode:f,children:h}){const[p]=I.useState(()=>yP({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,width:i,height:s,fitView:u,minZoom:o,maxZoom:l,fitViewOptions:a,nodeOrigin:c,nodeExtent:d,zIndexMode:f}));return _.jsx($I,{value:p,children:_.jsx(sR,{children:h})})}function vP({children:t,nodes:e,edges:n,defaultNodes:r,defaultEdges:i,width:s,height:o,fitView:l,fitViewOptions:a,minZoom:u,maxZoom:c,nodeOrigin:d,nodeExtent:f,zIndexMode:h}){return I.useContext(Tc)?_.jsx(_.Fragment,{children:t}):_.jsx(Kb,{initialNodes:e,initialEdges:n,defaultNodes:r,defaultEdges:i,initialWidth:s,initialHeight:o,fitView:l,initialFitViewOptions:a,initialMinZoom:u,initialMaxZoom:c,nodeOrigin:d,nodeExtent:f,zIndexMode:h,children:t})}const wP={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function xP({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s,edgeTypes:o,onNodeClick:l,onEdgeClick:a,onInit:u,onMove:c,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:g,onNodeMouseEnter:w,onNodeMouseMove:y,onNodeMouseLeave:x,onNodeContextMenu:k,onNodeDoubleClick:S,onNodeDragStart:b,onNodeDrag:E,onNodeDragStop:O,onNodesDelete:L,onEdgesDelete:A,onDelete:P,onSelectionChange:B,onSelectionDragStart:T,onSelectionDrag:D,onSelectionDragStop:M,onSelectionContextMenu:$,onSelectionStart:C,onSelectionEnd:N,onBeforeDelete:R,connectionMode:z,connectionLineType:j=fr.Bezier,connectionLineStyle:q,connectionLineComponent:H,connectionLineContainerStyle:X,deleteKeyCode:Q="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:U=!1,selectionMode:te=cl.Full,panActivationKeyCode:ce="Space",multiSelectionKeyCode:le=fl()?"Meta":"Control",zoomActivationKeyCode:se=fl()?"Meta":"Control",snapToGrid:re,snapGrid:me,onlyRenderVisibleElements:xe=!1,selectNodesOnDrag:pe,nodesDraggable:it,autoPanOnNodeFocus:er,nodesConnectable:Mn,nodesFocusable:Ur,nodeOrigin:Xs=wb,edgesFocusable:Qs,edgesReconnectable:Zs,elementsSelectable:Jc=!0,defaultViewport:Kl=GI,minZoom:Ri=.5,maxZoom:eo=2,translateExtent:Dm=ul,preventScrolling:o_=!0,nodeExtent:Gc,defaultMarkerColor:l_="#b1b1b7",zoomOnScroll:a_=!0,zoomOnPinch:u_=!0,panOnScroll:c_=!1,panOnScrollSpeed:d_=.5,panOnScrollMode:f_=di.Free,zoomOnDoubleClick:h_=!0,panOnDrag:p_=!0,onPaneClick:m_,onPaneMouseEnter:g_,onPaneMouseMove:y_,onPaneMouseLeave:v_,onPaneScroll:w_,onPaneContextMenu:x_,paneClickDistance:S_=1,nodeClickDistance:b_=0,children:k_,onReconnect:__,onReconnectStart:E_,onReconnectEnd:C_,onEdgeContextMenu:T_,onEdgeDoubleClick:N_,onEdgeMouseEnter:O_,onEdgeMouseMove:M_,onEdgeMouseLeave:A_,reconnectRadius:I_=10,onNodesChange:R_,onEdgesChange:P_,noDragClassName:D_="nodrag",noWheelClassName:$_="nowheel",noPanClassName:$m="nopan",fitView:Lm,fitViewOptions:jm,connectOnClick:L_,attributionPosition:j_,proOptions:z_,defaultEdgeOptions:B_,elevateNodesOnSelect:F_=!0,elevateEdgesOnSelect:V_=!1,disableKeyboardA11y:zm=!1,autoPanOnConnect:U_,autoPanOnNodeDrag:H_,autoPanSpeed:W_,connectionRadius:q_,isValidConnection:K_,onError:J_,style:G_,id:Bm,nodeDragThreshold:Y_,connectionDragThreshold:X_,viewport:Q_,onViewportChange:Z_,width:eE,height:tE,colorMode:nE="light",debug:rE,onScroll:Jl,ariaLabelConfig:iE,zIndexMode:Fm="basic",...sE},oE){const Yc=Bm||"1",lE=ZI(nE),aE=I.useCallback(Vm=>{Vm.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Jl==null||Jl(Vm)},[Jl]);return _.jsx("div",{"data-testid":"rf__wrapper",...sE,onScroll:aE,style:{...G_,...wP},ref:oE,className:$e(["react-flow",i,lE]),id:Bm,role:"application",children:_.jsxs(vP,{nodes:t,edges:e,width:eE,height:tE,fitView:Lm,fitViewOptions:jm,minZoom:Ri,maxZoom:eo,nodeOrigin:Xs,nodeExtent:Gc,zIndexMode:Fm,children:[_.jsx(gP,{onInit:u,onNodeClick:l,onEdgeClick:a,onNodeMouseEnter:w,onNodeMouseMove:y,onNodeMouseLeave:x,onNodeContextMenu:k,onNodeDoubleClick:S,nodeTypes:s,edgeTypes:o,connectionLineType:j,connectionLineStyle:q,connectionLineComponent:H,connectionLineContainerStyle:X,selectionKeyCode:Z,selectionOnDrag:U,selectionMode:te,deleteKeyCode:Q,multiSelectionKeyCode:le,panActivationKeyCode:ce,zoomActivationKeyCode:se,onlyRenderVisibleElements:xe,defaultViewport:Kl,translateExtent:Dm,minZoom:Ri,maxZoom:eo,preventScrolling:o_,zoomOnScroll:a_,zoomOnPinch:u_,zoomOnDoubleClick:h_,panOnScroll:c_,panOnScrollSpeed:d_,panOnScrollMode:f_,panOnDrag:p_,onPaneClick:m_,onPaneMouseEnter:g_,onPaneMouseMove:y_,onPaneMouseLeave:v_,onPaneScroll:w_,onPaneContextMenu:x_,paneClickDistance:S_,nodeClickDistance:b_,onSelectionContextMenu:$,onSelectionStart:C,onSelectionEnd:N,onReconnect:__,onReconnectStart:E_,onReconnectEnd:C_,onEdgeContextMenu:T_,onEdgeDoubleClick:N_,onEdgeMouseEnter:O_,onEdgeMouseMove:M_,onEdgeMouseLeave:A_,reconnectRadius:I_,defaultMarkerColor:l_,noDragClassName:D_,noWheelClassName:$_,noPanClassName:$m,rfId:Yc,disableKeyboardA11y:zm,nodeExtent:Gc,viewport:Q_,onViewportChange:Z_}),_.jsx(QI,{nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:g,nodesDraggable:it,autoPanOnNodeFocus:er,nodesConnectable:Mn,nodesFocusable:Ur,edgesFocusable:Qs,edgesReconnectable:Zs,elementsSelectable:Jc,elevateNodesOnSelect:F_,elevateEdgesOnSelect:V_,minZoom:Ri,maxZoom:eo,nodeExtent:Gc,onNodesChange:R_,onEdgesChange:P_,snapToGrid:re,snapGrid:me,connectionMode:z,translateExtent:Dm,connectOnClick:L_,defaultEdgeOptions:B_,fitView:Lm,fitViewOptions:jm,onNodesDelete:L,onEdgesDelete:A,onDelete:P,onNodeDragStart:b,onNodeDrag:E,onNodeDragStop:O,onSelectionDrag:D,onSelectionDragStart:T,onSelectionDragStop:M,onMove:c,onMoveStart:d,onMoveEnd:f,noPanClassName:$m,nodeOrigin:Xs,rfId:Yc,autoPanOnConnect:U_,autoPanOnNodeDrag:H_,autoPanSpeed:W_,onError:J_,connectionRadius:q_,isValidConnection:K_,selectNodesOnDrag:pe,nodeDragThreshold:Y_,connectionDragThreshold:X_,onBeforeDelete:R,debug:rE,ariaLabelConfig:iE,zIndexMode:Fm}),_.jsx(JI,{onSelectionChange:B}),k_,_.jsx(UI,{proOptions:z_,position:j_}),_.jsx(VI,{rfId:Yc,disableKeyboardA11y:zm})]})})}var SP=kb(xP);function bP({dimensions:t,lineWidth:e,variant:n,className:r}){return _.jsx("path",{strokeWidth:e,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:$e(["react-flow__background-pattern",n,r])})}function kP({radius:t,className:e}){return _.jsx("circle",{cx:t,cy:t,r:t,className:$e(["react-flow__background-pattern","dots",e])})}var Vn;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(Vn||(Vn={}));const _P={[Vn.Dots]:1,[Vn.Lines]:1,[Vn.Cross]:6},EP=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Jb({id:t,variant:e=Vn.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=0,color:o,bgColor:l,style:a,className:u,patternClassName:c}){const d=I.useRef(null),{transform:f,patternId:h}=fe(EP,_e),p=r||_P[e],m=e===Vn.Dots,v=e===Vn.Cross,g=Array.isArray(n)?n:[n,n],w=[g[0]*f[2]||1,g[1]*f[2]||1],y=p*f[2],x=Array.isArray(s)?s:[s,s],k=v?[y,y]:w,S=[x[0]*f[2]||1+k[0]/2,x[1]*f[2]||1+k[1]/2],b=`${h}${t||""}`;return _.jsxs("svg",{className:$e(["react-flow__background",u]),style:{...a,...Oc,"--xy-background-color-props":l,"--xy-background-pattern-color-props":o},ref:d,"data-testid":"rf__background",children:[_.jsx("pattern",{id:b,x:f[0]%w[0],y:f[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:m?_.jsx(kP,{radius:y/2,className:c}):_.jsx(bP,{dimensions:k,lineWidth:i,variant:e,className:c})}),_.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${b})`})]})}Jb.displayName="Background";const CP=I.memo(Jb);function TP(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:_.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function NP(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:_.jsx("path",{d:"M0 0h32v4.2H0z"})})}function OP(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:_.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function MP(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:_.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function AP(){return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:_.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function xa({children:t,className:e,...n}){return _.jsx("button",{type:"button",className:$e(["react-flow__controls-button",e]),...n,children:t})}const IP=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function Gb({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:l,onInteractiveChange:a,className:u,children:c,position:d="bottom-left",orientation:f="vertical","aria-label":h}){const p=Ee(),{isInteractive:m,minZoomReached:v,maxZoomReached:g,ariaLabelConfig:w}=fe(IP,_e),{zoomIn:y,zoomOut:x,fitView:k}=Nc(),S=()=>{y(),s==null||s()},b=()=>{x(),o==null||o()},E=()=>{k(i),l==null||l()},O=()=>{p.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),a==null||a(!m)},L=f==="horizontal"?"horizontal":"vertical";return _.jsxs(Vl,{className:$e(["react-flow__controls",L,u]),position:d,style:t,"data-testid":"rf__controls","aria-label":h??w["controls.ariaLabel"],children:[e&&_.jsxs(_.Fragment,{children:[_.jsx(xa,{onClick:S,className:"react-flow__controls-zoomin",title:w["controls.zoomIn.ariaLabel"],"aria-label":w["controls.zoomIn.ariaLabel"],disabled:g,children:_.jsx(TP,{})}),_.jsx(xa,{onClick:b,className:"react-flow__controls-zoomout",title:w["controls.zoomOut.ariaLabel"],"aria-label":w["controls.zoomOut.ariaLabel"],disabled:v,children:_.jsx(NP,{})})]}),n&&_.jsx(xa,{className:"react-flow__controls-fitview",onClick:E,title:w["controls.fitView.ariaLabel"],"aria-label":w["controls.fitView.ariaLabel"],children:_.jsx(OP,{})}),r&&_.jsx(xa,{className:"react-flow__controls-interactive",onClick:O,title:w["controls.interactive.ariaLabel"],"aria-label":w["controls.interactive.ariaLabel"],children:m?_.jsx(AP,{}):_.jsx(MP,{})}),c]})}Gb.displayName="Controls";const RP=I.memo(Gb);function PP({id:t,x:e,y:n,width:r,height:i,style:s,color:o,strokeColor:l,strokeWidth:a,className:u,borderRadius:c,shapeRendering:d,selected:f,onClick:h}){const{background:p,backgroundColor:m}=s||{},v=o||p||m;return _.jsx("rect",{className:$e(["react-flow__minimap-node",{selected:f},u]),x:e,y:n,rx:c,ry:c,width:r,height:i,style:{fill:v,stroke:l,strokeWidth:a},shapeRendering:d,onClick:h?g=>h(g,t):void 0})}const DP=I.memo(PP),$P=t=>t.nodes.map(e=>e.id),Id=t=>t instanceof Function?t:()=>t;function LP({nodeStrokeColor:t,nodeColor:e,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:s=DP,onClick:o}){const l=fe($P,_e),a=Id(e),u=Id(t),c=Id(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return _.jsx(_.Fragment,{children:l.map(f=>_.jsx(zP,{id:f,nodeColorFunc:a,nodeStrokeColorFunc:u,nodeClassNameFunc:c,nodeBorderRadius:r,nodeStrokeWidth:i,NodeComponent:s,onClick:o,shapeRendering:d},f))})}function jP({id:t,nodeColorFunc:e,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:i,nodeStrokeWidth:s,shapeRendering:o,NodeComponent:l,onClick:a}){const{node:u,x:c,y:d,width:f,height:h}=fe(p=>{const{internals:m}=p.nodeLookup.get(t),v=m.userNode,{x:g,y:w}=m.positionAbsolute,{width:y,height:x}=Qn(v);return{node:v,x:g,y:w,width:y,height:x}},_e);return!u||u.hidden||!VS(u)?null:_.jsx(l,{x:c,y:d,width:f,height:h,style:u.style,selected:!!u.selected,className:r(u),color:e(u),borderRadius:i,strokeColor:n(u),strokeWidth:s,shapeRendering:o,onClick:a,id:u.id})}const zP=I.memo(jP);var BP=I.memo(LP);const FP=200,VP=150,UP=t=>!t.hidden,HP=t=>{const e={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:e,boundingRect:t.nodeLookup.size>0?FS(zl(t.nodeLookup,{filter:UP}),e):e,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},WP="react-flow__minimap-desc";function Yb({style:t,className:e,nodeStrokeColor:n,nodeColor:r,nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o,nodeComponent:l,bgColor:a,maskColor:u,maskStrokeColor:c,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:m=!1,zoomable:v=!1,ariaLabel:g,inversePan:w,zoomStep:y=1,offsetScale:x=5}){const k=Ee(),S=I.useRef(null),{boundingRect:b,viewBB:E,rfId:O,panZoom:L,translateExtent:A,flowWidth:P,flowHeight:B,ariaLabelConfig:T}=fe(HP,_e),D=(t==null?void 0:t.width)??FP,M=(t==null?void 0:t.height)??VP,$=b.width/D,C=b.height/M,N=Math.max($,C),R=N*D,z=N*M,j=x*N,q=b.x-(R-b.width)/2-j,H=b.y-(z-b.height)/2-j,X=R+j*2,Q=z+j*2,Z=`${WP}-${O}`,U=I.useRef(0),te=I.useRef();U.current=N,I.useEffect(()=>{if(S.current&&L)return te.current=XA({domNode:S.current,panZoom:L,getTransform:()=>k.getState().transform,getViewScale:()=>U.current}),()=>{var re;(re=te.current)==null||re.destroy()}},[L]),I.useEffect(()=>{var re;(re=te.current)==null||re.update({translateExtent:A,width:P,height:B,inversePan:w,pannable:m,zoomStep:y,zoomable:v})},[m,v,w,y,A,P,B]);const ce=h?re=>{var pe;const[me,xe]=((pe=te.current)==null?void 0:pe.pointer(re))||[0,0];h(re,{x:me,y:xe})}:void 0,le=p?I.useCallback((re,me)=>{const xe=k.getState().nodeLookup.get(me).internals.userNode;p(re,xe)},[]):void 0,se=g??T["minimap.ariaLabel"];return _.jsx(Vl,{position:f,style:{...t,"--xy-minimap-background-color-props":typeof a=="string"?a:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*N:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof o=="number"?o:void 0},className:$e(["react-flow__minimap",e]),"data-testid":"rf__minimap",children:_.jsxs("svg",{width:D,height:M,viewBox:`${q} ${H} ${X} ${Q}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Z,ref:S,onClick:ce,children:[se&&_.jsx("title",{id:Z,children:se}),_.jsx(BP,{onClick:le,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:l}),_.jsx("path",{className:"react-flow__minimap-mask",d:`M${q-j},${H-j}h${X+j*2}v${Q+j*2}h${-X-j*2}z
        M${E.x},${E.y}h${E.width}v${E.height}h${-E.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Yb.displayName="MiniMap";const qP=I.memo(Yb),KP=t=>e=>t?`${Math.max(1/e.transform[2],1)}`:void 0,JP={[Ls.Line]:"right",[Ls.Handle]:"bottom-right"};function GP({nodeId:t,position:e,variant:n=Ls.Handle,className:r,style:i=void 0,children:s,color:o,minWidth:l=10,minHeight:a=10,maxWidth:u=Number.MAX_VALUE,maxHeight:c=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:f,autoScale:h=!0,shouldResize:p,onResizeStart:m,onResize:v,onResizeEnd:g}){const w=Tb(),y=typeof t=="string"?t:w,x=Ee(),k=I.useRef(null),S=n===Ls.Handle,b=fe(I.useCallback(KP(S&&h),[S,h]),_e),E=I.useRef(null),O=e??JP[n];I.useEffect(()=>{if(!(!k.current||!y))return E.current||(E.current=dI({domNode:k.current,nodeId:y,getStoreItems:()=>{const{nodeLookup:A,transform:P,snapGrid:B,snapToGrid:T,nodeOrigin:D,domNode:M}=x.getState();return{nodeLookup:A,transform:P,snapGrid:B,snapToGrid:T,nodeOrigin:D,paneDomNode:M}},onChange:(A,P)=>{const{triggerNodeChanges:B,nodeLookup:T,parentLookup:D,nodeOrigin:M}=x.getState(),$=[],C={x:A.x,y:A.y},N=T.get(y);if(N&&N.expandParent&&N.parentId){const R=N.origin??M,z=A.width??N.measured.width??0,j=A.height??N.measured.height??0,q={id:N.id,parentId:N.parentId,rect:{width:z,height:j,...US({x:A.x??N.position.x,y:A.y??N.position.y},{width:z,height:j},N.parentId,T,R)}},H=sm([q],T,D,M);$.push(...H),C.x=A.x?Math.max(R[0]*z,A.x):void 0,C.y=A.y?Math.max(R[1]*j,A.y):void 0}if(C.x!==void 0&&C.y!==void 0){const R={id:y,type:"position",position:{...C}};$.push(R)}if(A.width!==void 0&&A.height!==void 0){const z={id:y,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:A.width,height:A.height}};$.push(z)}for(const R of P){const z={...R,type:"position"};$.push(z)}B($)},onEnd:({width:A,height:P})=>{const B={id:y,type:"dimensions",resizing:!1,dimensions:{width:A,height:P}};x.getState().triggerNodeChanges([B])}})),E.current.update({controlPosition:O,boundaries:{minWidth:l,minHeight:a,maxWidth:u,maxHeight:c},keepAspectRatio:d,resizeDirection:f,onResizeStart:m,onResize:v,onResizeEnd:g,shouldResize:p}),()=>{var A;(A=E.current)==null||A.destroy()}},[O,l,a,u,c,d,m,v,g,p]);const L=O.split("-");return _.jsx("div",{className:$e(["react-flow__resize-control","nodrag",...L,n,r]),ref:k,style:{...i,scale:b,...o&&{[S?"backgroundColor":"borderColor"]:o}},children:s})}I.memo(GP);const Xb={},{useDebugValue:YP}=Ve,{useSyncExternalStoreWithSelector:XP}=hb;let e0=!1;const QP=t=>t;function ZP(t,e=QP,n){(Xb?"production":void 0)!=="production"&&n&&!e0&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),e0=!0);const r=XP(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return YP(r),r}const t0=t=>{(Xb?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?pb(t):t,n=(r,i)=>ZP(e,r,i);return Object.assign(n,e),n},eD=t=>t?t0(t):t0;let Sa;const tD=new Uint8Array(16);function nD(){if(!Sa&&(Sa=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Sa))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sa(tD)}const Ge=[];for(let t=0;t<256;++t)Ge.push((t+256).toString(16).slice(1));function rD(t,e=0){return Ge[t[e+0]]+Ge[t[e+1]]+Ge[t[e+2]]+Ge[t[e+3]]+"-"+Ge[t[e+4]]+Ge[t[e+5]]+"-"+Ge[t[e+6]]+Ge[t[e+7]]+"-"+Ge[t[e+8]]+Ge[t[e+9]]+"-"+Ge[t[e+10]]+Ge[t[e+11]]+Ge[t[e+12]]+Ge[t[e+13]]+Ge[t[e+14]]+Ge[t[e+15]]}const iD=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),n0={randomUUID:iD};function yh(t,e,n){if(n0.randomUUID&&!t)return n0.randomUUID();t=t||{};const r=t.random||(t.rng||nD)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,rD(r)}function Ac(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function sD(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})}const oD=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class lm extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class lD extends lm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class r0 extends lm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class i0 extends lm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var vh;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(vh||(vh={}));class aD{constructor(e,{headers:n={},customFetch:r,region:i=vh.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=oD(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return sD(this,arguments,void 0,function*(n,r={}){var i;let s,o;try{const{headers:l,method:a,body:u,signal:c,timeout:d}=r;let f={},{region:h}=r;h||(h=this.region);const p=new URL(`${this.url}/${n}`);h&&h!=="any"&&(f["x-region"]=h,p.searchParams.set("forceFunctionRegion",h));let m;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=u):typeof u=="string"?(f["Content-Type"]="text/plain",m=u):typeof FormData<"u"&&u instanceof FormData?m=u:(f["Content-Type"]="application/json",m=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?m=JSON.stringify(u):m=u;let v=c;d&&(o=new AbortController,s=setTimeout(()=>o.abort(),d),c?(v=o.signal,c.addEventListener("abort",()=>o.abort())):v=o.signal);const g=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:m,signal:v}).catch(k=>{throw new lD(k)}),w=g.headers.get("x-relay-error");if(w&&w==="true")throw new r0(g);if(!g.ok)throw new i0(g);let y=((i=g.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),x;return y==="application/json"?x=yield g.json():y==="application/octet-stream"||y==="application/pdf"?x=yield g.blob():y==="text/event-stream"?x=g:y==="multipart/form-data"?x=yield g.formData():x=yield g.text(),{data:x,error:null,response:g}}catch(l){return{data:null,error:l,response:l instanceof i0||l instanceof r0?l.context:void 0}}finally{s&&clearTimeout(s)}})}}var uD=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},cD=class{constructor(t){var e,n,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,this.urlLengthLimit=(r=t.urlLengthLimit)!==null&&r!==void 0?r:8e3,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let o=null,l=null,a=null,u=s.status,c=s.statusText;if(s.ok){var d,f;if(n.method!=="HEAD"){var h;const g=await s.text();g===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((h=n.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?l=g:l=JSON.parse(g))}const m=(d=n.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),v=(f=s.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");m&&v&&v.length>1&&(a=parseInt(v[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,a=null,u=406,c="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var p;const m=await s.text();try{o=JSON.parse(m),Array.isArray(o)&&s.status===404&&(l=[],o=null,u=200,c="OK")}catch{s.status===404&&m===""?(u=204,c="No Content"):o={message:m}}if(o&&n.isMaybeSingle&&(!(o==null||(p=o.details)===null||p===void 0)&&p.includes("0 rows"))&&(o=null,u=200,c="OK"),o&&n.shouldThrowOnError)throw new uD(o)}return{error:o,data:l,count:a,status:u,statusText:c}});return this.shouldThrowOnError||(i=i.catch(s=>{var o;let l="",a="",u="";const c=s==null?void 0:s.cause;if(c){var d,f,h,p;const g=(d=c==null?void 0:c.message)!==null&&d!==void 0?d:"",w=(f=c==null?void 0:c.code)!==null&&f!==void 0?f:"";l=`${(h=s==null?void 0:s.name)!==null&&h!==void 0?h:"FetchError"}: ${s==null?void 0:s.message}`,l+=`

Caused by: ${(p=c==null?void 0:c.name)!==null&&p!==void 0?p:"Error"}: ${g}`,w&&(l+=` (${w})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var m;l=(m=s==null?void 0:s.stack)!==null&&m!==void 0?m:""}const v=this.url.toString().length;return(s==null?void 0:s.name)==="AbortError"||(s==null?void 0:s.code)==="ABORT_ERR"?(u="",a="Request was aborted (timeout or manual cancellation)",v>this.urlLengthLimit&&(a+=`. Note: Your request URL is ${v} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((c==null?void 0:c.name)==="HeadersOverflowError"||(c==null?void 0:c.code)==="UND_ERR_HEADERS_OVERFLOW")&&(u="",a="HTTP headers exceeded server limits (typically 16KB)",v>this.urlLengthLimit&&(a+=`. Your request URL is ${v} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:l,hint:a,code:u},data:null,count:null,status:0,statusText:""}})),i.then(t,e)}returns(){return this}overrideTypes(){return this}},dD=class extends cD{select(t){let e=!1;const n=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:r,referencedTable:i=r}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"offset":`${r}.offset`,s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:r=!1,wal:i=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,e?"verbose":null,n?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),a=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${a}"; options=${l};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const s0=new RegExp("[,()]");var Hi=class extends dD{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&s0.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&s0.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},fD=class{constructor(t,{headers:e={},schema:n,fetch:r,urlLengthLimit:i=8e3}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=r,this.urlLengthLimit=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:n=!1,count:r}=e??{},i=n?"HEAD":"GET";let s=!1;const o=(t??"*").split("").map(u=>/\s/.test(u)&&!s?"":(u==='"'&&(s=!s),u)).join(""),{url:l,headers:a}=this.cloneRequestState();return l.searchParams.set("select",o),r&&a.append("Prefer",`count=${r}`),new Hi({method:i,url:l,headers:a,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(t,{count:e,defaultToNull:n=!0}={}){var r;const i="POST",{url:s,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),n||o.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((a,u)=>a.concat(Object.keys(u)),[]);if(l.length>0){const a=[...new Set(l)].map(u=>`"${u}"`);s.searchParams.set("columns",a.join(","))}}return new Hi({method:i,url:s,headers:o,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:r,defaultToNull:i=!0}={}){var s;const o="POST",{url:l,headers:a}=this.cloneRequestState();if(a.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&l.searchParams.set("on_conflict",e),r&&a.append("Prefer",`count=${r}`),i||a.append("Prefer","missing=default"),Array.isArray(t)){const u=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);l.searchParams.set("columns",c.join(","))}}return new Hi({method:o,url:l,headers:a,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}update(t,{count:e}={}){var n;const r="PATCH",{url:i,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new Hi({method:r,url:i,headers:s,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:t}={}){var e;const n="DELETE",{url:r,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new Hi({method:n,url:r,headers:i,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function pl(t){"@babel/helpers - typeof";return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pl(t)}function hD(t,e){if(pl(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(pl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pD(t){var e=hD(t,"string");return pl(e)=="symbol"?e:e+""}function mD(t,e,n){return(e=pD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ba(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?o0(Object(n),!0).forEach(function(r){mD(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o0(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var gD=class Qb{constructor(e,{headers:n={},schema:r,fetch:i,timeout:s,urlLengthLimit:o=8e3}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.urlLengthLimit=o;const l=i??globalThis.fetch;s!==void 0&&s>0?this.fetch=(a,u)=>{const c=new AbortController,d=setTimeout(()=>c.abort(),s),f=u==null?void 0:u.signal;if(f){if(f.aborted)return clearTimeout(d),l(a,u);const h=()=>{clearTimeout(d),c.abort()};return f.addEventListener("abort",h,{once:!0}),l(a,ba(ba({},u),{},{signal:c.signal})).finally(()=>{clearTimeout(d),f.removeEventListener("abort",h)})}return l(a,ba(ba({},u),{},{signal:c.signal})).finally(()=>clearTimeout(d))}:this.fetch=l}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new fD(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new Qb(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,n={},{head:r=!1,get:i=!1,count:s}={}){var o;let l;const a=new URL(`${this.url}/rpc/${e}`);let u;const c=h=>h!==null&&typeof h=="object"&&(!Array.isArray(h)||h.some(c)),d=r&&Object.values(n).some(c);d?(l="POST",u=n):r||i?(l=r?"HEAD":"GET",Object.entries(n).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{a.searchParams.append(h,p)})):(l="POST",u=n);const f=new Headers(this.headers);return d?f.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&f.set("Prefer",`count=${s}`),new Hi({method:l,url:a,headers:f,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}};class yD{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const r=n.versions;if(r&&r.node){const i=r.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const vD="2.97.0",wD=`realtime-js/${vD}`,xD="1.0.0",Zb="2.0.0",l0=Zb,wh=1e4,SD=1e3,bD=100;var lr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(lr||(lr={}));var Le;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Le||(Le={}));var on;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(on||(on={}));var xh;(function(t){t.websocket="websocket"})(xh||(xh={}));var Yr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Yr||(Yr={}));class kD{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,r;const i=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var n,r;const i=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,r){var i,s;const o=e.topic,l=(i=e.ref)!==null&&i!==void 0?i:"",a=(s=e.join_ref)!==null&&s!==void 0?s:"",u=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},d=Object.keys(c).length===0?"":JSON.stringify(c);if(a.length>255)throw new Error(`joinRef length ${a.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+a.length+l.length+o.length+u.length+d.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let p=new DataView(h),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,a.length),p.setUint8(m++,l.length),p.setUint8(m++,o.length),p.setUint8(m++,u.length),p.setUint8(m++,d.length),p.setUint8(m++,n),Array.from(a,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(l,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(o,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(u,g=>p.setUint8(m++,g.charCodeAt(0))),Array.from(d,g=>p.setUint8(m++,g.charCodeAt(0)));var v=new Uint8Array(h.byteLength+r.byteLength);return v.set(new Uint8Array(h),0),v.set(new Uint8Array(r),h.byteLength),v.buffer}decode(e,n){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return n(r)}if(typeof e=="string"){const r=JSON.parse(e),[i,s,o,l,a]=r;return n({join_ref:i,ref:s,topic:o,event:l,payload:a})}return n({})}_binaryDecode(e){const n=new DataView(e),r=n.getUint8(0),i=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,i)}}_decodeUserBroadcast(e,n,r){const i=n.getUint8(1),s=n.getUint8(2),o=n.getUint8(3),l=n.getUint8(4);let a=this.HEADER_LENGTH+4;const u=r.decode(e.slice(a,a+i));a=a+i;const c=r.decode(e.slice(a,a+s));a=a+s;const d=r.decode(e.slice(a,a+o));a=a+o;const f=e.slice(a,e.byteLength),h=l===this.JSON_ENCODING?JSON.parse(r.decode(f)):f,p={type:this.BROADCAST_EVENT,event:c,payload:h};return o>0&&(p.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>n.includes(r)))}}class ek{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ve;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ve||(ve={}));const a0=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((s,o)=>(s[o]=_D(o,t,e,i),s),{}):{}},_D=(t,e,n,r)=>{const i=e.find(l=>l.name===t),s=i==null?void 0:i.type,o=n[t];return s&&!r.includes(s)?tk(s,o):Sh(o)},tk=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return ND(e,n)}switch(t){case ve.bool:return ED(e);case ve.float4:case ve.float8:case ve.int2:case ve.int4:case ve.int8:case ve.numeric:case ve.oid:return CD(e);case ve.json:case ve.jsonb:return TD(e);case ve.timestamp:return OD(e);case ve.abstime:case ve.date:case ve.daterange:case ve.int4range:case ve.int8range:case ve.money:case ve.reltime:case ve.text:case ve.time:case ve.timestamptz:case ve.timetz:case ve.tsrange:case ve.tstzrange:return Sh(e);default:return Sh(e)}},Sh=t=>t,ED=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},CD=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},TD=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},ND=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const o=t.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>tk(e,l))}return t},OD=t=>typeof t=="string"?t.replace(" ","T"):t,nk=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Rd{constructor(e,n,r={},i=wh){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var u0;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(u0||(u0={}));class Do{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Do.syncState(this.state,i,s,o),this.pendingDiffs.forEach(a=>{this.state=Do.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Do.syncDiff(this.state,i,s,o),l())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const s=this.cloneDeep(e),o=this.transformState(n),l={},a={};return this.map(s,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const d=s[u];if(d){const f=c.map(v=>v.presence_ref),h=d.map(v=>v.presence_ref),p=c.filter(v=>h.indexOf(v.presence_ref)<0),m=d.filter(v=>f.indexOf(v.presence_ref)<0);p.length>0&&(l[u]=p),m.length>0&&(a[u]=m)}else l[u]=c}),this.syncDiff(s,{joins:l,leaves:a},r,i)}static syncDiff(e,n,r,i){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const d=e[l].map(h=>h.presence_ref),f=c.filter(h=>d.indexOf(h.presence_ref)<0);e[l].unshift(...f)}r(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[l]=u,i(l,u,a),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var c0;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(c0||(c0={}));var $o;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})($o||($o={}));var Pn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Pn||(Pn={}));class cs{constructor(e,n={config:{}},r){var i,s;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Rd(this,on.join,this.params,this.timeout),this.rejoinTimer=new ek(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Le.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(on.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Do(this),this.broadcastEndpointURL=nk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Le.closed){const{config:{broadcast:o,presence:l,private:a}}=this.params,u=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(h=>h.filter))!==null&&i!==void 0?i:[],c=!!this.bindings[$o.PRESENCE]&&this.bindings[$o.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:c}),postgres_changes:u,private:a};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(h=>e==null?void 0:e(Pn.CHANNEL_ERROR,h)),this._onClose(()=>e==null?void 0:e(Pn.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:h})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){e==null||e(Pn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,g=[];for(let w=0;w<v;w++){const y=m[w],{filter:{event:x,schema:k,table:S,filter:b}}=y,E=h&&h[w];if(E&&E.event===x&&cs.isFilterValueEqual(E.schema,k)&&cs.isFilterValueEqual(E.table,S)&&cs.isFilterValueEqual(E.filter,b))g.push(Object.assign(Object.assign({},y),{id:E.id}));else{this.unsubscribe(),this.state=Le.errored,e==null||e(Pn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Pn.SUBSCRIBED);return}}).receive("error",h=>{this.state=Le.errored,e==null||e(Pn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Pn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Le.joined&&e===$o.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,r)}async httpSend(e,n,r={}){var i;if(n==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=r.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let a=l.statusText;try{const u=await l.json();a=u.error||u.message||a}catch{}return Promise.reject(new Error(a))}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:o}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,a;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Le.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(on.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new Rd(this,on.leave,{},e),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Le.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Rd(this,e,n,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bD){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,s;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=on;if(r&&[l,a,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(h=>{var p,m,v;return((p=h.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(m=h.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(h=>h.callback(f,r)):(s=this.bindings[o])===null||s===void 0||s.filter(h=>{var p,m,v,g,w,y;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const x=h.id,k=(p=h.filter)===null||p===void 0?void 0:p.event;return x&&((m=n.ids)===null||m===void 0?void 0:m.includes(x))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const x=(w=(g=h==null?void 0:h.filter)===null||g===void 0?void 0:g.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return x==="*"||x===((y=n==null?void 0:n.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:m,table:v,commit_timestamp:g,type:w,errors:y}=p;f=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:g,eventType:w,new:{},old:{},errors:y}),this._getPayloadRecords(p))}h.callback(f,r)})}_isClosed(){return this.state===Le.closed}_isJoined(){return this.state===Le.joined}_isJoining(){return this.state===Le.joining}_isLeaving(){return this.state===Le.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&cs.isEqual(i.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(on.close,{},e)}_onError(e){this._on(on.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Le.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=a0(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=a0(e.columns,e.old_record)),n}}const Pd=()=>{},ka={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},MD=[1e3,2e3,5e3,1e4],AD=1e4,ID=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RD{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=wh,this.transport=null,this.heartbeatIntervalMs=ka.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pd,this.ref=0,this.reconnectTimer=null,this.vsn=l0,this.logger=Pd,this.conn=null,this.sendBuffer=[],this.serializer=new kD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${xh.websocket}`,this.httpEndpoint=nk(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=yD.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case lr.connecting:return Yr.Connecting;case lr.open:return Yr.Open;case lr.closing:return Yr.Closing;default:return Yr.Closed}}isConnected(){return this.connectionState()===Yr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new cs(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:i,ref:s}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(SD,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ka.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",u)}catch(c){this.log("error","error in heartbeat callback",c)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:i,payload:s,ref:o}=n,l=o?`(${o})`:"",a=s.status||"";this.log("receive",`${a} ${r} ${i} ${l}`.trim(),s),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(i,s,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===lr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===lr.open||this.conn.readyState===lr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(n){this.log("error","error in heartbeat callback",n)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(on.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([ID],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,r=!1;if(e)n=e,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const s={access_token:n,version:wD};n&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(on.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new ek(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ka.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,i,s,o,l,a,u,c,d,f,h;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:wh,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:ka.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Pd,this.vsn=(a=e==null?void 0:e.vsn)!==null&&a!==void 0?a:l0,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:p=>MD[p-1]||AD,this.vsn){case xD:this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(p,m)=>m(JSON.stringify(p)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:(p,m)=>m(JSON.parse(p));break;case Zb:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var ml=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function PD(t,e,n){const r=new URL(e,t);if(n)for(const[i,s]of Object.entries(n))s!==void 0&&r.searchParams.set(i,s);return r.toString()}async function DD(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function $D(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:i,body:s,headers:o}){const l=PD(t.baseUrl,r,i),a=await DD(t.auth),u=await e(l,{method:n,headers:{...s?{"Content-Type":"application/json"}:{},...a,...o},body:s?JSON.stringify(s):void 0}),c=await u.text(),d=(u.headers.get("content-type")||"").includes("application/json"),f=d&&c?JSON.parse(c):c;if(!u.ok){const h=d?f:void 0,p=h==null?void 0:h.error;throw new ml((p==null?void 0:p.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:h})}return{status:u.status,headers:u.headers,data:f}}}}function _a(t){return t.join("")}var LD=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:_a(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${_a(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${_a(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${_a(t.namespace)}`}),!0}catch(e){if(e instanceof ml&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof ml&&n.status===409)return;throw n}}};function $i(t){return t.join("")}var jD=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$i(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${$i(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${$i(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$i(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$i(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$i(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof ml&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof ml&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},zD=class{constructor(t){var r;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=$D({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(r=t.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new LD(this.client,e),this.tableOps=new jD(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Ic=class extends Error{constructor(t,e="storage",n,r){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=r}};function Rc(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Ea=class extends Ic{constructor(t,e,n,r="storage"){super(t,r,e,n),this.name=r==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},rk=class extends Ic{constructor(t,e,n="storage"){super(t,n),this.name=n==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const BD=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),FD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},bh=t=>{if(Array.isArray(t))return t.map(n=>bh(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=bh(r)}),e},VD=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function gl(t){"@babel/helpers - typeof";return gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gl(t)}function UD(t,e){if(gl(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(gl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HD(t){var e=UD(t,"string");return gl(e)=="symbol"?e:e+""}function WD(t,e,n){return(e=HD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ne(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?d0(Object(n),!0).forEach(function(r){WD(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d0(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const f0=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},qD=async(t,e,n,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const i=t,s=i.status||500;if(typeof i.json=="function")i.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||s+"";e(new Ea(f0(o),s,l,r))}).catch(()=>{if(r==="vectors"){const o=s+"";e(new Ea(i.statusText||`HTTP ${s} error`,s,o,r))}else{const o=s+"";e(new Ea(i.statusText||`HTTP ${s} error`,s,o,r))}});else{const o=s+"";e(new Ea(i.statusText||`HTTP ${s} error`,s,o,r))}}else e(new rk(f0(t),t,r))},KD=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||t==="HEAD"||!r?ne(ne({},i),n):(FD(r)?(i.headers=ne({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(r)):i.body=r,e!=null&&e.duplex&&(i.duplex=e.duplex),ne(ne({},i),n))};async function fo(t,e,n,r,i,s,o){return new Promise((l,a)=>{t(n,KD(e,r,i,s)).then(u=>{if(!u.ok)throw u;if(r!=null&&r.noResolveJson)return u;if(o==="vectors"){const c=u.headers.get("content-type");if(u.headers.get("content-length")==="0"||u.status===204)return{};if(!c||!c.includes("application/json"))return{}}return u.json()}).then(u=>l(u)).catch(u=>qD(u,a,r,o))})}function ik(t="storage"){return{get:async(e,n,r,i)=>fo(e,"GET",n,r,i,void 0,t),post:async(e,n,r,i,s)=>fo(e,"POST",n,i,s,r,t),put:async(e,n,r,i,s)=>fo(e,"PUT",n,i,s,r,t),head:async(e,n,r,i)=>fo(e,"HEAD",n,ne(ne({},r),{},{noResolveJson:!0}),i,void 0,t),remove:async(e,n,r,i,s)=>fo(e,"DELETE",n,i,s,r,t)}}const JD=ik("storage"),{get:yl,post:nn,put:kh,head:GD,remove:am}=JD,It=ik("vectors");var Js=class{constructor(t,e={},n,r="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=BD(n),this.namespace=r}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=ne(ne({},this.headers),{},{[t]:e}),this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Rc(n))return{data:null,error:n};throw n}}},YD=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Rc(e))return{data:null,error:e};throw e}}};let sk;sk=Symbol.toStringTag;var XD=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[sk]="BlobDownloadBuilder",this.promise=null}asStream(){return new YD(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Rc(e))return{data:null,error:e};throw e}}};const QD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},h0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ZD=class extends Js{constructor(t,e={},n,r){super(t,e,r,"storage"),this.bucketId=n}async uploadOrUpdate(t,e,n,r){var i=this;return i.handleOperation(async()=>{let s;const o=ne(ne({},h0),r);let l=ne(ne({},i.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const a=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",i.encodeMetadata(a)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",o.cacheControl),a&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(a))):(s=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,a&&(l["x-metadata"]=i.toBase64(i.encodeMetadata(a))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!o.duplex&&(o.duplex="half")),r!=null&&r.headers&&(l=ne(ne({},l),r.headers));const u=i._removeEmptyFolders(e),c=i._getFinalPath(u),d=await(t=="PUT"?kh:nn)(i.fetch,`${i.url}/object/${c}`,s,ne({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{path:u,id:d.Id,fullPath:d.Key}})}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,r){var i=this;const s=i._removeEmptyFolders(t),o=i._getFinalPath(s),l=new URL(i.url+`/object/upload/sign/${o}`);return l.searchParams.set("token",e),i.handleOperation(async()=>{let a;const u=ne({upsert:h0.upsert},r),c=ne(ne({},i.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",u.cacheControl)):(a=n,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType),{path:s,fullPath:(await kh(i.fetch,l.toString(),a,{headers:c})).Key}})}async createSignedUploadUrl(t,e){var n=this;return n.handleOperation(async()=>{let r=n._getFinalPath(t);const i=ne({},n.headers);e!=null&&e.upsert&&(i["x-upsert"]="true");const s=await nn(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(n.url+s.url),l=o.searchParams.get("token");if(!l)throw new Ic("No token returned by API");return{signedUrl:o.toString(),path:t,token:l}})}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var r=this;return r.handleOperation(async()=>await nn(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers}))}async copy(t,e,n){var r=this;return r.handleOperation(async()=>({path:(await nn(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers})).Key}))}async createSignedUrl(t,e,n){var r=this;return r.handleOperation(async()=>{let i=r._getFinalPath(t),s=await nn(r.fetch,`${r.url}/object/sign/${i}`,ne({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:r.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{signedUrl:encodeURI(`${r.url}${s.signedURL}${o}`)}})}async createSignedUrls(t,e,n){var r=this;return r.handleOperation(async()=>{const i=await nn(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i.map(o=>ne(ne({},o),{},{signedUrl:o.signedURL?encodeURI(`${r.url}${o.signedURL}${s}`):null}))})}download(t,e,n){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),s=i?`?${i}`:"",o=this._getFinalPath(t),l=()=>yl(this.fetch,`${this.url}/${r}/${o}${s}`,{headers:this.headers,noResolveJson:!0},n);return new XD(l,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);return e.handleOperation(async()=>bh(await yl(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})))}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await GD(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Rc(r)&&r instanceof rk){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}}getPublicUrl(t,e){const n=this._getFinalPath(t),r=[],i=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";i!==""&&r.push(i);const s=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&r.push(o);let l=r.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${n}${l}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await am(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,n){var r=this;return r.handleOperation(async()=>{const i=ne(ne(ne({},QD),e),{},{prefix:t||""});return await nn(r.fetch,`${r.url}/object/list/${r.bucketId}`,i,{headers:r.headers},n)})}async listV2(t,e){var n=this;return n.handleOperation(async()=>{const r=ne({},t);return await nn(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const e2="2.97.0",Ul={"X-Client-Info":`storage-js/${e2}`};var t2=class extends Js{constructor(t,e={},n,r){const i=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),o=ne(ne({},Ul),e);super(s,o,n,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=e.listBucketOptionsToQueryString(t);return await yl(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await yl(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var n=this;return n.handleOperation(async()=>await nn(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async updateBucket(t,e){var n=this;return n.handleOperation(async()=>await kh(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await nn(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await am(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},n2=class extends Js{constructor(t,e={},n){const r=t.replace(/\/$/,""),i=ne(ne({},Ul),e);super(r,i,n,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await nn(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const r=n.toString(),i=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return await yl(e.fetch,i,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await am(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!VD(t))throw new Ic("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new zD({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(i,s){const o=i[s];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(i,l),error:null}}catch(a){if(r)throw a;return{data:null,error:a}}}}})}},r2=class extends Js{constructor(t,e={},n){const r=t.replace(/\/$/,""),i=ne(ne({},Ul),{},{"Content-Type":"application/json"},e);super(r,i,n,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var n=this;return n.handleOperation(async()=>await It.post(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var n=this;return n.handleOperation(async()=>await It.post(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{})}},i2=class extends Js{constructor(t,e={},n){const r=t.replace(/\/$/,""),i=ne(ne({},Ul),{},{"Content-Type":"application/json"},e);super(r,i,n,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},s2=class extends Js{constructor(t,e={},n){const r=t.replace(/\/$/,""),i=ne(ne({},Ul),{},{"Content-Type":"application/json"},e);super(r,i,n,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await It.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},o2=class extends s2{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new l2(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},l2=class extends r2{constructor(t,e,n,r){super(t,e,r),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,ne(ne({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,ne(ne({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new a2(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},a2=class extends i2{constructor(t,e,n,r,i){super(t,e,i),this.vectorBucketName=n,this.indexName=r}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,ne(ne({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,ne(ne({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,ne(ne({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,ne(ne({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,ne(ne({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},u2=class extends t2{constructor(t,e={},n,r){super(t,e,n,r)}from(t){return new ZD(this.url,this.headers,t,this.fetch)}get vectors(){return new o2(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new n2(this.url+"/iceberg",this.headers,this.fetch)}};const ok="2.97.0",Wi=30*1e3,_h=3,Dd=_h*Wi,c2="http://localhost:9999",d2="supabase.auth.token",f2={"X-Client-Info":`gotrue-js/${ok}`},Eh="X-Supabase-Api-Version",lk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},h2=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,p2=10*60*1e3;class vl extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function G(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class m2 extends vl{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function g2(t){return G(t)&&t.name==="AuthApiError"}class Xr extends vl{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Zn extends vl{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class Ot extends Zn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $d(t){return G(t)&&t.name==="AuthSessionMissingError"}class Li extends Zn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ca extends Zn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ta extends Zn{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function y2(t){return G(t)&&t.name==="AuthImplicitGrantRedirectError"}class p0 extends Zn{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class v2 extends Zn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ch extends Zn{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Ld(t){return G(t)&&t.name==="AuthRetryableFetchError"}class m0 extends Zn{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Th extends Zn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const zu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),g0=` 	
\r=`.split(""),w2=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<g0.length;e+=1)t[g0[e].charCodeAt(0)]=-2;for(let e=0;e<zu.length;e+=1)t[zu[e].charCodeAt(0)]=e;return t})();function y0(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(zu[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(zu[r]),e.queuedBits-=6}}function ak(t,e,n){const r=w2[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function v0(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{b2(o,r,n)};for(let o=0;o<t.length;o+=1)ak(t.charCodeAt(o),i,s);return e.join("")}function x2(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function S2(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}x2(r,e)}}function b2(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Ss(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)ak(t.charCodeAt(i),n,r);return new Uint8Array(e)}function k2(t){const e=[];return S2(t,n=>e.push(n)),new Uint8Array(e)}function ii(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};return t.forEach(i=>y0(i,n,r)),y0(null,n,r),e.join("")}function _2(t){return Math.round(Date.now()/1e3)+t}function E2(){return Symbol("auth-callback")}const Ye=()=>typeof window<"u"&&typeof document<"u",Hr={tested:!1,writable:!1},uk=()=>{if(!Ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Hr.tested)return Hr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Hr.tested=!0,Hr.writable=!0}catch{Hr.tested=!0,Hr.writable=!1}return Hr.writable};function C2(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const ck=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),T2=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",qi=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Wr=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Je=async(t,e)=>{await t.removeItem(e)};class Pc{constructor(){this.promise=new Pc.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Pc.promiseConstructor=Promise;function Na(t){const e=t.split(".");if(e.length!==3)throw new Th("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!h2.test(e[r]))throw new Th("JWT not in base64url format");return{header:JSON.parse(v0(e[0])),payload:JSON.parse(v0(e[1])),signature:Ss(e[2]),raw:{header:e[0],payload:e[1]}}}async function N2(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function O2(t,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){r(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function M2(t){return("0"+t.toString(16)).substr(-2)}function A2(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,M2).join("")}async function I2(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function R2(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await I2(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ji(t,e,n=!1){const r=A2();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await qi(t,`${e}-code-verifier`,i);const s=await R2(r);return[s,r===s?"plain":"s256"]}const P2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function D2(t){const e=t.headers.get(Eh);if(!e||!e.match(P2))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function $2(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function L2(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const j2=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function zi(t){if(!j2.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function jd(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function z2(t,e){return new Proxy(t,{get:(n,r,i)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,i)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,r,i)}})}function w0(t){return JSON.parse(JSON.stringify(t))}const Gr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),B2=[502,503,504];async function x0(t){var e;if(!T2(t))throw new Ch(Gr(t),0);if(B2.includes(t.status))throw new Ch(Gr(t),t.status);let n;try{n=await t.json()}catch(s){throw new Xr(Gr(s),s)}let r;const i=D2(t);if(i&&i.getTime()>=lk["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new m0(Gr(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ot}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new m0(Gr(n),t.status,n.weak_password.reasons);throw new m2(Gr(n),t.status||500,r)}const F2=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function ie(t,e,n,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[Eh]||(s[Eh]=lk["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const o=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await V2(t,e,n+l,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(a):{data:Object.assign({},a),error:null}}async function V2(t,e,n,r,i,s){const o=F2(e,r,i,s);let l;try{l=await t(n,Object.assign({},o))}catch(a){throw console.error(a),new Ch(Gr(a),0)}if(l.ok||await x0(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(a){await x0(a)}}function en(t){var e;let n=null;W2(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=_2(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function S0(t){const e=en(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function hr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function U2(t){return{data:t,error:null}}function H2(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=t,o=Ac(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function b0(t){return t}function W2(t){return t.access_token&&t.refresh_token&&t.expires_in}const zd=["global","local","others"];class q2{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=ck(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=zd[0]){if(zd.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${zd.join(", ")}`);try{return await ie(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:hr})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Ac(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:H2,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(G(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:hr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:b0});if(c.error)throw c.error;const d=await c.json(),f=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return h.length>0&&(h.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);u[`${v}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(G(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){zi(e);try{return await ie(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:hr})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){zi(e);try{return await ie(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:hr})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){zi(e);try{return await ie(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:hr})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){zi(e.userId);try{const{data:n,error:r}=await ie(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(G(n))return{data:null,error:n};throw n}}async _deleteFactor(e){zi(e.userId),zi(e.id);try{return{data:await ie(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,i,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await ie(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:b0});if(c.error)throw c.error;const d=await c.json(),f=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return h.length>0&&(h.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);u[`${v}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(G(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(G(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ie(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(G(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await ie(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await ie(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ie(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(G(n))return{data:null,error:n};throw n}}}function k0(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Bi={debug:!!(globalThis&&uk()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class dk extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class _0 extends dk{}async function K2(t,e,n){Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;e>0&&setTimeout(()=>{r.abort(),Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve();try{return await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new _0(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Bi.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}catch(i){throw(i==null?void 0:i.name)==="AbortError"?new _0(`Acquiring an exclusive Navigator LockManager lock "${t}" timed out waiting ${e}ms`):i}}function J2(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function fk(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function G2(t){return parseInt(t,16)}function Y2(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function X2(t){var e;const{chainId:n,domain:r,expirationTime:i,issuedAt:s=new Date,nonce:o,notBefore:l,requestId:a,resources:u,scheme:c,uri:d,version:f}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const h=fk(t.address),p=c?`${c}://${r}`:r,m=t.statement?`${t.statement}
`:"",v=`${p} wants you to sign in with your Ethereum account:
${h}

${m}`;let g=`URI: ${d}
Version: ${f}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${s.toISOString()}`;if(i&&(g+=`
Expiration Time: ${i.toISOString()}`),l&&(g+=`
Not Before: ${l.toISOString()}`),a&&(g+=`
Request ID: ${a}`),u){let w=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);w+=`
- ${y}`}g+=w}return`${v}
${g}`}class Re extends Error{constructor({message:e,code:n,cause:r,name:i}){var s;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(s=i??(r instanceof Error?r.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=n}}class Bu extends Re{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function Q2({error:t,options:e}){var n,r,i;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Re({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Re({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=s.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Re({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Re({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Re({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Re({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Re({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Re({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(hk(o)){if(s.rp.id!==o)return new Re({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Re({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Re({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Re({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Re({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Z2({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Re({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Re({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(hk(r)){if(n.rpId!==r)return new Re({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Re({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Re({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Re({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class e${createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const t$=new e$;function n$(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,i=Ac(t,["challenge","user","excludeCredentials"]),s=Ss(e).buffer,o=Object.assign(Object.assign({},n),{id:Ss(n.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:s,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const u=r[a];l.excludeCredentials[a]=Object.assign(Object.assign({},u),{id:Ss(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function r$(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=Ac(t,["challenge","allowCredentials"]),i=Ss(e).buffer,s=Object.assign(Object.assign({},r),{challenge:i});if(n&&n.length>0){s.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const l=n[o];s.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Ss(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function i$(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:ii(new Uint8Array(t.response.attestationObject)),clientDataJSON:ii(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function s$(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),i=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ii(new Uint8Array(i.authenticatorData)),clientDataJSON:ii(new Uint8Array(i.clientDataJSON)),signature:ii(new Uint8Array(i.signature)),userHandle:i.userHandle?ii(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function hk(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function E0(){var t,e;return!!(Ye()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function o$(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Bu("Browser returned unexpected credential type",e)}:{data:null,error:new Bu("Empty credential response",e)}}catch(e){return{data:null,error:Q2({error:e,options:t})}}}async function l$(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Bu("Browser returned unexpected credential type",e)}:{data:null,error:new Bu("Empty credential response",e)}}catch(e){return{data:null,error:Z2({error:e,options:t})}}}const a$={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},u$={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Fu(...t){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),n=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),r={};for(const i of t)if(i)for(const s in i){const o=i[s];if(o!==void 0)if(Array.isArray(o))r[s]=o;else if(n(o))r[s]=o;else if(e(o)){const l=r[s];e(l)?r[s]=Fu(l,o):r[s]=Fu(o)}else r[s]=o}return r}function c$(t,e){return Fu(a$,t,e||{})}function d$(t,e){return Fu(u$,t,e||{})}class f${constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:i},s){var o;try{const{data:l,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!l)return{data:null,error:a};const u=i??t$.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;if(!c.name){const d=r;if(d)c.name=`${c.id}:${d}`;else{const h=(await this.client.getUser()).data.user,p=((o=h==null?void 0:h.user_metadata)===null||o===void 0?void 0:o.name)||(h==null?void 0:h.email)||(h==null?void 0:h.id)||"User";c.name=`${c.id}:${p}`}}c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=c$(l.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:d,error:f}=await o$({publicKey:c,signal:u});return d?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const c=d$(l.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:d,error:f}=await l$(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:u}));return d?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(l){return G(l)?{data:null,error:l}:{data:null,error:new Xr("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!n)return{data:null,error:new vl("rpId is required for WebAuthn authentication")};try{if(!E0())return{data:null,error:new Xr("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:i},{request:s});if(!o)return{data:null,error:l};const{webauthn:a}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:a.type,rpId:n,rpOrigins:r,credential_response:a.credential_response}})}catch(o){return G(o)?{data:null,error:o}:{data:null,error:new Xr("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!n)return{data:null,error:new vl("rpId is required for WebAuthn registration")};try{if(!E0())return{data:null,error:new Xr("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(c=>{var d;return(d=c.data)===null||d===void 0?void 0:d.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(c=>c?this.client.mfa.unenroll({factorId:c==null?void 0:c.id}):void 0),{data:null,error:l};const{data:a,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:i},{create:s});return a?this._verify({factorId:o.id,challengeId:a.challengeId,webauthn:{rpId:n,rpOrigins:r,type:a.webauthn.type,credential_response:a.webauthn.credential_response}}):{data:null,error:u}}catch(o){return G(o)?{data:null,error:o}:{data:null,error:new Xr("Unexpected error in register",o)}}}}J2();const h$={url:c2,storageKey:d2,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:f2,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function C0(t,e,n){return await n()}const Fi={};class wl{get jwks(){var e,n;return(n=(e=Fi[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Fi[this.storageKey]=Object.assign(Object.assign({},Fi[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Fi[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Fi[this.storageKey]=Object.assign(Object.assign({},Fi[this.storageKey]),{cachedAt:e})}constructor(e){var n,r,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},h$),e);if(this.storageKey=s.storageKey,this.instanceID=(n=wl.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,wl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&Ye()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new q2({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=ck(s.fetch),this.lock=s.lock||C0,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&Ye()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=K2:this.lock=C0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new f$(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:uk()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=k0(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=k0(this.memoryStorage)),Ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(l){this._debug("#broadcastChannel","error",l)}})}s.skipAutoInitialize||this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${ok}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},r="none";if(Ye()&&(n=C2(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),Ye()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),y2(s)){const a=(e=s.details)===null||e===void 0?void 0:e.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return G(n)?this._returnResult({error:n}):this._returnResult({error:new Xr("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const s=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:en}),{data:o,error:l}=s;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:u,session:a},error:null})}catch(s){if(G(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var n,r,i;try{let s;if("email"in e){const{email:c,password:d,options:f}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await ji(this.storage,this.storageKey)),s=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:p},xform:en})}else if("phone"in e){const{phone:c,password:d,options:f}=e;s=await ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:en})}else throw new Ca("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return await Je(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),this._returnResult({data:{user:u,session:a},error:null})}catch(s){if(await Je(this.storage,`${this.storageKey}-code-verifier`),G(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:o,options:l}=e;n=await ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:S0})}else if("phone"in e){const{phone:s,password:o,options:l}=e;n=await ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:S0})}else throw new Ca("You must provide either an email or phone number and a password");const{data:r,error:i}=n;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!r||!r.session||!r.user){const s=new Li;return this._returnResult({data:{user:null,session:null},error:s})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,i,s,o,l,a,u,c,d,f;let h,p;if("message"in e)h=e.message,p=e.signature;else{const{chain:m,wallet:v,statement:g,options:w}=e;let y;if(Ye())if(typeof v=="object")y=v;else{const O=window;if("ethereum"in O&&typeof O.ethereum=="object"&&"request"in O.ethereum&&typeof O.ethereum.request=="function")y=O.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=v}const x=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href),k=await y.request({method:"eth_requestAccounts"}).then(O=>O).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=fk(k[0]);let b=(r=w==null?void 0:w.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!b){const O=await y.request({method:"eth_chainId"});b=G2(O)}const E={domain:x.host,address:S,statement:g,uri:x.href,version:"1",chainId:b,nonce:(i=w==null?void 0:w.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.resources};h=X2(E),p=await y.request({method:"personal_sign",params:[Y2(h),S]})}try{const{data:m,error:v}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:p},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:en});if(v)throw v;if(!m||!m.session||!m.user){const g=new Li;return this._returnResult({data:{user:null,session:null},error:g})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:v})}catch(m){if(G(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var n,r,i,s,o,l,a,u,c,d,f,h;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:v,wallet:g,statement:w,options:y}=e;let x;if(Ye())if(typeof g=="object")x=g;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))x=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=g}const k=new URL((n=y==null?void 0:y.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in x&&x.signIn){const S=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let b;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")b=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)b=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in b&&"signature"in b&&(typeof b.signedMessage=="string"||b.signedMessage instanceof Uint8Array)&&b.signature instanceof Uint8Array)p=typeof b.signedMessage=="string"?b.signedMessage:new TextDecoder().decode(b.signedMessage),m=b.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${k.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(i=(r=y==null?void 0:y.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((d=(c=y==null?void 0:y.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||d===void 0)&&d.length?["Resources",...y.signInWithSolana.resources.map(b=>`- ${b}`)]:[]].join(`
`);const S=await x.signMessage(new TextEncoder().encode(p),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=S}}try{const{data:v,error:g}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ii(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:en});if(g)throw g;if(!v||!v.session||!v.user){const w=new Li;return this._returnResult({data:{user:null,session:null},error:w})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:g})}catch(v){if(G(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(e){const n=await Wr(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new v2;const{data:s,error:o}=await ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:en});if(await Je(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!s||!s.session||!s.user){const l=new Li;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(await Je(this.storage,`${this.storageKey}-code-verifier`),G(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:s,nonce:o}=e,l=await ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:en}),{data:a,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!a||!a.session||!a.user){const c=new Li;return this._returnResult({data:{user:null,session:null},error:c})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:a,error:u})}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,r,i,s,o;try{if("email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await ji(this.storage,this.storageKey));const{error:d}=await ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=a==null?void 0:a.data)!==null&&n!==void 0?n:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c})}throw new Ca("You must provide either an email or phone number.")}catch(l){if(await Je(this.storage,`${this.storageKey}-code-verifier`),G(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var n,r;try{let i,s;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:en});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),this._returnResult({data:{user:u,session:a},error:null})}catch(i){if(G(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var n,r,i,s,o;try{let l=null,a=null;this.flowType==="pkce"&&([l,a]=await ji(this.storage,this.storageKey));const u=await ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:a}),headers:this.headers,xform:U2});return!((s=u.data)===null||s===void 0)&&s.url&&Ye()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await Je(this.storage,`${this.storageKey}-code-verifier`),G(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ot;const{error:i}=await ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(G(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:o}=await ie(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:o,error:l}=await ie(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Ca("You must provide either an email or phone number and a type")}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Wr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Dd:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Wr(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=jd()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=z2(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:hr}):await this._useSession(async n=>{var r,i,s;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ot}:await ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:hr})})}catch(n){if(G(n))return $d(n)&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new Ot;const o=i.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await ji(this.storage,this.storageKey));const{data:u,error:c}=await ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:hr});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(await Je(this.storage,`${this.storageKey}-code-verifier`),G(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ot;const n=Date.now()/1e3;let r=n,i=!0,s=null;const{payload:o}=Na(e.access_token);if(o.exp&&(r=o.exp,i=r<=n),i){const{data:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(n){if(G(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ot;const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Ye())throw new Ta("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ta(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new p0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ta("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new p0("No code detected.");const{data:w,error:y}=await this._exchangeCodeForSession(e.code);if(y)throw y;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=e;if(!s||!l||!o||!u)throw new Ta("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(l);let f=c+d;a&&(f=parseInt(a));const h=f-c;h*1e3<=Wi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const p=f-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,c);const{data:m,error:v}=await this._getUser(s);if(v)throw v;const g={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:f,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(r){if(G(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Wr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s&&!$d(s))return this._returnResult({error:s});const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(g2(l)&&(l.status===404||l.status===401||l.status===403)||$d(l)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=E2(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await ji(this.storage,this.storageKey,!0));try{return await ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(await Je(this.storage,`${this.storageKey}-code-verifier`),G(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var o,l,a,u,c;const{data:d,error:f}=s;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await ie(this.fetch,"GET",h,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return Ye()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(G(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:i,data:{session:s}}=n;if(i)throw i;const{options:o,provider:l,token:a,access_token:u,nonce:c}=e,d=await ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=s==null?void 0:s.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:a,access_token:u,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:en}),{data:f,error:h}=d;return h?this._returnResult({data:{user:null,session:null},error:h}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Li}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:h}))}catch(i){if(await Je(this.storage,`${this.storageKey}-code-verifier`),G(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)throw o;return await ie(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await O2(async i=>(i>0&&await N2(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:en})),(i,s)=>{const o=200*Math.pow(2,i);return s&&Ld(s)&&Date.now()+o-r<Wi})}catch(r){if(this._debug(n,"error",r),G(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Ye()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await Wr(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Wr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await qi(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:jd()}else if(i&&!i.user&&!i.user){const o=await Wr(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Je(this.storage,this.storageKey+"-user"),await qi(this.storage,this.storageKey,i)):i.user=jd()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const s=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Dd;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Dd}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Ld(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ot;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Pc;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new Ot;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={data:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),G(s)){const o={data:null,error:s};return Ld(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(a){s.push(a)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Je(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await qi(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const s=w0(i);await qi(this.storage,this.storageKey,s)}else{const i=w0(n);await qi(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Je(this.storage,this.storageKey),await Je(this.storage,this.storageKey+"-code-verifier"),await Je(this.storage,this.storageKey+"-user"),this.userStorage&&await Je(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ye()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Wi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/Wi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Wi}ms, refresh threshold is ${_h} ticks`),i<=_h&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof dk)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ye()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,o]=await ji(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?this._returnResult({data:null,error:s}):await ie(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:a,error:u}=await ie(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&a.type==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),this._returnResult({data:a,error:null}))})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?i$(e.webauthn.credential_response):s$(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:a}=await ie(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?this._returnResult({data:null,error:a}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:a}))})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return this._returnResult({data:null,error:s});const o=await ie(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:n$(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:r$(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(e){var n,r,i,s;if(e)try{const{payload:h}=Na(e);let p=null;h.aal&&(p=h.aal);let m=p;const{data:{user:v},error:g}=await this.getUser(e);if(g)return this._returnResult({data:null,error:g});((r=(n=v==null?void 0:v.factors)===null||n===void 0?void 0:n.filter(x=>x.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(m="aal2");const y=h.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:y},error:null}}catch(h){if(G(h))return this._returnResult({data:null,error:h});throw h}const{data:{session:o},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Na(o.access_token);let u=null;a.aal&&(u=a.aal);let c=u;((s=(i=o.user.factors)===null||i===void 0?void 0:i.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const f=a.amr||[];return{data:{currentLevel:u,nextLevel:c,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:r},error:i}=n;return i?this._returnResult({data:null,error:i}):r?await ie(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ot})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:i},error:s}=r;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Ot});const o=await ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ye()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(G(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:i},error:s}=r;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Ot});const o=await ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ye()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(G(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;return r?this._returnResult({data:null,error:r}):n?await ie(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ot})})}catch(e){if(G(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:r},error:i}=n;return i?this._returnResult({data:null,error:i}):r?(await ie(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ot})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+p2>i)return r;const{data:s,error:o}=await ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,r=s.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:h,error:p}=await this.getSession();if(p||!h.session)return this._returnResult({data:null,error:p});r=h.session.access_token}const{header:i,payload:s,signature:o,raw:{header:l,payload:a}}=Na(r);n!=null&&n.allowExpired||$2(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:h}=await this.getUser(r);if(h)throw h;return{data:{claims:s,header:i,signature:o},error:null}}const c=L2(i.alg),d=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,o,k2(`${l}.${a}`)))throw new Th("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(r){if(G(r))return this._returnResult({data:null,error:r});throw r}}}wl.nextInstanceID={};const p$=wl,m$="2.97.0";let xo="";typeof Deno<"u"?xo="deno":typeof document<"u"?xo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xo="react-native":xo="node";const g$={"X-Client-Info":`supabase-js-${xo}/${m$}`},y$={headers:g$},v$={schema:"public"},w$={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},x$={};function xl(t){"@babel/helpers - typeof";return xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xl(t)}function S$(t,e){if(xl(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(xl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b$(t){var e=S$(t,"string");return xl(e)=="symbol"?e:e+""}function k$(t,e,n){return(e=b$(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?T0(Object(n),!0).forEach(function(r){k$(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T0(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const _$=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),E$=()=>Headers,C$=(t,e,n)=>{const r=_$(n),i=E$();return async(s,o)=>{var l;const a=(l=await e())!==null&&l!==void 0?l:t;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),r(s,Oe(Oe({},o),{},{headers:u}))}};function T$(t){return t.endsWith("/")?t:t+"/"}function N$(t,e){var n,r;const{db:i,auth:s,realtime:o,global:l}=t,{db:a,auth:u,realtime:c,global:d}=e,f={db:Oe(Oe({},a),i),auth:Oe(Oe({},u),s),realtime:Oe(Oe({},c),o),storage:{},global:Oe(Oe(Oe({},d),l),{},{headers:Oe(Oe({},(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function O$(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(T$(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var M$=class extends p${constructor(t){super(t)}},A$=class{constructor(t,e,n){var r,i;this.supabaseUrl=t,this.supabaseKey=e;const s=O$(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const o=`sb-${s.hostname.split(".")[0]}-auth-token`,l={db:v$,realtime:x$,auth:Oe(Oe({},w$),{},{storageKey:o}),global:y$},a=N$(n??{},l);if(this.storageKey=(r=a.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(i=a.global.headers)!==null&&i!==void 0?i:{},a.accessToken)this.accessToken=a.accessToken,this.auth=new Proxy({},{get:(c,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=a.auth)!==null&&u!==void 0?u:{},this.headers,a.global.fetch)}this.fetch=C$(e,this._getAccessToken.bind(this),a.global.fetch),this.realtime=this._initRealtimeClient(Oe({headers:this.headers,accessToken:this._getAccessToken.bind(this)},a.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(c=>this.realtime.setAuth(c)).catch(c=>console.warn("Failed to set initial Realtime auth token:",c)),this.rest=new gD(new URL("rest/v1",s).href,{headers:this.headers,schema:a.db.schema,fetch:this.fetch,timeout:a.db.timeout,urlLengthLimit:a.db.urlLengthLimit}),this.storage=new u2(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),a.accessToken||this._listenForAuthEvents()}get functions(){return new aD(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:r}=await t.auth.getSession();return(e=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:i,storageKey:s,flowType:o,lock:l,debug:a,throwOnError:u},c,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M$({url:this.authUrl.href,headers:Oe(Oe({},f),c),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:i,flowType:o,lock:l,debug:a,throwOnError:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new RD(this.realtimeUrl.href,Oe(Oe({},t),{},{params:Oe(Oe({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const I$=(t,e,n)=>new A$(t,e,n);function R$(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const n=e.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}R$()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");console.warn(`Supabase credentials not configured. Copy .env.example to .env and fill in your credentials.
Save/Load functionality will not work until configured.`);const Lo=I$("https://placeholder.supabase.co","placeholder-key"),Bd=50,N0="root-"+yh().slice(0,8),P$=[{id:N0,type:"mindmap",position:{x:350,y:250},data:{title:"Central Topic",key:N0,level:0,content:""}}],Gs=eD((t,e)=>({nodes:P$,edges:[],selectedNodeId:null,currentMapId:null,currentMapName:"Untitled Map",isDirty:!1,saveStatus:"idle",past:[],future:[],isMapListOpen:!1,autosaveTimer:null,onNodesChange:n=>{t(i=>({nodes:Sb(n,i.nodes),isDirty:!0})),n.some(i=>i.type!=="select")&&e().scheduleAutosave()},onEdgesChange:n=>{t(r=>({edges:bb(n,r.edges),isDirty:!0})),e().scheduleAutosave()},onConnect:n=>{e().pushHistory(),t(r=>({edges:YS({...n,type:"smoothstep",style:{stroke:"#94a3b8",strokeWidth:2},animated:!1},r.edges),isDirty:!0})),e().scheduleAutosave()},addNode:({position:n,level:r=1,title:i="New Node"})=>{e().pushHistory();const s=yh(),o={id:s,type:"mindmap",position:n,data:{title:i,key:s,level:r,content:""}};return t(l=>({nodes:[...l.nodes,o],isDirty:!0})),e().scheduleAutosave(),o},updateNodeData:(n,r)=>{t(i=>({nodes:i.nodes.map(s=>s.id===n?{...s,data:{...s.data,...r}}:s),isDirty:!0})),e().scheduleAutosave()},deleteNode:n=>{e().pushHistory(),t(r=>({nodes:r.nodes.filter(i=>i.id!==n),edges:r.edges.filter(i=>i.source!==n&&i.target!==n),selectedNodeId:r.selectedNodeId===n?null:r.selectedNodeId,isDirty:!0})),e().scheduleAutosave()},selectNode:n=>{t({selectedNodeId:n})},deselectNode:()=>{t({selectedNodeId:null})},pushHistory:()=>{const{nodes:n,edges:r,past:i}=e(),s={nodes:JSON.parse(JSON.stringify(n)),edges:JSON.parse(JSON.stringify(r))};t({past:[...i,s].slice(-Bd),future:[]})},undo:()=>{const{nodes:n,edges:r,past:i,future:s}=e();if(i.length===0)return;const o=i[i.length-1],l={nodes:JSON.parse(JSON.stringify(n)),edges:JSON.parse(JSON.stringify(r))};t({nodes:o.nodes,edges:o.edges,past:i.slice(0,-1),future:[l,...s].slice(0,Bd),isDirty:!0})},redo:()=>{const{nodes:n,edges:r,past:i,future:s}=e();if(s.length===0)return;const o=s[0],l={nodes:JSON.parse(JSON.stringify(n)),edges:JSON.parse(JSON.stringify(r))};t({nodes:o.nodes,edges:o.edges,past:[...i,l].slice(-Bd),future:s.slice(1),isDirty:!0})},scheduleAutosave:()=>{const n=e();if(n.autosaveTimer&&clearTimeout(n.autosaveTimer),!n.currentMapId)return;const r=setTimeout(()=>{e().saveMap()},2e3);t({autosaveTimer:r})},saveMap:async n=>{const{nodes:r,edges:i,currentMapId:s,currentMapName:o}=e(),l=n||o,a={nodes:r,edges:i};t({saveStatus:"saving"});try{if(s){const{error:u}=await Lo.from("maps").update({name:l,data:a}).eq("id",s);if(u)throw u}else{const{data:u,error:c}=await Lo.from("maps").insert({name:l,data:a}).select().single();if(c)throw c;t({currentMapId:u.id})}return t({isDirty:!1,currentMapName:l,saveStatus:"saved"}),setTimeout(()=>t({saveStatus:"idle"}),2e3),{success:!0}}catch(u){return console.error("Save failed:",u),t({saveStatus:"error"}),setTimeout(()=>t({saveStatus:"idle"}),3e3),{success:!1,error:u}}},loadMap:async n=>{try{const{data:r,error:i}=await Lo.from("maps").select("*").eq("id",n).single();if(i)throw i;return t({nodes:r.data.nodes||[],edges:r.data.edges||[],currentMapId:r.id,currentMapName:r.name,isDirty:!1,past:[],future:[],selectedNodeId:null,saveStatus:"idle"}),{success:!0}}catch(r){return console.error("Load failed:",r),{success:!1,error:r}}},newMap:()=>{const n="root-"+yh().slice(0,8);t({nodes:[{id:n,type:"mindmap",position:{x:350,y:250},data:{title:"Central Topic",key:n,level:0,content:""}}],edges:[],currentMapId:null,currentMapName:"Untitled Map",isDirty:!1,past:[],future:[],selectedNodeId:null,saveStatus:"idle"})},setMapName:n=>{t({currentMapName:n,isDirty:!0})},openMapList:()=>t({isMapListOpen:!0}),closeMapList:()=>t({isMapListOpen:!1})})),D$=({status:t})=>{const n={saving:{color:"#f59e0b",label:"Saving"},saved:{color:"#22c55e",label:"Saved"},error:{color:"#ef4444",label:"Save failed"},idle:null}[t];return n?_.jsxs("span",{className:"save-status",style:{color:n.color},children:[_.jsx("span",{className:"save-dot",style:{background:n.color}}),n.label]}):null},$$=()=>{const{currentMapName:t,isDirty:e,past:n,future:r,saveStatus:i,undo:s,redo:o,saveMap:l,newMap:a,setMapName:u,openMapList:c,currentMapId:d}=Gs(),[f,h]=I.useState(!1),[p,m]=I.useState(""),v=()=>{m(t),h(!0)},g=()=>{p.trim()&&u(p.trim()),h(!1)},w=k=>{k.key==="Enter"&&g(),k.key==="Escape"&&h(!1)},y=()=>{e&&!confirm("You have unsaved changes. Create a new map anyway?")||a()},x=async()=>{let k=t;if(!d){const S=prompt("Map name:",t);if(S===null)return;k=S.trim()||t}await l(k)};return _.jsxs("div",{className:"toolbar",children:[_.jsxs("div",{className:"toolbar-brand",children:[_.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[_.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"#fbbf24"}),_.jsx("circle",{cx:"4",cy:"6",r:"2",fill:"#60a5fa"}),_.jsx("circle",{cx:"20",cy:"6",r:"2",fill:"#60a5fa"}),_.jsx("circle",{cx:"4",cy:"18",r:"2",fill:"#34d399"}),_.jsx("circle",{cx:"20",cy:"18",r:"2",fill:"#34d399"}),_.jsx("line",{x1:"12",y1:"12",x2:"4",y2:"6",stroke:"#94a3b8",strokeWidth:"1.5"}),_.jsx("line",{x1:"12",y1:"12",x2:"20",y2:"6",stroke:"#94a3b8",strokeWidth:"1.5"}),_.jsx("line",{x1:"12",y1:"12",x2:"4",y2:"18",stroke:"#94a3b8",strokeWidth:"1.5"}),_.jsx("line",{x1:"12",y1:"12",x2:"20",y2:"18",stroke:"#94a3b8",strokeWidth:"1.5"})]}),_.jsx("span",{className:"toolbar-brand-name",children:"Knowledge Maps"})]}),_.jsxs("div",{className:"toolbar-center",children:[f?_.jsx("input",{className:"map-name-input",value:p,onChange:k=>m(k.target.value),onBlur:g,onKeyDown:w,autoFocus:!0}):_.jsxs("button",{className:"map-name-btn",onClick:v,title:"Click to rename",children:[t,e&&_.jsx("span",{className:"dirty-dot",title:"Unsaved changes"})]}),_.jsx(D$,{status:i})]}),_.jsxs("div",{className:"toolbar-actions",children:[_.jsx("button",{className:"btn btn--ghost btn--sm",onClick:s,disabled:n.length===0,title:"Undo (Ctrl+Z)",children:" Undo"}),_.jsx("button",{className:"btn btn--ghost btn--sm",onClick:o,disabled:r.length===0,title:"Redo (Ctrl+Y / Ctrl+Shift+Z)",children:" Redo"}),_.jsx("div",{className:"toolbar-sep"}),_.jsx("button",{className:"btn btn--ghost btn--sm",onClick:y,title:"New map",children:"+ New"}),_.jsx("button",{className:"btn btn--ghost btn--sm",onClick:c,title:"Open a saved map",children:"Open"}),_.jsx("button",{className:"btn btn--primary btn--sm",onClick:x,disabled:i==="saving",title:"Save map to Supabase",children:i==="saving"?"Saving":"Save"})]})]})},L$=[{level:1,label:"Main Topic",desc:"Level 1",bg:"#dbeafe",border:"#3b82f6",text:"#1e3a8a"},{level:2,label:"Subtopic",desc:"Level 2",bg:"#d1fae5",border:"#10b981",text:"#064e3b"},{level:3,label:"Detail",desc:"Level 3",bg:"#ede9fe",border:"#7c3aed",text:"#3b0764"}],j$=({level:t,label:e,desc:n,bg:r,border:i,text:s})=>{const o=l=>{l.dataTransfer.setData("application/reactflow",JSON.stringify({level:t,title:e})),l.dataTransfer.effectAllowed="copy"};return _.jsxs("div",{draggable:!0,onDragStart:o,className:"node-template",style:{background:r,border:`2px solid ${i}`,color:s},children:[_.jsx("span",{className:"node-template-label",children:e}),_.jsxs("span",{className:"node-template-desc",children:[n,"  drag to add"]})]})},z$=()=>_.jsxs("div",{className:"node-palette",children:[_.jsx("div",{className:"palette-title",children:"Add Nodes"}),_.jsx("p",{className:"palette-hint",children:"Drag a node onto the canvas to add it"}),L$.map(t=>_.jsx(j$,{...t},t.level)),_.jsxs("div",{className:"palette-tip",children:[_.jsx("strong",{children:"Connect nodes:"}),_.jsx("br",{}),"Drag from a handle (circle) on one node to a handle on another."]})]}),B$={0:{width:190,fontSize:"17px",fontWeight:"700",bg:"#fbbf24",border:"#d97706",text:"#1c1917",borderWidth:3,padding:"14px 22px",borderRadius:"42px",shadow:"0 4px 14px rgba(251,191,36,0.4)"},1:{width:160,fontSize:"14px",fontWeight:"600",bg:"#60a5fa",border:"#2563eb",text:"#1e3a8a",borderWidth:2,padding:"10px 16px",borderRadius:"30px",shadow:"0 3px 10px rgba(96,165,250,0.35)"},2:{width:135,fontSize:"13px",fontWeight:"500",bg:"#34d399",border:"#059669",text:"#064e3b",borderWidth:2,padding:"8px 13px",borderRadius:"24px",shadow:"0 2px 8px rgba(52,211,153,0.3)"},3:{width:115,fontSize:"12px",fontWeight:"400",bg:"#c4b5fd",border:"#7c3aed",text:"#3b0764",borderWidth:1,padding:"7px 11px",borderRadius:"20px",shadow:"0 2px 6px rgba(196,181,253,0.3)"}},F$=t=>B$[Math.min(Math.max(t,0),3)],pk=I.memo(({id:t,data:e,selected:n})=>{const r=Gs(a=>a.selectNode),{title:i,level:s}=e,o=F$(s),l={background:o.border,width:10,height:10,border:"2px solid white"};return _.jsxs("div",{onClick:()=>r(t),style:{width:o.width,background:o.bg,border:`${o.borderWidth}px solid ${n?"#f43f5e":o.border}`,borderRadius:o.borderRadius,padding:o.padding,fontSize:o.fontSize,fontWeight:o.fontWeight,color:o.text,textAlign:"center",cursor:"pointer",boxShadow:n?`0 0 0 3px rgba(244,63,94,0.35), ${o.shadow}`:o.shadow,transition:"box-shadow 0.15s ease, border-color 0.15s ease",userSelect:"none",wordBreak:"break-word",lineHeight:"1.35",position:"relative"},children:[_.jsx(yr,{type:"target",position:Y.Top,style:{...l,top:-6}}),_.jsx("span",{children:i||"Untitled"}),_.jsx(yr,{type:"source",position:Y.Bottom,style:{...l,bottom:-6}}),_.jsx(yr,{type:"source",id:"left",position:Y.Left,style:{...l,left:-6}}),_.jsx(yr,{type:"source",id:"right",position:Y.Right,style:{...l,right:-6}})]})});pk.displayName="CustomNode";const V$={mindmap:pk},U$=()=>{const t=I.useRef(null),{screenToFlowPosition:e}=Nc(),{nodes:n,edges:r,onNodesChange:i,onEdgesChange:s,onConnect:o,addNode:l,pushHistory:a,selectNode:u,deselectNode:c}=Gs(),d=I.useCallback(v=>{v.preventDefault(),v.dataTransfer.dropEffect="copy"},[]),f=I.useCallback(v=>{v.preventDefault();const g=v.dataTransfer.getData("application/reactflow");if(!g)return;const{level:w,title:y}=JSON.parse(g),x=e({x:v.clientX,y:v.clientY});l({position:x,level:w,title:y})},[e,l]),h=I.useCallback(()=>{a()},[a]),p=I.useCallback((v,g)=>{u(g.id)},[u]),m=I.useCallback(()=>{c()},[c]);return _.jsx("div",{ref:t,style:{width:"100%",height:"100%"},children:_.jsxs(SP,{nodes:n,edges:r,onNodesChange:i,onEdgesChange:s,onConnect:o,onDragOver:d,onDrop:f,onNodeDragStart:h,onNodeClick:p,onPaneClick:m,nodeTypes:V$,fitView:!0,fitViewOptions:{padding:.3},minZoom:.2,maxZoom:2,defaultEdgeOptions:{type:"smoothstep",style:{stroke:"#94a3b8",strokeWidth:2}},deleteKeyCode:["Backspace","Delete"],children:[_.jsx(CP,{variant:Vn.Dots,gap:22,size:1.2,color:"#cbd5e1"}),_.jsx(RP,{showInteractive:!1}),_.jsx(qP,{nodeColor:v=>{var w;return["#fbbf24","#60a5fa","#34d399","#c4b5fd"][Math.min(((w=v.data)==null?void 0:w.level)??0,3)]},maskColor:"rgba(241,245,249,0.7)",style:{background:"#f8fafc",border:"1px solid #e2e8f0"},zoomable:!0,pannable:!0}),_.jsx(Vl,{position:"bottom-center",children:_.jsx("div",{className:"canvas-hint",children:"Drag from handles to connect nodes  Delete selected with Backspace"})})]})})};function Qe(t){this.content=t}Qe.prototype={constructor:Qe,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),s=r.content.slice();return i==-1?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new Qe(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new Qe(n)},addToStart:function(t,e){return new Qe([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new Qe(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),s=r.find(t);return i.splice(s==-1?i.length:s,0,e,n),new Qe(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Qe.from(t),t.size?new Qe(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Qe.from(t),t.size?new Qe(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Qe.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};Qe.from=function(t){if(t instanceof Qe)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new Qe(e)};function mk(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),s=e.child(r);if(i==s){n+=i.nodeSize;continue}if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)n++;return n}if(i.content.size||s.content.size){let o=mk(i.content,s.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function gk(t,e,n,r){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:n,b:r};let o=t.child(--i),l=e.child(--s),a=o.nodeSize;if(o==l){n-=a,r-=a;continue}if(!o.sameMarkup(l))return{a:n,b:r};if(o.isText&&o.text!=l.text){let u=0,c=Math.min(o.text.length,l.text.length);for(;u<c&&o.text[o.text.length-u-1]==l.text[l.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(o.content.size||l.content.size){let u=gk(o.content,l.content,n-1,r-1);if(u)return u}n-=a,r-=a}}class F{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,s){for(let o=0,l=0;l<n;o++){let a=this.content[o],u=l+a.nodeSize;if(u>e&&r(a,i+l,s||null,o)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,n-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let s="",o=!0;return this.nodesBetween(e,n,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,n-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(o?o=!1:s+=r),s+=u},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new F(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let s=0,o=0;o<n;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>n)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,n-o-1))),r.push(l),i+=l.nodeSize),o=a}return new F(r,i)}cutByIndex(e,n){return e==n?F.empty:e==0&&n==this.content.length?this:new F(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new F(i,s)}addToStart(e){return new F([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new F(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return mk(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return gk(this,e,n,r)}findIndex(e){if(e==0)return Oa(0,e);if(e==this.size)return Oa(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),s=r+i.nodeSize;if(s>=e)return s==e?Oa(n+1,s):Oa(n,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return F.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new F(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return F.empty;let n,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(n||(n=e.slice(0,i)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new F(n||e,r)}static from(e){if(!e)return F.empty;if(e instanceof F)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new F([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}F.empty=new F([],0);const Fd={index:0,offset:0};function Oa(t,e){return Fd.index=t,Fd.offset=e,Fd}function Vu(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Vu(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Vu(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let ye=class Nh{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Vu(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Nh.none;if(e instanceof Nh)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};ye.none=[];class Uu extends Error{}class W{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=vk(this.content,e+this.openStart,n);return r&&new W(r,this.openStart,this.openEnd)}removeBetween(e,n){return new W(yk(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return W.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new W(F.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new W(e,r,i)}}W.empty=new W(F.empty,0,0);function yk(t,e,n){let{index:r,offset:i}=t.findIndex(e),s=t.maybeChild(r),{index:o,offset:l}=t.findIndex(n);if(i==e||s.isText){if(l!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(yk(s.content,e-i-1,n-i-1)))}function vk(t,e,n,r){let{index:i,offset:s}=t.findIndex(e),o=t.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=vk(o.content,e-s-1,n,o);return l&&t.replaceChild(i,o.copy(l))}function H$(t,e,n){if(n.openStart>t.depth)throw new Uu("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Uu("Inconsistent open depths");return wk(t,e,n,0)}function wk(t,e,n,r){let i=t.index(r),s=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let o=wk(t,e,n,r+1);return s.copy(s.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,l=o.content;return hi(o,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=W$(n,t);return hi(s,Sk(t,o,l,e,r))}else return hi(s,Hu(t,e,r))}function xk(t,e){if(!e.type.compatibleContent(t.type))throw new Uu("Cannot join "+e.type.name+" onto "+t.type.name)}function Oh(t,e,n){let r=t.node(n);return xk(r,e.node(n)),r}function fi(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function jo(t,e,n,r){let i=(e||t).node(n),s=0,o=e?e.index(n):i.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(fi(t.nodeAfter,r),s++));for(let l=s;l<o;l++)fi(i.child(l),r);e&&e.depth==n&&e.textOffset&&fi(e.nodeBefore,r)}function hi(t,e){return t.type.checkContent(e),t.copy(e)}function Sk(t,e,n,r,i){let s=t.depth>i&&Oh(t,e,i+1),o=r.depth>i&&Oh(n,r,i+1),l=[];return jo(null,t,i,l),s&&o&&e.index(i)==n.index(i)?(xk(s,o),fi(hi(s,Sk(t,e,n,r,i+1)),l)):(s&&fi(hi(s,Hu(t,e,i+1)),l),jo(e,n,i,l),o&&fi(hi(o,Hu(n,r,i+1)),l)),jo(r,null,i,l),new F(l)}function Hu(t,e,n){let r=[];if(jo(null,t,n,r),t.depth>n){let i=Oh(t,e,n+1);fi(hi(i,Hu(t,e,n+1)),r)}return jo(e,null,n,r),new F(r)}function W$(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)i=e.node(s).copy(F.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Sl{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return ye.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Wu(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,s=n;for(let o=e;;){let{index:l,offset:a}=o.content.findIndex(s),u=s-a;if(r.push(o,l,i+a),!u||(o=o.child(l),o.isText))break;s=u-1,i+=a+1}return new Sl(n,r,s)}static resolveCached(e,n){let r=O0.get(e);if(r)for(let s=0;s<r.elts.length;s++){let o=r.elts[s];if(o.pos==n)return o}else O0.set(e,r=new q$);let i=r.elts[r.i]=Sl.resolve(e,n);return r.i=(r.i+1)%K$,i}}class q${constructor(){this.elts=[],this.i=0}}const K$=12,O0=new WeakMap;class Wu{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const J$=Object.create(null);let Or=class Mh{constructor(e,n,r,i=ye.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||F.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Vu(this.attrs,n||e.defaultAttrs||J$)&&ye.sameSet(this.marks,r||ye.none)}copy(e=null){return e==this.content?this:new Mh(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Mh(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return W.empty;let i=this.resolve(e),s=this.resolve(n),o=r?0:i.sharedDepth(n),l=i.start(o),u=i.node(o).content.cut(i.pos-l,s.pos-l);return new W(u,i.depth-o,s.depth-o)}replace(e,n,r){return H$(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Sl.resolveCached(this,e)}resolveNoCache(e){return Sl.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),bk(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=F.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let a=i;a<s;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ye.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!ye.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=F.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,i,r);return s.type.checkAttrs(s.attrs),s}};Or.prototype.text=void 0;class qu extends Or{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):bk(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new qu(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new qu(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function bk(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Ci{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new G$(e,n);if(r.next==null)return Ci.empty;let i=kk(r);r.next&&r.err("Unexpected trailing text");let s=nL(tL(i));return rL(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let s=n;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function s(o,l){let a=o.matchFragment(e,r);if(a&&(!n||a.validEnd))return F.from(l.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:c,next:d}=o.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=s(d,l.concat(c));if(f)return f}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:a}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}Ci.empty=new Ci(!0);class G${constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function kk(t){let e=[];do e.push(Y$(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Y$(t){let e=[];do e.push(X$(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function X$(t){let e=eL(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=Q$(t,e);else break;return e}function M0(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function Q$(t,e){let n=M0(t),r=n;return t.eat(",")&&(t.next!="}"?r=M0(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Z$(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let s in n){let o=n[s];o.isInGroup(e)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function eL(t){if(t.eat("(")){let e=kk(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=Z$(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function tL(t){let e=[[]];return i(s(t,0),n()),e;function n(){return e.push([])-1}function r(o,l,a){let u={term:a,to:l};return e[o].push(u),u}function i(o,l){o.forEach(a=>a.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((a,u)=>a.concat(s(u,l)),[]);if(o.type=="seq")for(let a=0;;a++){let u=s(o.exprs[a],l);if(a==o.exprs.length-1)return u;i(u,l=n())}else if(o.type=="star"){let a=n();return r(l,a),i(s(o.expr,a),a),[r(a)]}else if(o.type=="plus"){let a=n();return i(s(o.expr,l),a),i(s(o.expr,a),a),[r(a)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let a=l;for(let u=0;u<o.min;u++){let c=n();i(s(o.expr,a),c),a=c}if(o.max==-1)i(s(o.expr,a),a);else for(let u=o.min;u<o.max;u++){let c=n();r(a,c),i(s(o.expr,a),c),a=c}return[r(a)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function _k(t,e){return e-t}function A0(t,e){let n=[];return r(e),n.sort(_k);function r(i){let s=t[i];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(i);for(let o=0;o<s.length;o++){let{term:l,to:a}=s[o];!l&&n.indexOf(a)==-1&&r(a)}}}function nL(t){let e=Object.create(null);return n(A0(t,0));function n(r){let i=[];r.forEach(o=>{t[o].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);A0(t,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let s=e[r.join(",")]=new Ci(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(_k);s.next.push({type:i[o][0],next:e[l.join(",")]||n(l)})}return s}}function rL(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];o.push(a.name),s&&!(a.isText||a.hasRequiredAttrs())&&(s=!1),r.indexOf(u)==-1&&r.push(u)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Ek(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Ck(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let s=t[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function Tk(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let s=t[i];s.validate&&s.validate(e[i])}}function Nk(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new sL(t,r,e[r]);return n}let I0=class Ok{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Nk(e,r.attrs),this.defaultAttrs=Ek(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ci.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Ck(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Or(this,this.computeAttrs(e),F.from(n),ye.setFrom(r))}createChecked(e=null,n,r){return n=F.from(n),this.checkContent(n),new Or(this,this.computeAttrs(e),n,ye.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=F.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),s=i&&i.fillBefore(F.empty,!0);return s?new Or(this,e,n.append(s),ye.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Tk(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:ye.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,o)=>r[s]=new Ok(s,n,o));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function iL(t,e,n){let r=n.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${s}`)}}class sL{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?iL(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Dc{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=Nk(e,i.attrs),this.excluded=null;let s=Ek(this.attrs);this.instance=s?new ye(this,s):null}create(e=null){return!e&&this.instance?this.instance:new ye(this,Ck(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new Dc(s,i++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){Tk(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Mk{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=Qe.from(e.nodes),n.marks=Qe.from(e.marks||{}),this.nodes=I0.compile(this.spec.nodes,this),this.marks=Dc.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=Ci.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?R0(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:R0(this,o.split(" "))}this.nodeFromJSON=i=>Or.fromJSON(this,i),this.markFromJSON=i=>ye.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof I0){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new qu(r,r.defaultAttrs,e,ye.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function R0(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],s=t.marks[i],o=s;if(s)n.push(s);else for(let l in t.marks){let a=t.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=a)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function oL(t){return t.tag!=null}function lL(t){return t.style!=null}class Mr{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(oL(i))this.tags.push(i);else if(lL(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let r=new D0(this,n,!1);return r.addAll(e,ye.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new D0(this,n,!0);return r.addAll(e,ye.none,n.from,n.to),W.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(cL(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,n,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(o.getAttrs){let a=o.getAttrs(n);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let n=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let l=n[o];if((l.priority==null?50:l.priority)<s)break}n.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=$0(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=$0(o)),o.node||o.ignore||o.mark||(o.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Mr(e,Mr.schemaRules(e)))}}const Ak={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},aL={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ik={ol:!0,ul:!0},bl=1,Ah=2,zo=4;function P0(t,e,n){return e!=null?(e?bl:0)|(e==="full"?Ah:0):t&&t.whitespace=="pre"?bl|Ah:n&~zo}class Ma{constructor(e,n,r,i,s,o){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=ye.none,this.match=s||(o&zo?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(F.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&bl)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let n=F.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(F.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Ak.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class D0{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,s,o=P0(null,n.preserveWhitespace,0)|(r?zo:0);i?s=new Ma(i.type,i.attrs,ye.none,!0,n.topMatch||i.type.contentMatch,o):r?s=new Ma(null,null,ye.none,!0,null,o):s=new Ma(e.schema.topNodeType,null,ye.none,!0,null,o),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,s=i.options&Ah?"full":this.localPreserveWS||(i.options&bl)>0,{schema:o}=this.parser;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(s)if(s==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let a=0;a<l.length;a++)a&&this.insertNode(o.linebreakReplacement.create(),n,!0),l[a]&&this.insertNode(o.text(l[a]),n,!/\S/.test(l[a]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=i.content[i.content.length-1],a=e.previousSibling;(!l||a&&a.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;Ik.hasOwnProperty(o)&&this.parser.normalizeLists&&uL(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(a?a.ignore:aL.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let u,c=this.needsBlock;if(Ak.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),u=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=a&&a.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),u&&this.sync(s),this.needsBlock=c}else{let u=this.readStyles(e,n);u&&this.addElementByRule(e,a,u,a.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=r.getPropertyValue(s);if(o)for(let l=void 0;;){let a=this.parser.matchStyle(s,o,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?n=n.filter(u=>!a.clearMark(u)):n=n.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return n}addElementByRule(e,n,r,i){let s,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let a=this.enter(o,n.attrs||null,r,n.preserveWhitespace);a&&(s=!0,r=a)}else{let a=this.parser.schema.marks[n.mark];r=r.concat(a.create(n.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r,!1));else{let a=e;typeof n.contentElement=="string"?a=e.querySelector(n.contentElement):typeof n.contentElement=="function"?a=n.contentElement(e):n.contentElement&&(a=n.contentElement),this.findAround(e,a,!0),this.addAll(a,r),this.findAround(e,a,!1)}s&&this.sync(l)&&this.open--}addAll(e,n,r,i){let s=r||0;for(let o=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];o!=l;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,n);this.findAtPoint(e,s)}findPlace(e,n,r){let i,s;for(let o=this.open,l=0;o>=0;o--){let a=this.nodes[o],u=a.findWrapping(e);if(u&&(!i||i.length>u.length+l)&&(i=u,s=a,!u.length))break;if(a.solid){if(r)break;l+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)n=this.enterInner(i[o],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let o=ye.none;for(let l of i.concat(e.marks))(s.type?s.type.allowsMarkType(l.type):L0(l.type,e.type))&&(o=l.addToSet(o));return s.content.push(e.mark(o)),!0}return!1}enter(e,n,r,i){let s=this.findPlace(e.create(n),r,!1);return s&&(s=this.enterInner(e,n,r,!0,i)),s}enterInner(e,n,r,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=P0(e,s,o.options);o.options&zo&&o.content.length==0&&(l|=zo);let a=ye.none;return r=r.filter(u=>(o.type?o.type.allowsMarkType(u.type):L0(u.type,e))?(a=u.addToSet(a),!1):!0),this.nodes.push(new Ma(e,n,a,i,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=bl)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,a)=>{for(;l>=0;l--){let u=n[l];if(u==""){if(l==n.length-1||l==0)continue;for(;a>=s;a--)if(o(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=s?r.node(a-s).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;a--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function uL(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Ik.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function cL(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function $0(t){let e={};for(let n in t)e[n]=t[n];return e}function L0(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let s=[],o=l=>{s.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||s.indexOf(c)<0&&o(c))return!0}};if(o(i.contentMatch))return!0}}class Ii{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Vd(n).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,a=0;for(;l<s.length&&a<o.marks.length;){let u=o.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(s[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<s.length;)i=s.pop()[1];for(;a<o.marks.length;){let u=o.marks[a++],c=this.serializeMark(u,o.isInline,n);c&&(s.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=eu(Vd(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&eu(Vd(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return eu(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ii(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=j0(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return j0(e.marks)}}function j0(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Vd(t){return t.document||window.document}const z0=new WeakMap;function dL(t){let e=z0.get(t);return e===void 0&&z0.set(t,e=fL(t)),e}function fL(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function eu(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=dL(r))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(n=i.slice(0,o),i=i.slice(o+1));let l,a=n?t.createElementNS(n,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let d in u)if(u[d]!=null){let f=d.indexOf(" ");f>0?a.setAttributeNS(d.slice(0,f),d.slice(f+1),u[d]):d=="style"&&a.style?a.style.cssText=u[d]:a.setAttribute(d,u[d])}}for(let d=c;d<e.length;d++){let f=e[d];if(f===0){if(d<e.length-1||d>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:h,contentDOM:p}=eu(t,f,n,r);if(a.appendChild(h),p){if(l)throw new RangeError("Multiple content holes");l=p}}}return{dom:a,contentDOM:l}}const Rk=65535,Pk=Math.pow(2,16);function hL(t,e){return t+e*Pk}function B0(t){return t&Rk}function pL(t){return(t-(t&Rk))/Pk}const Dk=1,$k=2,tu=4,Lk=8;class Ih{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&Lk)>0}get deletedBefore(){return(this.delInfo&(Dk|tu))>0}get deletedAfter(){return(this.delInfo&($k|tu))>0}get deletedAcross(){return(this.delInfo&tu)>0}}class Rt{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Rt.empty)return Rt.empty}recover(e){let n=0,r=B0(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+pL(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+s],c=this.ranges[l+o],d=a+u;if(e<=d){let f=u?e==a?-1:e==d?1:n:n,h=a+i+(f<0?0:c);if(r)return h;let p=e==(n<0?a:d)?null:hL(l/3,e-a),m=e==a?$k:e==d?Dk:tu;return(n<0?e!=a:e!=d)&&(m|=Lk),new Ih(h,m,p)}i+=c-u}return r?e+i:new Ih(e+i,0,null)}touches(e,n){let r=0,i=B0(n),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+s],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+o]-u}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),u=this.ranges[i+n],c=this.ranges[i+r];e(l,l+u,a,a+c),s+=c-u}}invert(){return new Rt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Rt.empty:new Rt(e<0?[0,-e,0]:[0,0,e])}}Rt.empty=new Rt([]);class kl{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new kl(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new kl;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(e,n);if(l.recover!=null){let a=this.getMirror(s);if(a!=null&&a>s&&a<this.to){s=a,e=this._maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new Ih(e,i,null)}}const Ud=Object.create(null);class ft{getMap(){return Rt.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ud[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Ud)throw new RangeError("Duplicate use of step JSON ID "+e);return Ud[e]=n,n.prototype.jsonID=e,n}}class De{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new De(e,null)}static fail(e){return new De(null,e)}static fromReplace(e,n,r,i){try{return De.ok(e.replace(n,r,i))}catch(s){if(s instanceof Uu)return De.fail(s.message);throw s}}}function um(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(um(s.content,e,s))),s.isInline&&(s=e(s,n,i)),r.push(s)}return F.fromArray(r)}class vr extends ft{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new W(um(n.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return De.fromReplace(e,this.from,this.to,s)}invert(){return new Sn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new vr(n.pos,r.pos,this.mark)}merge(e){return e instanceof vr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new vr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new vr(n.from,n.to,e.markFromJSON(n.mark))}}ft.jsonID("addMark",vr);class Sn extends ft{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new W(um(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return De.fromReplace(e,this.from,this.to,r)}invert(){return new vr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Sn(n.pos,r.pos,this.mark)}merge(e){return e instanceof Sn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Sn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Sn(n.from,n.to,e.markFromJSON(n.mark))}}ft.jsonID("removeMark",Sn);class wr extends ft{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return De.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return De.fromReplace(e,this.pos,this.pos+1,new W(F.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new wr(this.pos,n.marks[i]);return new wr(this.pos,this.mark)}}return new Ti(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new wr(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new wr(n.pos,e.markFromJSON(n.mark))}}ft.jsonID("addNodeMark",wr);class Ti extends ft{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return De.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return De.fromReplace(e,this.pos,this.pos+1,new W(F.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new wr(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ti(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ti(n.pos,e.markFromJSON(n.mark))}}ft.jsonID("removeNodeMark",Ti);class Ue extends ft{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Rh(e,this.from,this.to)?De.fail("Structure replace would overwrite content"):De.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Rt([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ue(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Ue(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Ue)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?W.empty:new W(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ue(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?W.empty:new W(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ue(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ue(n.from,n.to,W.fromJSON(e,n.slice),!!n.structure)}}ft.jsonID("replace",Ue);class We extends ft{constructor(e,n,r,i,s,o,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(Rh(e,this.from,this.gapFrom)||Rh(e,this.gapTo,this.to)))return De.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return De.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?De.fromReplace(e,this.from,this.to,r):De.fail("Content does not fit in gap")}getMap(){return new Rt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new We(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||s>r.pos?null:new We(n.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new We(n.from,n.to,n.gapFrom,n.gapTo,W.fromJSON(e,n.slice),n.insert,!!n.structure)}}ft.jsonID("replaceAround",We);function Rh(t,e,n){let r=t.resolve(e),i=n-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function mL(t,e,n,r){let i=[],s=[],o,l;t.doc.nodesBetween(e,n,(a,u,c)=>{if(!a.isInline)return;let d=a.marks;if(!r.isInSet(d)&&c.type.allowsMarkType(r.type)){let f=Math.max(u,e),h=Math.min(u+a.nodeSize,n),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(o&&o.to==f&&o.mark.eq(d[m])?o.to=h:i.push(o=new Sn(f,h,d[m])));l&&l.to==f?l.to=h:s.push(l=new vr(f,h,r))}}),i.forEach(a=>t.step(a)),s.forEach(a=>t.step(a))}function gL(t,e,n,r){let i=[],s=0;t.doc.nodesBetween(e,n,(o,l)=>{if(!o.isInline)return;s++;let a=null;if(r instanceof Dc){let u=o.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(o.marks)&&(a=[r]):a=o.marks;if(a&&a.length){let u=Math.min(l+o.nodeSize,n);for(let c=0;c<a.length;c++){let d=a[c],f;for(let h=0;h<i.length;h++){let p=i[h];p.step==s-1&&d.eq(i[h].style)&&(f=p)}f?(f.to=u,f.step=s):i.push({style:d,from:Math.max(l,e),to:u,step:s})}}}),i.forEach(o=>t.step(new Sn(o.from,o.to,o.style)))}function cm(t,e,n,r=n.contentMatch,i=!0){let s=t.doc.nodeAt(e),o=[],l=e+1;for(let a=0;a<s.childCount;a++){let u=s.child(a),c=l+u.nodeSize,d=r.matchType(u.type);if(!d)o.push(new Ue(l,c,W.empty));else{r=d;for(let f=0;f<u.marks.length;f++)n.allowsMarkType(u.marks[f].type)||t.step(new Sn(l,c,u.marks[f]));if(i&&u.isText&&n.whitespace!="pre"){let f,h=/\r?\n|\r/g,p;for(;f=h.exec(u.text);)p||(p=new W(F.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),o.push(new Ue(l+f.index,l+f.index+f[0].length,p))}}l=c}if(!r.validEnd){let a=r.fillBefore(F.empty,!0);t.replace(l,l,new W(a,0,0))}for(let a=o.length-1;a>=0;a--)t.step(o[a])}function yL(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Ys(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,i=0,s=0;;--r){let o=t.$from.node(r),l=t.$from.index(r)+i,a=t.$to.indexAfter(r)-s;if(r<t.depth&&o.canReplace(l,a,n))return r;if(r==0||o.type.spec.isolating||!yL(o,l,a))break;l&&(i=1),a<o.childCount&&(s=1)}return null}function vL(t,e,n){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),l=i.after(s+1),a=o,u=l,c=F.empty,d=0;for(let p=s,m=!1;p>n;p--)m||r.index(p)>0?(m=!0,c=F.from(r.node(p).copy(c)),d++):a--;let f=F.empty,h=0;for(let p=s,m=!1;p>n;p--)m||i.after(p+1)<i.end(p)?(m=!0,f=F.from(i.node(p).copy(f)),h++):u++;t.step(new We(a,u,o,l,new W(c.append(f),d,h),c.size-d,!0))}function dm(t,e,n=null,r=t){let i=wL(t,e),s=i&&xL(r,e);return s?i.map(F0).concat({type:e,attrs:n}).concat(s.map(F0)):null}function F0(t){return{type:t,attrs:null}}function wL(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return n.canReplaceWith(r,i,o)?s:null}function xL(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(n.child(u).type);return!a||!a.validEnd?null:o}function SL(t,e,n){let r=F.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let l=n[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=F.from(n[o].type.create(n[o].attrs,r))}let i=e.start,s=e.end;t.step(new We(i,s,i,s,new W(r,0,0),n.length,!0))}function bL(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(o,l)=>{let a=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,a)&&kL(t.doc,t.mapping.slice(s).map(l),r)){let u=null;if(r.schema.linebreakReplacement){let h=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);h&&!p?u=!1:!h&&p&&(u=!0)}u===!1&&zk(t,o,l,s),cm(t,t.mapping.slice(s).map(l,1),r,void 0,u===null);let c=t.mapping.slice(s),d=c.map(l,1),f=c.map(l+o.nodeSize,1);return t.step(new We(d,f,d+1,f-1,new W(F.from(r.create(a,null,o.marks)),0,0),1,!0)),u===!0&&jk(t,o,l,s),!1}})}function jk(t,e,n,r){e.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(i.text);){let a=t.mapping.slice(r).map(n+1+s+o.index);t.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}}})}function zk(t,e,n,r){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+s);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function kL(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function _L(t,e,n,r,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new We(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new W(F.from(o),0,0),1,!0))}function Un(t,e,n=1,r){let i=t.resolve(e),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=n-2;u>s;u--,c--){let d=i.node(u),f=i.index(u);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(f,d.childCount),p=r&&r[c+1];p&&(h=h.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[c]||d;if(!d.canReplace(f+1,d.childCount)||!m.type.validContent(h))return!1}let l=i.indexAfter(s),a=r&&r[0];return i.node(s).canReplaceWith(l,l,a?a.type:i.node(s+1).type)}function EL(t,e,n=1,r){let i=t.doc.resolve(e),s=F.empty,o=F.empty;for(let l=i.depth,a=i.depth-n,u=n-1;l>a;l--,u--){s=F.from(i.node(l).copy(s));let c=r&&r[u];o=F.from(c?c.type.create(c.attrs,o):i.node(l).copy(o))}t.step(new Ue(e,e,new W(s.append(o),n,n),!0))}function Br(t,e){let n=t.resolve(e),r=n.index();return Bk(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function CL(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),o=s.type==r?t.type.schema.nodes.text:s.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function Bk(t,e){return!!(t&&e&&!t.isLeaf&&CL(t,e))}function $c(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let s,o,l=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):n>0?(s=r.node(i+1),l++,o=r.node(i).maybeChild(l)):(s=r.node(i).maybeChild(l-1),o=r.node(i+1)),s&&!s.isTextblock&&Bk(s,o)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function TL(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,s=t.doc.resolve(e-n),o=s.node().type;if(i&&o.inlineContent){let c=o.whitespace=="pre",d=!!o.contentMatch.matchType(i);c&&!d?r=!1:!c&&d&&(r=!0)}let l=t.steps.length;if(r===!1){let c=t.doc.resolve(e+n);zk(t,c.node(),c.before(),l)}o.inlineContent&&cm(t,e+n-1,o,s.node().contentMatchAt(s.index()),r==null);let a=t.mapping.slice(l),u=a.map(e-n);if(t.step(new Ue(u,a.map(e+n,-1),W.empty,!0)),r===!0){let c=t.doc.resolve(u);jk(t,c.node(),c.before(),t.steps.length)}return t}function NL(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,n))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,n))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function Fk(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,a=r.index(o)+(l>0?1:0),u=r.node(o),c=!1;if(s==1)c=u.canReplace(a,a,i);else{let d=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=d&&u.canReplaceWith(a,a,d[0])}if(c)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function Lc(t,e,n=e,r=W.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),s=t.resolve(n);return Vk(i,s,r)?new Ue(e,n,r):new OL(i,s,r).fit()}function Vk(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class OL{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=F.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=F.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let a=new W(s,o,l);return e>-1?new We(r.pos,e,this.$to.pos,this.$to.end(),a,n):a.size||r.pos!=this.$to.pos?new Ue(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=n.firstChild;if(n.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}n=s.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=Hd(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,d=null;if(n==1&&(o?u.matchType(o.type)||(d=u.fillBefore(F.from(o),!1)):s&&a.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:d};if(n==2&&o&&(c=u.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:c};if(s&&u.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Hd(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new W(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=Hd(e,n);if(i.childCount<=1&&n>0){let s=e.size-n<=n+i.size;this.unplaced=new W(So(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new W(So(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,l=r?r.content:o.content,a=o.openStart-e,u=0,c=[],{match:d,type:f}=this.frontier[n];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));d=d.matchFragment(i)}let h=l.size+e-(o.content.size-o.openEnd);for(;u<l.childCount;){let m=l.child(u),v=d.matchType(m.type);if(!v)break;u++,(u>1||a==0||m.content.size)&&(d=v,c.push(Uk(m.mark(f.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?h:-1)))}let p=u==l.childCount;p||(h=-1),this.placed=bo(this.placed,n,F.from(c)),this.frontier[n].match=d,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,v=l;m<h;m++){let g=v.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),v=g.content}this.unplaced=p?e==0?W.empty:new W(So(o.content,e-1,1),e-1,h<0?o.openEnd:e-1):new W(So(o.content,e,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Wd(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Wd(e,n,i,r,s);if(o){for(let l=n-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Wd(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:n,fit:o,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=bo(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=bo(this.placed,this.depth,F.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(F.empty,!0);n.childCount&&(this.placed=bo(this.placed,this.frontier.length,n))}}function So(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(So(t.firstChild.content,e-1,n)))}function bo(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(bo(t.lastChild.content,e-1,n)))}function Hd(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function Uk(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,Uk(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(F.empty,!0)))),t.copy(r)}function Wd(t,e,n,r,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!ML(n,s.content,o)?l:null}function ML(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function AL(t){return t.spec.defining||t.spec.definingForContent}function IL(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),s=t.doc.resolve(n);if(Vk(i,s,r))return t.step(new Ue(e,n,r));let o=Wk(i,s);o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let f=i.depth,h=i.pos-1;f>0;f--,h--){let p=i.node(f).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(f)>-1?l=f:i.before(f)==h&&o.splice(1,0,-f)}let a=o.indexOf(l),u=[],c=r.openStart;for(let f=r.content,h=0;;h++){let p=f.firstChild;if(u.push(p),h==r.openStart)break;f=p.content}for(let f=c-1;f>=0;f--){let h=u[f],p=AL(h.type);if(p&&!h.sameMarkup(i.node(Math.abs(l)-1)))c=f;else if(p||!h.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let h=(f+c+1)%(r.openStart+1),p=u[h];if(p)for(let m=0;m<o.length;m++){let v=o[(m+a)%o.length],g=!0;v<0&&(g=!1,v=-v);let w=i.node(v-1),y=i.index(v-1);if(w.canReplaceWith(y,y,p.type,p.marks))return t.replace(i.before(v),g?s.after(v):n,new W(Hk(r.content,0,r.openStart,h),h,r.openEnd))}}let d=t.steps.length;for(let f=o.length-1;f>=0&&(t.replace(e,n,r),!(t.steps.length>d));f--){let h=o[f];h<0||(e=i.before(h),n=s.after(h))}}function Hk(t,e,n,r,i){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(Hk(s.content,e+1,n,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(t).append(t);t=o.append(s.matchFragment(o).fillBefore(F.empty,!0))}return t}function RL(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=NL(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new W(F.from(r),0,0))}function PL(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),s=Wk(r,i);for(let o=0;o<s.length;o++){let l=s[o],a=o==s.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return t.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function Wk(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&n.push(i)}return n}class bs extends ft{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return De.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return De.fromReplace(e,this.pos,this.pos+1,new W(F.from(i),0,n.isLeaf?0:1))}getMap(){return Rt.empty}invert(e){return new bs(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new bs(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new bs(n.pos,n.attr,n.value)}}ft.jsonID("attr",bs);class _l extends ft{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return De.ok(r)}getMap(){return Rt.empty}invert(e){return new _l(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new _l(n.attr,n.value)}}ft.jsonID("docAttr",_l);let zs=class extends Error{};zs=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};zs.prototype=Object.create(Error.prototype);zs.prototype.constructor=zs;zs.prototype.name="TransformError";class DL{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new kl}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new zs(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(e=i.map(e,1),n=i.map(n,-1)),i.forEach((s,o,l,a)=>{e=Math.min(e,l),n=Math.max(n,a)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=W.empty){let i=Lc(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new W(F.from(r),0,0))}delete(e,n){return this.replace(e,n,W.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return IL(this,e,n,r),this}replaceRangeWith(e,n,r){return RL(this,e,n,r),this}deleteRange(e,n){return PL(this,e,n),this}lift(e,n){return vL(this,e,n),this}join(e,n=1){return TL(this,e,n),this}wrap(e,n){return SL(this,e,n),this}setBlockType(e,n=e,r,i=null){return bL(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return _L(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new bs(e,n,r)),this}setDocAttribute(e,n){return this.step(new _l(e,n)),this}addNodeMark(e,n){return this.step(new wr(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof ye)n.isInSet(r.marks)&&this.step(new Ti(e,n));else{let i=r.marks,s,o=[];for(;s=n.isInSet(i);)o.push(new Ti(e,s)),i=s.removeFromSet(i);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,n=1,r){return EL(this,e,n,r),this}addMark(e,n,r){return mL(this,e,n,r),this}removeMark(e,n,r){return gL(this,e,n,r),this}clearIncompatible(e,n,r){return cm(this,e,n,r),this}}const qd=Object.create(null);class ae{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new $L(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=W.empty){let r=n.content.lastChild,i=null;for(let l=0;l<n.openEnd;l++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:u}=o[l],c=e.mapping.slice(s);e.replaceRange(c.map(a.pos),c.map(u.pos),l?W.empty:n),l==0&&H0(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],a=e.mapping.slice(r),u=a.map(o.pos),c=a.map(l.pos);s?e.deleteRange(u,c):(e.replaceRangeWith(u,c,n),H0(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new oe(e):Ki(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=n<0?Ki(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):Ki(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new $t(e.node(0))}static atStart(e){return Ki(e,e,0,0,1)||new $t(e)}static atEnd(e){return Ki(e,e,e.content.size,e.childCount,-1)||new $t(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=qd[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in qd)throw new RangeError("Duplicate use of selection JSON ID "+e);return qd[e]=n,n.prototype.jsonID=e,n}getBookmark(){return oe.between(this.$anchor,this.$head).getBookmark()}}ae.prototype.visible=!0;class $L{constructor(e,n){this.$from=e,this.$to=n}}let V0=!1;function U0(t){!V0&&!t.parent.inlineContent&&(V0=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class oe extends ae{constructor(e,n=e){U0(e),U0(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return ae.near(r);let i=e.resolve(n.map(this.anchor));return new oe(i.parent.inlineContent?i:r,r)}replace(e,n=W.empty){if(super.replace(e,n),n==W.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof oe&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new jc(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new oe(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let s=ae.findFrom(n,r,!0)||ae.findFrom(n,-r,!0);if(s)n=s.$head;else return ae.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(ae.findFrom(e,-r,!0)||ae.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new oe(e,n)}}ae.jsonID("text",oe);class jc{constructor(e,n){this.anchor=e,this.head=n}map(e){return new jc(e.map(this.anchor),e.map(this.head))}resolve(e){return oe.between(e.resolve(this.anchor),e.resolve(this.head))}}class ee extends ae{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),s=e.resolve(i);return r?ae.near(s):new ee(s)}content(){return new W(F.from(this.node),0,0)}eq(e){return e instanceof ee&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new fm(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ee(e.resolve(n.anchor))}static create(e,n){return new ee(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ee.prototype.visible=!1;ae.jsonID("node",ee);class fm{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new jc(r,r):new fm(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&ee.isSelectable(r)?new ee(n):ae.near(n)}}class $t extends ae{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=W.empty){if(n==W.empty){e.delete(0,e.doc.content.size);let r=ae.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new $t(e)}map(e){return new $t(e)}eq(e){return e instanceof $t}getBookmark(){return LL}}ae.jsonID("all",$t);const LL={map(){return this},resolve(t){return new $t(t)}};function Ki(t,e,n,r,i,s=!1){if(e.inlineContent)return oe.create(t,n);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&ee.isSelectable(l))return ee.create(t,n-(i<0?l.nodeSize:0))}else{let a=Ki(t,l,n+i,i<0?l.childCount:0,i,s);if(a)return a}n+=l.nodeSize*i}return null}function H0(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Ue||i instanceof We))return;let s=t.mapping.maps[r],o;s.forEach((l,a,u,c)=>{o==null&&(o=c)}),t.setSelection(ae.near(t.doc.resolve(o),n))}const W0=1,Aa=2,q0=4;class jL extends DL{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|W0)&~Aa,this.storedMarks=null,this}get selectionSet(){return(this.updated&W0)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Aa,this}ensureMarks(e){return ye.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Aa)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Aa,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ye.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(n);s=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,s)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(ae.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=q0,this}get scrolledIntoView(){return(this.updated&q0)>0}}function K0(t,e){return!e||!t?t:t.bind(e)}class ko{constructor(e,n,r){this.name=e,this.init=K0(n.init,r),this.apply=K0(n.apply,r)}}const zL=[new ko("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new ko("selection",{init(t,e){return t.selection||ae.atStart(e.doc)},apply(t){return t.selection}}),new ko("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new ko("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Kd{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=zL.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new ko(r.key,r.spec.state,r))})}}class ds{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let a=i?i[o].n:0,u=i?i[o].state:this,c=a<n.length&&l.spec.appendTransaction.call(l,a?n.slice(a):n,u,r);if(c&&r.filterTransaction(c,o)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),s=!0}i&&(i[o]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new ds(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new jL(this)}static create(e){let n=new Kd(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ds(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new Kd(this.schema,e.plugins),r=n.fields,i=new ds(n);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Kd(e.schema,e.plugins),s=new ds(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=Or.fromJSON(e.schema,n.doc);else if(o.name=="selection")s.selection=ae.fromJSON(s.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==o.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){s[o.name]=u.fromJSON.call(a,e,n[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function qk(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=qk(i,e,{})),n[r]=i}return n}class Nt{constructor(e){this.spec=e,this.props={},e.props&&qk(e.props,this,this.props),this.key=e.key?e.key.key:Kk("plugin")}getState(e){return e[this.key]}}const Jd=Object.create(null);function Kk(t){return t in Jd?t+"$"+ ++Jd[t]:(Jd[t]=0,t+"$")}class On{constructor(e="key"){this.key=Kk(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Ze=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Bs=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Ph=null;const Dn=function(t,e,n){let r=Ph||(Ph=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},BL=function(){Ph=null},Ni=function(t,e,n,r){return n&&(J0(t,e,n,r,-1)||J0(t,e,n,r,1))},FL=/^(img|br|input|textarea|hr)$/i;function J0(t,e,n,r,i){for(var s;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Ht(t))){let o=t.parentNode;if(!o||o.nodeType!=1||Hl(t)||FL.test(t.nodeName)||t.contentEditable=="false")return!1;e=Ze(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=i;else return!1;else t=o,e=i<0?Ht(t):0}else return!1}}function Ht(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function VL(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Ht(t)}else if(t.parentNode&&!Hl(t))e=Ze(t),t=t.parentNode;else return null}}function UL(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Hl(t))e=Ze(t)+1,t=t.parentNode;else return null}}function HL(t,e,n){for(let r=e==0,i=e==Ht(t);r||i;){if(t==n)return!0;let s=Ze(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,i=i&&s==Ht(t)}}function Hl(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const zc=function(t){return t.focusNode&&Ni(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Qr(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function WL(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function qL(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Ht(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Ht(r.startContainer),r.startOffset)}}}const Cn=typeof navigator<"u"?navigator:null,G0=typeof document<"u"?document:null,Fr=Cn&&Cn.userAgent||"",Dh=/Edge\/(\d+)/.exec(Fr),Jk=/MSIE \d/.exec(Fr),$h=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Fr),Ct=!!(Jk||$h||Dh),Ar=Jk?document.documentMode:$h?+$h[1]:Dh?+Dh[1]:0,Jt=!Ct&&/gecko\/(\d+)/i.test(Fr);Jt&&+(/Firefox\/(\d+)/.exec(Fr)||[0,0])[1];const Lh=!Ct&&/Chrome\/(\d+)/.exec(Fr),tt=!!Lh,Gk=Lh?+Lh[1]:0,ct=!Ct&&!!Cn&&/Apple Computer/.test(Cn.vendor),Fs=ct&&(/Mobile\/\w+/.test(Fr)||!!Cn&&Cn.maxTouchPoints>2),Ft=Fs||(Cn?/Mac/.test(Cn.platform):!1),Yk=Cn?/Win/.test(Cn.platform):!1,Bn=/Android \d/.test(Fr),Wl=!!G0&&"webkitFontSmoothing"in G0.documentElement.style,KL=Wl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function JL(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function In(t,e){return typeof t=="number"?t:t[e]}function GL(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function Y0(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=n||t.dom;o;){if(o.nodeType!=1){o=Bs(o);continue}let l=o,a=l==s.body,u=a?JL(s):GL(l),c=0,d=0;if(e.top<u.top+In(r,"top")?d=-(u.top-e.top+In(i,"top")):e.bottom>u.bottom-In(r,"bottom")&&(d=e.bottom-e.top>u.bottom-u.top?e.top+In(i,"top")-u.top:e.bottom-u.bottom+In(i,"bottom")),e.left<u.left+In(r,"left")?c=-(u.left-e.left+In(i,"left")):e.right>u.right-In(r,"right")&&(c=e.right-u.right+In(i,"right")),c||d)if(a)s.defaultView.scrollBy(c,d);else{let h=l.scrollLeft,p=l.scrollTop;d&&(l.scrollTop+=d),c&&(l.scrollLeft+=c);let m=l.scrollLeft-h,v=l.scrollTop-p;e={left:e.left-m,top:e.top-v,right:e.right-m,bottom:e.bottom-v}}let f=a?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(f))break;o=f=="absolute"?o.offsetParent:Bs(o)}}function YL(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=t.root.elementFromPoint(s,o);if(!l||l==t.dom||!t.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=n-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:Xk(t.dom)}}function Xk(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Bs(r));return e}function XL({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;Qk(n,r==0?0:r-e)}function Qk(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:s}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Vi=null;function QL(t){if(t.setActive)return t.setActive();if(Vi)return t.focus(Vi);let e=Xk(t);t.focus(Vi==null?{get preventScroll(){return Vi={preventScroll:!0},!0}}:void 0),Vi||(Vi=!1,Qk(e,0))}function Zk(t,e){let n,r=2e8,i,s=0,o=e.top,l=e.top,a,u;for(let c=t.firstChild,d=0;c;c=c.nextSibling,d++){let f;if(c.nodeType==1)f=c.getClientRects();else if(c.nodeType==3)f=Dn(c).getClientRects();else continue;for(let h=0;h<f.length;h++){let p=f[h];if(p.top<=o&&p.bottom>=l){o=Math.max(p.bottom,o),l=Math.min(p.top,l);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){n=c,r=m,i=m&&n.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,c.nodeType==1&&m&&(s=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!a&&p.left<=e.left&&p.right>=e.left&&(a=c,u={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(s=d+1)}}return!n&&a&&(n=a,i=u,r=0),n&&n.nodeType==3?ZL(n,i):!n||r&&n.nodeType==1?{node:t,offset:s}:Zk(n,i)}function ZL(t,e){let n=t.nodeValue.length,r=document.createRange(),i;for(let s=0;s<n;s++){r.setEnd(t,s+1),r.setStart(t,s);let o=ir(r,1);if(o.top!=o.bottom&&hm(e,o)){i={node:t,offset:s+(e.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),i||{node:t,offset:0}}function hm(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function ej(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function tj(t,e,n){let{node:r,offset:i}=Zk(e,n),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,i,s)}function nj(t,e,n,r){let i=-1;for(let s=e,o=!1;s!=t.dom;){let l=t.docView.nearestDesc(s,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&a.left>r.left||a.top>r.top?i=l.posBefore:(!o&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),o=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function e1(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=i;;){let o=t.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(hm(e,u))return e1(o,e,u)}}if((s=(s+1)%r)==i)break}return t}function rj(t,e){let n=t.dom.ownerDocument,r,i=0,s=qL(n,e.left,e.top);s&&({node:r,offset:i}=s);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let u=t.dom.getBoundingClientRect();if(!hm(e,u)||(o=e1(t.dom,e,u),!o))return null}if(ct)for(let u=o;r&&u;u=Bs(u))u.draggable&&(r=void 0);if(o=ej(o,e),r){if(Jt&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],d;c.nodeName=="IMG"&&(d=c.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let u;Wl&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=nj(t,r,i,e))}l==null&&(l=tj(t,o,e));let a=t.docView.nearestDesc(o,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function X0(t){return t.top<t.bottom||t.left<t.right}function ir(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(X0(r))return r}return Array.prototype.find.call(n,X0)||t.getBoundingClientRect()}const ij=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function t1(t,e,n){let{node:r,offset:i,atom:s}=t.docView.domFromPos(e,n<0?-1:1),o=Wl||Jt;if(r.nodeType==3)if(o&&(ij.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let a=ir(Dn(r,i,i),n);if(Jt&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=ir(Dn(r,i-1,i-1),-1);if(u.top==a.top){let c=ir(Dn(r,i,i+1),-1);if(c.top!=a.top)return ho(c,c.left<u.left)}}return a}else{let a=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==r.nodeValue.length?(a--,c=1):n<0?a--:u++,ho(ir(Dn(r,a,u),c),c<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(n<0||i==Ht(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return Gd(a.getBoundingClientRect(),!1)}if(s==null&&i<Ht(r)){let a=r.childNodes[i];if(a.nodeType==1)return Gd(a.getBoundingClientRect(),!0)}return Gd(r.getBoundingClientRect(),n>=0)}if(s==null&&i&&(n<0||i==Ht(r))){let a=r.childNodes[i-1],u=a.nodeType==3?Dn(a,Ht(a)-(o?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return ho(ir(u,1),!1)}if(s==null&&i<Ht(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?Dn(a,0,o?0:1):a.nodeType==1?a:null:null;if(u)return ho(ir(u,-1),!0)}return ho(ir(r.nodeType==3?Dn(r):r,-n),n>=0)}function ho(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Gd(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function n1(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function sj(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return n1(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=t1(t,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Dn(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(n=="up"?o.top-c.top>(c.bottom-o.top)*2:c.bottom-o.bottom>(o.bottom-c.top)*2))return!1}}return!0})}const oj=/[\u0590-\u08ac]/;function lj(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=t.domSelection();return l?!oj.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?s:o:n1(t,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:d}=t.domSelectionRange(),f=l.caretBidiLevel;l.modify("move",n,"character");let h=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:p,focusOffset:m}=t.domSelectionRange(),v=p&&!h.contains(p.nodeType==1?p:p.parentNode)||a==p&&u==m;try{l.collapse(c,d),a&&(a!=c||u!=d)&&l.extend&&l.extend(a,u)}catch{}return f!=null&&(l.caretBidiLevel=f),v}):r.pos==r.start()||r.pos==r.end()}let Q0=null,Z0=null,ev=!1;function aj(t,e,n){return Q0==e&&Z0==n?ev:(Q0=e,Z0=n,ev=n=="up"||n=="down"?sj(t,e,n):lj(t,e,n))}const Gt=0,tv=1,si=2,Tn=3;class ql{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Gt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>Ze(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!n||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let l=i.children[o];if(l.size){i=l;break}}return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>e||o instanceof i1){i=e-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof r1&&s.side>=0;r--);if(n<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&n&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?Ze(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?Ze(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let a=this.children[l],u=o+a.size;if(i==-1&&e<=u){let c=o+a.border;if(e>=c&&n<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,n,c);e=o;for(let d=l;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=Ze(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(u>n||l==this.children.length-1)){n=u;for(let c=l+1;c<this.children.length;c++){let d=this.children[c];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=Ze(d.dom);break}n+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=u}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let s=Math.min(e,n),o=Math.max(e,n);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],v=p+m.size;if(s>p&&o<v)return m.setSelection(e-p-m.border,n-p-m.border,r,i);p=v}let l=this.domFromPos(e,e?-1:1),a=n==e?l:this.domFromPos(n,n?-1:1),u=r.root.getSelection(),c=r.domSelectionRange(),d=!1;if((Jt||ct)&&e==n){let{node:h,offset:p}=l;if(h.nodeType==3){if(d=!!(p&&h.nodeValue[p-1]==`
`),d&&p==h.nodeValue.length)for(let m=h,v;m;m=m.parentNode){if(v=m.nextSibling){v.nodeName=="BR"&&(l=a={node:v.parentNode,offset:Ze(v)+1});break}let g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let m=h.childNodes[p-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Jt&&c.focusNode&&c.focusNode!=a.node&&c.focusNode.nodeType==1){let h=c.focusNode.childNodes[c.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||d&&ct)&&Ni(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Ni(a.node,a.offset,c.focusNode,c.focusOffset))return;let f=!1;if((u.extend||e==n)&&!(d&&Jt)){u.collapse(l.node,l.offset);try{e!=n&&u.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>n){let p=l;l=a,a=p}let h=document.createRange();h.setEnd(a.node,a.offset),h.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let l=r+s.border,a=o-s.border;if(e>=l&&n<=a){this.dirty=e==r||n==o?si:tv,e==l&&n==a&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Tn:s.markDirty(e-l,n-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?si:Tn}r=o}this.dirty=si}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?si:tv;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class r1 extends ql{constructor(e,n,r,i){let s,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==Gt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class uj extends ql{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Oi extends ql{constructor(e,n,r,i,s){super(e,[],r,i),this.mark=n,this.spec=s}static create(e,n,r,i){let s=i.nodeViews[n.type.name],o=s&&s(n,i,r);return(!o||!o.dom)&&(o=Ii.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Oi(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Tn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Tn&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Gt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Gt}}slice(e,n,r){let i=Oi.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;n<o&&(s=zh(s,n,o,r)),e>0&&(s=zh(s,0,e,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ir extends ql{constructor(e,n,r,i,s,o,l,a,u){super(e,[],s,o),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,n,r,i,s,o){let l=s.nodeViews[n.type.name],a,u=l&&l(n,s,()=>{if(!a)return o;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,d=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:d}=Ii.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let f=c;return c=l1(c,r,n),u?a=new cj(e,n,r,i,c,d||null,f,u,s,o+1):n.isText?new Bc(e,n,r,i,c,f,s):new Ir(e,n,r,i,c,d||null,f,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>F.empty)}return e}matchesNode(e,n,r){return this.dirty==Gt&&e.eq(this.node)&&Ku(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,s=e.composing?this.localCompositionInfo(e,n):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,a=new fj(this,o&&o.node,e);mj(this.node,this.innerDeco,(u,c,d)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e,c):u.type.side>=0&&!d&&a.syncToMarks(c==this.node.childCount?ye.none:this.node.child(c).marks,r,e,c),a.placeWidget(u,e,i)},(u,c,d,f)=>{a.syncToMarks(u.marks,r,e,f);let h;a.findNodeMatch(u,c,d,f)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(h=a.findIndexWithChild(s.node))>-1&&a.updateNodeAt(u,c,d,h,e)||a.updateNextNode(u,c,d,e,f,i)||a.addNode(u,c,d,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e,0),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==si)&&(o&&this.protectLocalComposition(e,o),s1(this.contentDOM,this.children,e),Fs&&gj(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof oe)||r<n||i>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=yj(this.node.content,o,r-n,i-n);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new uj(this,s,n,i);e.input.compositionNodes.push(o),this.children=zh(this.children,r,r+i.length,e,o)}update(e,n,r,i){return this.dirty==Tn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Gt}updateOuterDeco(e){if(Ku(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=o1(this.dom,this.nodeDOM,jh(this.outerDeco,this.node,n),jh(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function nv(t,e,n,r,i){l1(r,e,t);let s=new Ir(void 0,t,e,n,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class Bc extends Ir{constructor(e,n,r,i,s,o,l){super(e,n,r,i,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Tn||this.dirty!=Gt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Gt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Gt,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),s=document.createTextNode(i.text);return new Bc(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Tn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class i1 extends ql{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Gt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class cj extends Ir{constructor(e,n,r,i,s,o,l,a,u,c){super(e,n,r,i,s,o,l,u,c),this.spec=a}update(e,n,r,i){if(this.dirty==Tn)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function s1(t,e,n){let r=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==t){for(;l!=r;)r=rv(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(l,r);if(o instanceof Oi){let a=r?r.previousSibling:t.lastChild;s1(o.contentDOM,o.children,n),r=a?a.nextSibling:t.firstChild}}for(;r;)r=rv(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const Bo=function(t){t&&(this.nodeName=t)};Bo.prototype=Object.create(null);const oi=[new Bo];function jh(t,e,n){if(t.length==0)return oi;let r=n?oi[0]:new Bo,i=[r];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(o){o.nodeName&&i.push(r=new Bo(o.nodeName));for(let l in o){let a=o[l];a!=null&&(n&&i.length==1&&i.push(r=new Bo(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function o1(t,e,n,r){if(n==oi&&r==oi)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],l=n[s];if(s){let a;l&&l.nodeName==o.nodeName&&i!=t&&(a=i.parentNode)&&a.nodeName.toLowerCase()==o.nodeName||(a=document.createElement(o.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=oi[0]),i=a}dj(i,l||oi[0],o)}return i}function dj(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&t.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&t.classList.add(i[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function l1(t,e,n){return o1(t,t,oi,jh(e,n,t.nodeType!=1))}function Ku(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function rv(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class fj{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=hj(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r,i){let s=0,o=this.stack.length>>1,l=Math.min(o,e.length);for(;s<l&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=Gt,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1,u=this.top.children.length;i<this.preMatch.index&&(u=Math.min(this.index+3,u));for(let c=this.index;c<u;c++){let d=this.top.children[c];if(d.matchesMark(e[o])&&!this.isLocked(d.dom)){a=c;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let c=Oi.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,n,r)&&!this.preMatch.matched.has(u)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,r,i,s){let o=this.top.children[i];return o.dirty==Tn&&o.dom==o.contentDOM&&(o.dirty=si),o.update(e,n,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Ir){let u=this.preMatch.matched.get(a);if(u!=null&&u!=s)return!1;let c=a.dom,d,f=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Tn&&Ku(n,a.outerDeco));if(!f&&a.update(e,n,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(a,e,n,r,i,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=si,d.updateChildren(i,o+1),d.dirty=Gt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,s,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Ku(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=Ir.create(this.top,n,r,i,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,n,r,i,s){let o=Ir.create(this.top,e,n,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new r1(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Oi;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Bc)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((ct||tt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new i1(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function hj(t,e){let n=e,r=n.children.length,i=t.childCount,s=new Map,o=[];e:for(;i>0;){let l;for(;;)if(r){let u=n.children[r-1];if(u instanceof Oi)n=u,r=u.children.length;else{l=u,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let a=l.node;if(a){if(a!=t.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function pj(t,e){return t.type.side-e.type.side}function mj(t,e,n,r){let i=e.locals(t),s=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);r(c,i,e.forChild(s,c),u),s+=c.nodeSize}return}let o=0,l=[],a=null;for(let u=0;;){let c,d;for(;o<i.length&&i[o].to==s;){let v=i[o++];v.widget&&(c?(d||(d=[c])).push(v):c=v)}if(c)if(d){d.sort(pj);for(let v=0;v<d.length;v++)n(d[v],u,!!a)}else n(c,u,!!a);let f,h;if(a)h=-1,f=a,a=null;else if(u<t.childCount)h=u,f=t.child(u++);else break;for(let v=0;v<l.length;v++)l[v].to<=s&&l.splice(v--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let p=s+f.nodeSize;if(f.isText){let v=p;o<i.length&&i[o].from<v&&(v=i[o].from);for(let g=0;g<l.length;g++)l[g].to<v&&(v=l[g].to);v<p&&(a=f.cut(v-s),f=f.cut(0,v-s),p=v,h=-1)}else for(;o<i.length&&i[o].to<p;)o++;let m=f.isInline&&!f.isLeaf?l.filter(v=>!v.inline):l.slice();r(f,m,e.forChild(s,f),h),s=p}}function gj(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function yj(t,e,n,r){for(let i=0,s=0;i<t.childCount&&s<=r;){let o=t.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let a=o.text;for(;i<t.childCount;){let u=t.child(i++);if(s+=u.nodeSize,!u.isText)break;a+=u.text}if(s>=n){if(s>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=n)return l+u;if(n==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function zh(t,e,n,r,i){let s=[];for(let o=0,l=0;o<t.length;o++){let a=t[o],u=l,c=l+=a.size;u>=n||c<=e?s.push(a):(u<e&&s.push(a.slice(0,e-u,r)),i&&(s.push(i),i=void 0),c>n&&s.push(a.slice(n-u,a.size,r)))}return s}function pm(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),s=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l=r.resolve(o),a,u;if(zc(n)){for(a=o;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&ee.isSelectable(d)&&i.parent&&!(d.isInline&&HL(n.focusNode,n.focusOffset,i.dom))){let f=i.posBefore;u=new ee(o==f?l:r.resolve(f))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=o,f=o;for(let h=0;h<n.rangeCount;h++){let p=n.getRangeAt(h);d=Math.min(d,t.docView.posFromDOM(p.startContainer,p.startOffset,1)),f=Math.max(f,t.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[a,o]=f==t.state.selection.anchor?[f,d]:[d,f],l=r.resolve(o)}else a=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let c=r.resolve(a);if(!u){let d=e=="pointer"||t.state.selection.head<l.pos&&!s?1:-1;u=mm(t,c,l,d)}return u}function a1(t){return t.editable?t.hasFocus():c1(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Hn(t,e=!1){let n=t.state.selection;if(u1(t,n),!!a1(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&tt){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Ni(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)wj(t);else{let{anchor:r,head:i}=n,s,o;iv&&!(n instanceof oe)&&(n.$from.parent.inlineContent||(s=sv(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=sv(t,n.to))),t.docView.setSelection(r,i,t,e),iv&&(s&&ov(s),o&&ov(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&vj(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const iv=ct||tt&&Gk<63;function sv(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(ct&&i&&i.contentEditable=="false")return Yd(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Yd(i);if(s)return Yd(s)}}function Yd(t){return t.contentEditable="true",ct&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function ov(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function vj(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!a1(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function wj(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Ze(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&Ct&&Ar<=11&&(n.disabled=!0,n.disabled=!1)}function u1(t,e){if(e instanceof ee){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(lv(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else lv(t)}function lv(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function mm(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||oe.between(e,n,r)}function av(t){return t.editable&&!t.hasFocus()?!1:c1(t)}function c1(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function xj(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Ni(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Bh(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&ae.findFrom(s,e)}function ar(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function uv(t,e,n){let r=t.state.selection;if(r instanceof oe)if(n.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return ar(t,new oe(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=Bh(t.state,e);return i&&i instanceof ee?ar(t,i):!1}else if(!(Ft&&n.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=t.docView.descAt(l))&&!o.contentDOM?ee.isSelectable(s)?ar(t,new ee(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):Wl?ar(t,new oe(t.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ee&&r.node.isInline)return ar(t,new oe(e>0?r.$to:r.$from));{let i=Bh(t.state,e);return i?ar(t,i):!1}}}function Ju(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Fo(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ui(t,e){return e<0?Sj(t):bj(t)}function Sj(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,s,o=!1;for(Jt&&n.nodeType==1&&r<Ju(n)&&Fo(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(Fo(l,-1))i=n,s=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(d1(n))break;{let l=n.previousSibling;for(;l&&Fo(l,-1);)i=n.parentNode,s=Ze(l),l=l.previousSibling;if(l)n=l,r=Ju(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?Fh(t,n,r):i&&Fh(t,i,s)}function bj(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Ju(n),s,o;for(;;)if(r<i){if(n.nodeType!=1)break;let l=n.childNodes[r];if(Fo(l,1))s=n,o=++r;else break}else{if(d1(n))break;{let l=n.nextSibling;for(;l&&Fo(l,1);)s=l.parentNode,o=Ze(l)+1,l=l.nextSibling;if(l)n=l,r=0,i=Ju(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}s&&Fh(t,s,o)}function d1(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function kj(t,e){for(;t&&e==t.childNodes.length&&!Hl(t);)e=Ze(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function _j(t,e){for(;t&&!e&&!Hl(t);)e=Ze(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Fh(t,e,n){if(e.nodeType!=3){let s,o;(o=kj(e,n))?(e=o,n=0):(s=_j(e,n))&&(e=s,n=s.nodeValue.length)}let r=t.domSelection();if(!r)return;if(zc(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Hn(t)},50)}function cv(t,e){let n=t.state.doc.resolve(e);if(!(tt||Yk)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function dv(t,e,n){let r=t.state.selection;if(r instanceof oe&&!r.empty||n.indexOf("s")>-1||Ft&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=Bh(t.state,e);if(o&&o instanceof ee)return ar(t,o)}if(!i.parent.inlineContent){let o=e<0?i:s,l=r instanceof $t?ae.near(o,e):ae.findFrom(o,e);return l?ar(t,l):!1}return!1}function fv(t,e){if(!(t.state.selection instanceof oe))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let o=t.state.tr;return e<0?o.delete(n.pos-s.nodeSize,n.pos):o.delete(n.pos,n.pos+s.nodeSize),t.dispatch(o),!0}return!1}function hv(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Ej(t){if(!ct||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;hv(t,r,"true"),setTimeout(()=>hv(t,r,"false"),20)}return!1}function Cj(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Tj(t,e){let n=e.keyCode,r=Cj(e);if(n==8||Ft&&n==72&&r=="c")return fv(t,-1)||Ui(t,-1);if(n==46&&!e.shiftKey||Ft&&n==68&&r=="c")return fv(t,1)||Ui(t,1);if(n==13||n==27)return!0;if(n==37||Ft&&n==66&&r=="c"){let i=n==37?cv(t,t.state.selection.from)=="ltr"?-1:1:-1;return uv(t,i,r)||Ui(t,i)}else if(n==39||Ft&&n==70&&r=="c"){let i=n==39?cv(t,t.state.selection.from)=="ltr"?1:-1:1;return uv(t,i,r)||Ui(t,i)}else{if(n==38||Ft&&n==80&&r=="c")return dv(t,-1,r)||Ui(t,-1);if(n==40||Ft&&n==78&&r=="c")return Ej(t)||dv(t,1,r)||Ui(t,1);if(r==(Ft?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function gm(t,e){t.someProp("transformCopied",h=>{e=h(e,t)});let n=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let h=r.firstChild;n.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let o=t.someProp("clipboardSerializer")||Ii.fromSchema(t.state.schema),l=y1(),a=l.createElement("div");a.appendChild(o.serializeFragment(r,{document:l}));let u=a.firstChild,c,d=0;for(;u&&u.nodeType==1&&(c=g1[u.nodeName.toLowerCase()]);){for(let h=c.length-1;h>=0;h--){let p=l.createElement(c[h]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),d++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(n)}`);let f=t.someProp("clipboardTextSerializer",h=>h(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:f,slice:e}}function f1(t,e,n,r,i){let s=i.parent.type.spec.code,o,l;if(!n&&!e)return null;let a=!!e&&(r||s||!n);if(a){if(t.someProp("transformPastedText",f=>{e=f(e,s||r,t)}),s)return l=new W(F.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",f=>{l=f(l,t,!0)}),l;let d=t.someProp("clipboardTextParser",f=>f(e,i,r,t));if(d)l=d;else{let f=i.marks(),{schema:h}=t.state,p=Ii.fromSchema(h);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let v=o.appendChild(document.createElement("p"));m&&v.appendChild(p.serializeNode(h.text(m,f)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),o=Aj(n),Wl&&Ij(o);let u=o&&o.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let d=+c[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||Mr.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!Nj.test(f.parentNode.nodeName)?{ignore:!0}:null}})),c)l=Rj(pv(l,+c[1],+c[2]),c[4]);else if(l=W.maxOpen(Oj(l.content,i),!0),l.openStart||l.openEnd){let d=0,f=0;for(let h=l.content.firstChild;d<l.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=l.content.lastChild;f<l.openEnd&&!h.type.spec.isolating;f++,h=h.lastChild);l=pv(l,d,f)}return t.someProp("transformPasted",d=>{l=d(l,t,a)}),l}const Nj=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Oj(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),s,o=[];if(t.forEach(l=>{if(!o)return;let a=i.findWrapping(l.type),u;if(!a)return o=null;if(u=o.length&&s.length&&p1(a,s,l,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=m1(o[o.length-1],s.length));let c=h1(l,a);o.push(c),i=i.matchType(c.type),s=a}}),o)return F.from(o)}return t}function h1(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,F.from(t));return t}function p1(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=p1(t,e,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(F.from(h1(n,t,i+1))))}}function m1(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,m1(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(F.empty,!0);return t.copy(n.append(r))}function Vh(t,e,n,r,i,s){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(s=0),i<r-1&&(l=Vh(l,e,n,r,i+1,s)),i>=n&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(F.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function pv(t,e,n){return e<t.openStart&&(t=new W(Vh(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new W(Vh(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const g1={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let mv=null;function y1(){return mv||(mv=document.implementation.createHTMLDocument("title"))}let Xd=null;function Mj(t){let e=window.trustedTypes;return e?(Xd||(Xd=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Xd.createHTML(t)):t}function Aj(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=y1().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&g1[r[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=Mj(t),i)for(let s=0;s<i.length;s++)n=n.querySelector(i[s])||n;return n}function Ij(t){let e=t.querySelectorAll(tt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Rj(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let l=r.length-2;l>=0;l-=2){let a=n.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=F.from(a.create(r[l+1],i)),s++,o++}return new W(i,s,o)}const mt={},gt={},Pj={touchstart:!0,touchmove:!0};class Dj{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function $j(t){for(let e in mt){let n=mt[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{jj(t,r)&&!ym(t,r)&&(t.editable||!(r.type in gt))&&n(t,r)},Pj[e]?{passive:!0}:void 0)}ct&&t.dom.addEventListener("input",()=>null),Uh(t)}function xr(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Lj(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Uh(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>ym(t,r))})}function ym(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function jj(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function zj(t,e){!ym(t,e)&&mt[e.type]&&(t.editable||!(e.type in gt))&&mt[e.type](t,e)}gt.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!w1(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Bn&&tt&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Fs&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Qr(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Tj(t,n)?n.preventDefault():xr(t,"key")};gt.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};gt.keypress=(t,e)=>{let n=e;if(w1(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Ft&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof oe)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),s=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i,s))&&t.dispatch(s()),n.preventDefault()}};function Fc(t){return{left:t.clientX,top:t.clientY}}function Bj(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function vm(t,e,n,r,i){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,l=>o>s.depth?l(t,n,s.nodeAfter,s.before(o),i,!0):l(t,n,s.node(o),s.before(o),i,!1)))return!0;return!1}function ks(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function Fj(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&ee.isSelectable(r)?(ks(t,new ee(n)),!0):!1}function Vj(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof ee&&(r=n.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(ee.isSelectable(l)){r&&n.$from.depth>0&&o>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?i=s.before(n.$from.depth):i=s.before(o);break}}return i!=null?(ks(t,ee.create(t.state.doc,i)),!0):!1}function Uj(t,e,n,r,i){return vm(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(i?Vj(t,n):Fj(t,n))}function Hj(t,e,n,r){return vm(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function Wj(t,e,n,r){return vm(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||qj(t,n,r)}function qj(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(ks(t,oe.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)ks(t,oe.create(r,l+1,l+1+o.content.size));else if(ee.isSelectable(o))ks(t,ee.create(r,l));else continue;return!0}}function wm(t){return Gu(t)}const v1=Ft?"metaKey":"ctrlKey";mt.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=wm(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&Bj(n,t.input.lastClick)&&!n[v1]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s,button:n.button};let o=t.posAtCoords(Fc(n));o&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new Kj(t,o,n,!!r)):(s=="doubleClick"?Hj:Wj)(t,o.pos,o.inside,n)?n.preventDefault():xr(t,"pointer"))};class Kj{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[v1],this.allowDefault=r.shiftKey;let s,o;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),o=n.inside;else{let c=e.state.doc.resolve(n.pos);s=c.parent,o=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.nodeDOM.nodeType==1?a.nodeDOM:null;let{selection:u}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof ee&&u.from<=o&&u.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Jt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),xr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Hn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Fc(e))),this.updateAllowDefault(e),this.allowDefault||!n?xr(this.view,"pointer"):Uj(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||ct&&this.mightDrag&&!this.mightDrag.node.isAtom||tt&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(ks(this.view,ae.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):xr(this.view,"pointer")}move(e){this.updateAllowDefault(e),xr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}mt.touchstart=t=>{t.input.lastTouch=Date.now(),wm(t),xr(t,"pointer")};mt.touchmove=t=>{t.input.lastTouch=Date.now(),xr(t,"pointer")};mt.contextmenu=t=>wm(t);function w1(t,e){return t.composing?!0:ct&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const Jj=Bn?5e3:-1;gt.compositionstart=gt.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof oe&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||tt&&Yk&&Gj(t)))t.markCursor=t.state.storedMarks||n.marks(),Gu(t,!0),t.markCursor=null;else if(Gu(t,!e.selection.empty),Jt&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=t.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}t.input.composing=!0}x1(t,Jj)};function Gj(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}gt.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,x1(t,20))};function x1(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Gu(t),e))}function S1(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=Xj());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Yj(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=VL(e.focusNode,e.focusOffset),r=UL(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(n==s||r==s)return s;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function Xj(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Gu(t,e=!1){if(!(Bn&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),S1(t),e||t.docView&&t.docView.dirty){let n=pm(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function Qj(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const El=Ct&&Ar<15||Fs&&KL<604;mt.copy=gt.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let s=El?null:n.clipboardData,o=r.content(),{dom:l,text:a}=gm(t,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",a)):Qj(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Zj(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function ez(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Cl(t,r.value,null,i,e):Cl(t,r.textContent,r.innerHTML,i,e)},50)}function Cl(t,e,n,r,i){let s=f1(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,i,s||W.empty)))return!0;if(!s)return!1;let o=Zj(s),l=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(s);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function b1(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}gt.paste=(t,e)=>{let n=e;if(t.composing&&!Bn)return;let r=El?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Cl(t,b1(r),r.getData("text/html"),i,n)?n.preventDefault():ez(t,n)};class k1{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const tz=Ft?"altKey":"ctrlKey";function _1(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[tz]}mt.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(Fc(n)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof ee?i.to-1:i.to))){if(r&&r.mightDrag)o=ee.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(o=ee.create(t.state.doc,d.posBefore))}}let l=(o||t.state.selection).content(),{dom:a,text:u,slice:c}=gm(t,l);(!n.dataTransfer.files.length||!tt||Gk>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(El?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",El||n.dataTransfer.setData("text/plain",u),t.dragging=new k1(c,_1(t,n),o)};mt.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};gt.dragover=gt.dragenter=(t,e)=>e.preventDefault();gt.drop=(t,e)=>{try{nz(t,e,t.dragging)}finally{t.dragging=null}};function nz(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(Fc(e));if(!r)return;let i=t.state.doc.resolve(r.pos),s=n&&n.slice;s?t.someProp("transformPasted",h=>{s=h(s,t,!1)}):s=f1(t,b1(e.dataTransfer),El?null:e.dataTransfer.getData("text/html"),!1,i);let o=!!(n&&_1(t,e));if(t.someProp("handleDrop",h=>h(t,e,s||W.empty,o))){e.preventDefault();return}if(!s)return;e.preventDefault();let l=s?Fk(t.state.doc,i.pos,s):i.pos;l==null&&(l=i.pos);let a=t.state.tr;if(o){let{node:h}=n;h?h.replace(a):a.deleteSelection()}let u=a.mapping.map(l),c=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,d=a.doc;if(c?a.replaceRangeWith(u,u,s.content.firstChild):a.replaceRange(u,u,s),a.doc.eq(d))return;let f=a.doc.resolve(u);if(c&&ee.isSelectable(s.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(s.content.firstChild))a.setSelection(new ee(f));else{let h=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((p,m,v,g)=>h=g),a.setSelection(mm(t,f,a.doc.resolve(h)))}t.focus(),t.dispatch(a.setMeta("uiEvent","drop"))}mt.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Hn(t)},20))};mt.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};mt.beforeinput=(t,e)=>{if(tt&&Bn&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Qr(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in gt)mt[t]=gt[t];function Tl(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Yu{constructor(e,n){this.toDOM=e,this.spec=n||pi,this.side=this.spec.side||0}map(e,n,r,i){let{pos:s,deleted:o}=e.mapResult(n.from+i,this.side<0?-1:1);return o?null:new qt(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Yu&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Tl(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Rr{constructor(e,n){this.attrs=e,this.spec=n||pi}map(e,n,r,i){let s=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new qt(s,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Rr&&Tl(this.attrs,e.attrs)&&Tl(this.spec,e.spec)}static is(e){return e.type instanceof Rr}destroy(){}}class xm{constructor(e,n){this.attrs=e,this.spec=n||pi}map(e,n,r,i){let s=e.mapResult(n.from+i,1);if(s.deleted)return null;let o=e.mapResult(n.to+i,-1);return o.deleted||o.pos<=s.pos?null:new qt(s.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),s;return i==n.from&&!(s=e.child(r)).isText&&i+s.nodeSize==n.to}eq(e){return this==e||e instanceof xm&&Tl(this.attrs,e.attrs)&&Tl(this.spec,e.spec)}destroy(){}}class qt{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new qt(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new qt(e,e,new Yu(n,r))}static inline(e,n,r,i){return new qt(e,n,new Rr(r,i))}static node(e,n,r,i){return new qt(e,n,new xm(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Rr}get widget(){return this.type instanceof Yu}}const Ji=[],pi={};class ze{constructor(e,n){this.local=e.length?e:Ji,this.children=n.length?n:Ji}static create(e,n){return n.length?Xu(n,e,0,pi):lt}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=n&&l.to>=e&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,n-l,r,i+l,s)}}map(e,n,r){return this==lt||e.maps.length==0?this:this.mapInner(e,n,0,0,r||pi)}mapInner(e,n,r,i,s){let o;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(n,a)?(o||(o=[])).push(a):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?rz(this.children,o||[],e,n,r,i,s):o?new ze(o.sort(mi),Ji):lt}add(e,n){return n.length?this==lt?ze.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,s=0;e.forEach((l,a)=>{let u=a+r,c;if(c=C1(n,l,u)){for(i||(i=this.children.slice());s<i.length&&i[s]<a;)s+=3;i[s]==a?i[s+2]=i[s+2].addInner(l,c,u+1):i.splice(s,0,a,a+l.nodeSize,Xu(c,l,u+1,pi)),s+=3}});let o=E1(s?T1(n):n,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new ze(o.length?this.local.concat(o).sort(mi):this.local,i||this.children)}remove(e){return e.length==0||this==lt?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+n,a=r[s+1]+n;for(let c=0,d;c<e.length;c++)(d=e[c])&&d.from>l&&d.to<a&&(e[c]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let u=r[s+2].removeInner(o,l+1);u!=lt?r[s+2]=u:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new ze(i,r):lt}forChild(e,n){if(this==lt)return this;if(n.isLeaf)return ze.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let s=e+1,o=s+n.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<o&&a.to>s&&a.type instanceof Rr){let u=Math.max(s,a.from)-s,c=Math.min(o,a.to)-s;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new ze(i.sort(mi),Ji);return r?new pr([l,r]):l}return r||lt}eq(e){if(this==e)return!0;if(!(e instanceof ze)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Sm(this.localsInner(e))}localsInner(e){if(this==lt)return Ji;if(e.inlineContent||!this.local.some(Rr.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Rr||n.push(this.local[r]);return n}forEachSet(e){e(this)}}ze.empty=new ze([],[]);ze.removeOverlap=Sm;const lt=ze.empty;class pr{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,pi));return pr.from(r)}forChild(e,n){if(n.isLeaf)return ze.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,n);s!=lt&&(s instanceof pr?r=r.concat(s.members):r.push(s))}return pr.from(r)}eq(e){if(!(e instanceof pr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let o=0;o<s.length;o++)n.push(s[o])}}return n?Sm(r?n:n.sort(mi)):Ji}static from(e){switch(e.length){case 0:return lt;case 1:return e[0];default:return new pr(e.every(n=>n instanceof ze)?e:e.reduce((n,r)=>n.concat(r instanceof ze?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function rz(t,e,n,r,i,s,o){let l=t.slice();for(let u=0,c=s;u<n.maps.length;u++){let d=0;n.maps[u].forEach((f,h,p,m)=>{let v=m-p-(h-f);for(let g=0;g<l.length;g+=3){let w=l[g+1];if(w<0||f>w+c-d)continue;let y=l[g]+c-d;h>=y?l[g+1]=f<=y?-2:-1:f>=c&&v&&(l[g]+=v,l[g+1]+=v)}d+=v}),c=n.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=n.map(t[u]+s),d=c-i;if(d<0||d>=r.content.size){a=!0;continue}let f=n.map(t[u+1]+s,-1),h=f-i,{index:p,offset:m}=r.content.findIndex(d),v=r.maybeChild(p);if(v&&m==d&&m+v.nodeSize==h){let g=l[u+2].mapInner(n,v,c+1,t[u]+s+1,o);g!=lt?(l[u]=d,l[u+1]=h,l[u+2]=g):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=iz(l,t,e,n,i,s,o),c=Xu(u,r,0,o);e=c.local;for(let d=0;d<l.length;d+=3)l[d+1]<0&&(l.splice(d,3),d-=3);for(let d=0,f=0;d<c.children.length;d+=3){let h=c.children[d];for(;f<l.length&&l[f]<h;)f+=3;l.splice(f,0,c.children[d],c.children[d+1],c.children[d+2])}}return new ze(e.sort(mi),l)}function E1(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new qt(i.from+e,i.to+e,i.type))}return n}function iz(t,e,n,r,i,s,o){function l(a,u){for(let c=0;c<a.local.length;c++){let d=a.local[c].map(r,i,u);d?n.push(d):o.onRemove&&o.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<t.length;a+=3)t[a+1]==-1&&l(t[a+2],e[a]+s+1);return n}function C1(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let s=0,o;s<t.length;s++)(o=t[s])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),t[s]=null);return i}function T1(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Xu(t,e,n,r){let i=[],s=!1;e.forEach((l,a)=>{let u=C1(t,l,a+n);if(u){s=!0;let c=Xu(u,l,n+a+1,r);c!=lt&&i.push(a,a+l.nodeSize,c)}});let o=E1(s?T1(t):t,-n).sort(mi);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new ze(o,i):lt}function mi(t,e){return t.from-e.from||t.to-e.to}function Sm(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,r.to),gv(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),gv(e,i,r.copy(s.from,r.to)));break}}}return e}function gv(t,e,n){for(;e<t.length&&mi(n,t[e])>0;)e++;t.splice(e,0,n)}function Qd(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=lt&&e.push(r)}),t.cursorWrapper&&e.push(ze.create(t.state.doc,[t.cursorWrapper.deco])),pr.from(e)}const sz={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},oz=Ct&&Ar<=11;class lz{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class az{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new lz,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Ct&&Ar<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():ct&&e.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),oz&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,sz)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(av(this.view)){if(this.suppressingSelectionUpdates)return Hn(this.view);if(Ct&&Ar<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ni(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let s=e.focusNode;s;s=Bs(s))n.add(s);for(let s=e.anchorNode;s;s=Bs(s))if(n.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&av(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,a=[];if(e.editable)for(let c=0;c<n.length;c++){let d=this.registerMutation(n[c],a);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(l=!0))}if(a.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of a)if(c.nodeName=="BR"&&c.parentNode){let d=c.nextSibling;d&&d.nodeType==1&&d.contentEditable=="false"&&c.parentNode.removeChild(c)}}else if(Jt&&a.length){let c=a.filter(d=>d.nodeName=="BR");if(c.length==2){let[d,f]=c;d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let f of c){let h=f.parentNode;h&&h.nodeName=="LI"&&(!d||dz(e,d)!=h)&&f.remove()}}}let u=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&zc(r)&&(u=pm(e))&&u.eq(ae.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Hn(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),uz(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,fz(e,a)),this.handleDOMChange(s,o,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Hn(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let d=e.addedNodes[c];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Ct&&Ar<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:d,nextSibling:f}=e.addedNodes[c];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f)}let o=i&&i.parentNode==e.target?Ze(i)+1:0,l=r.localPosFromDOM(e.target,o,-1),a=s&&s.parentNode==e.target?Ze(s):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let yv=new WeakMap,vv=!1;function uz(t){if(!yv.has(t)&&(yv.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Jt,vv)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),vv=!0}}function wv(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return Ni(o.node,o.offset,i,s)&&([n,r,i,s]=[i,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}}function cz(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return wv(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?wv(t,n):null}function dz(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function fz(t,e){var n;let{focusNode:r,focusOffset:i}=t.domSelectionRange();for(let s of e)if(((n=s.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let o=s.nextSibling;for(;o&&o.nodeName!="TD"&&o.nodeName!="TH";)o=o.nextSibling;if(o){let l=o;for(;;){let a=l.firstChild;if(!a||a.nodeType!=1||a.contentEditable=="false"||/^(BR|IMG)$/.test(a.nodeName))break;l=a}l.insertBefore(s,l.firstChild),r==s&&t.domSelection().collapse(s,i)}else s.parentNode.removeChild(s)}}function hz(t,e,n){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=t.docView.parseRange(e,n),a=t.domSelectionRange(),u,c=a.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],zc(a)||u.push({node:a.focusNode,offset:a.focusOffset})),tt&&t.input.lastKeyCode===8)for(let v=s;v>i;v--){let g=r.childNodes[v-1],w=g.pmViewDesc;if(g.nodeName=="BR"&&!w){s=v;break}if(!w||w.size)break}let d=t.state.doc,f=t.someProp("domParser")||Mr.fromSchema(t.state.schema),h=d.resolve(o),p=null,m=f.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:s,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:pz,context:h});if(u&&u[0].pos!=null){let v=u[0].pos,g=u[1]&&u[1].pos;g==null&&(g=v),p={anchor:v+o,head:g+o}}return{doc:m,sel:p,from:o,to:l}}function pz(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(ct&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||ct&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const mz=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function gz(t,e,n,r,i){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let b=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,E=pm(t,b);if(E&&!t.state.selection.eq(E)){if(tt&&Bn&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",L=>L(t,Qr(13,"Enter"))))return;let O=t.state.tr.setSelection(E);b=="pointer"?O.setMeta("pointer",!0):b=="key"&&O.scrollIntoView(),s&&O.setMeta("composition",s),t.dispatch(O)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(n);e=o.before(l+1),n=t.state.doc.resolve(n).after(l+1);let a=t.state.selection,u=hz(t,e,n),c=t.state.doc,d=c.slice(u.from,u.to),f,h;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(f=t.state.selection.to,h="end"):(f=t.state.selection.from,h="start"),t.input.lastKeyCode=null;let p=wz(d.content,u.doc.content,u.from,f,h);if(p&&t.input.domChangeCount++,(Fs&&t.input.lastIOSEnter>Date.now()-225||Bn)&&i.some(b=>b.nodeType==1&&!mz.test(b.nodeName))&&(!p||p.endA>=p.endB)&&t.someProp("handleKeyDown",b=>b(t,Qr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!p)if(r&&a instanceof oe&&!a.empty&&a.$head.sameParent(a.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))p={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let b=xv(t,t.state.doc,u.sel);if(b&&!b.eq(t.state.selection)){let E=t.state.tr.setSelection(b);s&&E.setMeta("composition",s),t.dispatch(E)}}return}t.state.selection.from<t.state.selection.to&&p.start==p.endB&&t.state.selection instanceof oe&&(p.start>t.state.selection.from&&p.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?p.start=t.state.selection.from:p.endA<t.state.selection.to&&p.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(p.endB+=t.state.selection.to-p.endA,p.endA=t.state.selection.to)),Ct&&Ar<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>u.from&&u.doc.textBetween(p.start-u.from-1,p.start-u.from+1)==" "&&(p.start--,p.endA--,p.endB--);let m=u.doc.resolveNoCache(p.start-u.from),v=u.doc.resolveNoCache(p.endB-u.from),g=c.resolve(p.start),w=m.sameParent(v)&&m.parent.inlineContent&&g.end()>=p.endA;if((Fs&&t.input.lastIOSEnter>Date.now()-225&&(!w||i.some(b=>b.nodeName=="DIV"||b.nodeName=="P"))||!w&&m.pos<u.doc.content.size&&(!m.sameParent(v)||!m.parent.inlineContent)&&m.pos<v.pos&&!/\S/.test(u.doc.textBetween(m.pos,v.pos,"","")))&&t.someProp("handleKeyDown",b=>b(t,Qr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>p.start&&vz(c,p.start,p.endA,m,v)&&t.someProp("handleKeyDown",b=>b(t,Qr(8,"Backspace")))){Bn&&tt&&t.domObserver.suppressSelectionUpdates();return}tt&&p.endB==p.start&&(t.input.lastChromeDelete=Date.now()),Bn&&!w&&m.start()!=v.start()&&v.parentOffset==0&&m.depth==v.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==p.endA&&(p.endB-=2,v=u.doc.resolveNoCache(p.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(b){return b(t,Qr(13,"Enter"))})},20));let y=p.start,x=p.endA,k=b=>{let E=b||t.state.tr.replace(y,x,u.doc.slice(p.start-u.from,p.endB-u.from));if(u.sel){let O=xv(t,E.doc,u.sel);O&&!(tt&&t.composing&&O.empty&&(p.start!=p.endB||t.input.lastChromeDelete<Date.now()-100)&&(O.head==y||O.head==E.mapping.map(x)-1)||Ct&&O.empty&&O.head==y)&&E.setSelection(O)}return s&&E.setMeta("composition",s),E.scrollIntoView()},S;if(w)if(m.pos==v.pos){Ct&&Ar<=11&&m.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Hn(t),20));let b=k(t.state.tr.delete(y,x)),E=c.resolve(p.start).marksAcross(c.resolve(p.endA));E&&b.ensureMarks(E),t.dispatch(b)}else if(p.endA==p.endB&&(S=yz(m.parent.content.cut(m.parentOffset,v.parentOffset),g.parent.content.cut(g.parentOffset,p.endA-g.start())))){let b=k(t.state.tr);S.type=="add"?b.addMark(y,x,S.mark):b.removeMark(y,x,S.mark),t.dispatch(b)}else if(m.parent.child(m.index()).isText&&m.index()==v.index()-(v.textOffset?0:1)){let b=m.parent.textBetween(m.parentOffset,v.parentOffset),E=()=>k(t.state.tr.insertText(b,y,x));t.someProp("handleTextInput",O=>O(t,y,x,b,E))||t.dispatch(E())}else t.dispatch(k());else t.dispatch(k())}function xv(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:mm(t,e.resolve(n.anchor),e.resolve(n.head))}function yz(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,s=r,o,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<n.length;c++)s=n[c].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(F.from(u).eq(t))return{mark:l,type:o}}function vz(t,e,n,r,i){if(n-e<=i.pos-r.pos||Zd(r,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(!r.parent.isTextblock){let l=s.nodeAfter;return l!=null&&n==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(Zd(s,!0,!0));return!o.parent.isTextblock||o.pos>n||Zd(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Zd(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function wz(t,e,n,r,i){let s=t.findDiffStart(e,n);if(s==null)return null;let{a:o,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let a=Math.max(0,s-Math.min(o,l));r-=o+a-s}if(o<s&&t.size<e.size){let a=r<=s&&r>=o?s-r:0;s-=a,s&&s<e.size&&Sv(e.textBetween(s-1,s+1))&&(s+=a?1:-1),l=s+(l-o),o=s}else if(l<s){let a=r<=s&&r>=l?s-r:0;s-=a,s&&s<t.size&&Sv(t.textBetween(s-1,s+1))&&(s+=a?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function Sv(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class N1{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Dj,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Cv),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=_v(this),kv(this),this.nodeViews=Ev(this),this.docView=nv(this.state.doc,bv(this),Qd(this),this.dom,this),this.domObserver=new az(this,(r,i,s,o)=>gz(this,r,i,s,o)),this.domObserver.start(),$j(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Uh(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Cv),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(S1(this),o=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let h=Ev(this);Sz(h,this.nodeViews)&&(this.nodeViews=h,s=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&Uh(this),this.editable=_v(this),kv(this);let a=Qd(this),u=bv(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,u,a);(d||!e.selection.eq(i.selection))&&(o=!0);let f=c=="preserve"&&o&&this.dom.style.overflowAnchor==null&&YL(this);if(o){this.domObserver.stop();let h=d&&(Ct||tt)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&xz(i.selection,e.selection);if(d){let p=tt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Yj(this)),(s||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=nv(e.doc,u,a,this.dom,this)),p&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&xj(this))?Hn(this,h):(u1(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():f&&XL(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof ee){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&Y0(this,n.getBoundingClientRect(),e)}else Y0(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new k1(e.slice,e.move,i<0?void 0:ee.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=n?n(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=n?n(l):l))return i}}hasFocus(){if(Ct){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&QL(this.dom),Hn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return rj(this,e)}coordsAtPos(e,n=1){return t1(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return aj(this,n||this.state,e)}pasteHTML(e,n){return Cl(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Cl(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return gm(this,e)}destroy(){this.docView&&(Lj(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Qd(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,BL())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return zj(this,e)}domSelectionRange(){let e=this.domSelection();return e?ct&&this.root.nodeType===11&&WL(this.dom.ownerDocument)==this.dom&&cz(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}N1.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function bv(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[qt.node(0,t.state.doc.content.size,e)]}function kv(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:qt.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function _v(t){return!t.someProp("editable",e=>e(t.state)===!1)}function xz(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Ev(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function Sz(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function Cv(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var $r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Qu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},bz=typeof navigator<"u"&&/Mac/.test(navigator.platform),kz=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var et=0;et<10;et++)$r[48+et]=$r[96+et]=String(et);for(var et=1;et<=24;et++)$r[et+111]="F"+et;for(var et=65;et<=90;et++)$r[et]=String.fromCharCode(et+32),Qu[et]=String.fromCharCode(et);for(var ef in $r)Qu.hasOwnProperty(ef)||(Qu[ef]=$r[ef]);function _z(t){var e=bz&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||kz&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Qu:$r)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const Ez=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Cz=typeof navigator<"u"&&/Win/.test(navigator.platform);function Tz(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,s,o;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))Ez?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function Nz(t){let e=Object.create(null);for(let n in t)e[Tz(n)]=t[n];return e}function tf(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function Oz(t){return new Nt({props:{handleKeyDown:O1(t)}})}function O1(t){let e=Nz(t);return function(n,r){let i=_z(r),s,o=e[tf(i,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[tf(i,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(Cz&&r.ctrlKey&&r.altKey)&&(s=$r[r.keyCode])&&s!=i){let l=e[tf(s,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}const bm=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function M1(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const A1=(t,e,n)=>{let r=M1(t,n);if(!r)return!1;let i=km(r);if(!i){let o=r.blockRange(),l=o&&Ys(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(B1(t,i,e,-1))return!0;if(r.parent.content.size==0&&(Vs(s,"end")||ee.isSelectable(s)))for(let o=r.depth;;o--){let l=Lc(t.doc,r.before(o),r.after(o),W.empty);if(l&&l.slice.size<l.to-l.from){if(e){let a=t.tr.step(l);a.setSelection(Vs(s,"end")?ae.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):ee.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},Mz=(t,e,n)=>{let r=M1(t,n);if(!r)return!1;let i=km(r);return i?I1(t,i,e):!1},Az=(t,e,n)=>{let r=P1(t,n);if(!r)return!1;let i=_m(r);return i?I1(t,i,e):!1};function I1(t,e,n){let r=e.nodeBefore,i=r,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let o=e.nodeAfter,l=o,a=e.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let c=l.firstChild;if(!c)return!1;l=c}let u=Lc(t.doc,s,a,W.empty);if(!u||u.from!=s||u instanceof Ue&&u.slice.size>=a-s)return!1;if(n){let c=t.tr.step(u);c.setSelection(oe.create(c.doc,s)),n(c.scrollIntoView())}return!0}function Vs(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const R1=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=km(r)}let o=s&&s.nodeBefore;return!o||!ee.isSelectable(o)?!1:(e&&e(t.tr.setSelection(ee.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function km(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function P1(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const D1=(t,e,n)=>{let r=P1(t,n);if(!r)return!1;let i=_m(r);if(!i)return!1;let s=i.nodeAfter;if(B1(t,i,e,1))return!0;if(r.parent.content.size==0&&(Vs(s,"start")||ee.isSelectable(s))){let o=Lc(t.doc,r.before(),r.after(),W.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Vs(s,"start")?ae.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):ee.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},$1=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=_m(r)}let o=s&&s.nodeAfter;return!o||!ee.isSelectable(o)?!1:(e&&e(t.tr.setSelection(ee.create(t.doc,s.pos)).scrollIntoView()),!0)};function _m(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const Iz=(t,e)=>{let n=t.selection,r=n instanceof ee,i;if(r){if(n.node.isTextblock||!Br(t.doc,n.from))return!1;i=n.from}else if(i=$c(t.doc,n.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);r&&s.setSelection(ee.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},Rz=(t,e)=>{let n=t.selection,r;if(n instanceof ee){if(n.node.isTextblock||!Br(t.doc,n.to))return!1;r=n.to}else if(r=$c(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},Pz=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),s=i&&Ys(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},L1=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Em(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const Dz=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=Em(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=n.after(),a=t.tr.replaceWith(l,l,o.createAndFill());a.setSelection(ae.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},j1=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof $t||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=Em(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=t.tr.insert(o,s.createAndFill());l.setSelection(oe.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},z1=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(Un(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),i=r&&Ys(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function $z(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof ee&&e.selection.node.isBlock)return!r.parentOffset||!Un(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],o,l,a=!1,u=!1;for(let h=r.depth;;h--)if(r.node(h).isBlock){a=r.end(h)==r.pos+(r.depth-h),u=r.start(h)==r.pos-(r.depth-h),l=Em(r.node(h-1).contentMatchAt(r.indexAfter(h-1))),s.unshift(a&&l?{type:l}:null),o=h;break}else{if(h==1)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof oe||e.selection instanceof $t)&&c.deleteSelection();let d=c.mapping.map(r.pos),f=Un(c.doc,d,s.length,s);if(f||(s[0]=l?{type:l}:null,f=Un(c.doc,d,s.length,s)),!f)return!1;if(c.split(d,s.length,s),!a&&u&&r.node(o).type!=l){let h=c.mapping.map(r.before(o)),p=c.doc.resolve(h);l&&r.node(o-1).canReplaceWith(p.index(),p.index()+1,l)&&c.setNodeMarkup(c.mapping.map(r.before(o)),l)}return n&&n(c.scrollIntoView()),!0}}const Lz=$z(),jz=(t,e)=>{let{$from:n,to:r}=t.selection,i,s=n.sharedDepth(r);return s==0?!1:(i=n.before(s),e&&e(t.tr.setSelection(ee.create(t.doc,i))),!0)};function zz(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Br(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function B1(t,e,n,r){let i=e.nodeBefore,s=e.nodeAfter,o,l,a=i.type.spec.isolating||s.type.spec.isolating;if(!a&&zz(t,e,n))return!0;let u=!a&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(o=(l=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(n){let h=e.pos+s.nodeSize,p=F.empty;for(let g=o.length-1;g>=0;g--)p=F.from(o[g].create(null,p));p=F.from(i.copy(p));let m=t.tr.step(new We(e.pos-1,h,e.pos,h,new W(p,1,0),o.length,!0)),v=m.doc.resolve(h+2*o.length);v.nodeAfter&&v.nodeAfter.type==i.type&&Br(m.doc,v.pos)&&m.join(v.pos),n(m.scrollIntoView())}return!0}let c=s.type.spec.isolating||r>0&&a?null:ae.findFrom(e,1),d=c&&c.$from.blockRange(c.$to),f=d&&Ys(d);if(f!=null&&f>=e.depth)return n&&n(t.tr.lift(d,f).scrollIntoView()),!0;if(u&&Vs(s,"start",!0)&&Vs(i,"end")){let h=i,p=[];for(;p.push(h),!h.isTextblock;)h=h.lastChild;let m=s,v=1;for(;!m.isTextblock;m=m.firstChild)v++;if(h.canReplace(h.childCount,h.childCount,m.content)){if(n){let g=F.empty;for(let y=p.length-1;y>=0;y--)g=F.from(p[y].copy(g));let w=t.tr.step(new We(e.pos-p.length,e.pos+s.nodeSize,e.pos+v,e.pos+s.nodeSize-v,new W(g,p.length,0),0,!0));n(w.scrollIntoView())}return!0}}return!1}function F1(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(n&&n(e.tr.setSelection(oe.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const Bz=F1(-1),Fz=F1(1);function Vz(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),l=o&&dm(o,t,e);return l?(r&&r(n.tr.wrap(o,l).scrollIntoView()),!0):!1}}function Tv(t,e=null){return function(n,r){let i=!1;for(let s=0;s<n.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[s];n.doc.nodesBetween(o,l,(a,u)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(t,e)))if(a.type==t)i=!0;else{let c=n.doc.resolve(u),d=c.index();i=c.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(r){let s=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:a}}=n.selection.ranges[o];s.setBlockType(l,a,t,e)}r(s.scrollIntoView())}return!0}}function Cm(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Cm(bm,A1,R1);Cm(bm,D1,$1);Cm(L1,j1,z1,Lz);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Uz(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s);if(!o)return!1;let l=r?n.tr:null;return Hz(l,o,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function Hz(t,e,n,r=null){let i=!1,s=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let a=o.resolve(e.start-2);s=new Wu(a,a,e.depth),e.endIndex<e.parent.childCount&&(e=new Wu(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let l=dm(s,n,r,e);return l?(t&&Wz(t,e,l,i,n),!0):!1}function Wz(t,e,n,r,i){let s=F.empty;for(let c=n.length-1;c>=0;c--)s=F.from(n[c].type.create(n[c].attrs,s));t.step(new We(e.start-(r?2:0),e.end,e.start,e.end,new W(s,0,0),n.length,!0));let o=0;for(let c=0;c<n.length;c++)n[c].type==i&&(o=c+1);let l=n.length-o,a=e.start+n.length-(r?2:0),u=e.parent;for(let c=e.startIndex,d=e.endIndex,f=!0;c<d;c++,f=!1)!f&&Un(t.doc,a,l)&&(t.split(a,l),a+=2*l),a+=u.child(c).nodeSize;return t}function qz(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?Kz(e,n,t,s):Jz(e,n,s):!0:!1}}function Kz(t,e,n,r){let i=t.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new We(s-1,o,s,o,new W(F.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Wu(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=Ys(r);if(l==null)return!1;i.lift(r,l);let a=i.doc.resolve(i.mapping.map(s,-1)-1);return Br(i.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&i.join(a.pos),e(i.scrollIntoView()),!0}function Jz(t,e,n){let r=t.tr,i=n.parent;for(let h=n.end,p=n.endIndex-1,m=n.startIndex;p>m;p--)h-=i.child(p).nodeSize,r.delete(h-1,h+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,a=n.endIndex==i.childCount,u=s.node(-1),c=s.index(-1);if(!u.canReplace(c+(l?0:1),c+1,o.content.append(a?F.empty:F.from(i))))return!1;let d=s.pos,f=d+o.nodeSize;return r.step(new We(d-(l?1:0),f+(a?1:0),d+1,f-1,new W((l?F.empty:F.from(i.copy(F.empty))).append(a?F.empty:F.from(i.copy(F.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function Gz(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,a=l.child(o-1);if(a.type!=t)return!1;if(n){let u=a.lastChild&&a.lastChild.type==l.type,c=F.from(u?t.create():null),d=new W(F.from(t.create(null,F.from(l.type.create(null,c)))),u?3:1,0),f=s.start,h=s.end;n(e.tr.step(new We(f-(u?3:1),h,f,h,d,1,!0)).scrollIntoView())}return!0}}function Vc(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,s=n.storedMarks,n}}}class Uc{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...c)=>{const d=a(...c)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l=[],a=!!e,u=e||s.tr,c=()=>(!a&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),l.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,h])=>[f,(...m)=>{const v=this.buildProps(u,n),g=h(...m)(v);return l.push(g),d}])),run:c};return d}createCan(e){const{rawCommands:n,state:r}=this,i=!1,s=e||r.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(n).map(([a,u])=>[a,(...c)=>u(...c)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l={tr:e,editor:i,view:o,state:Vc({state:s,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([a,u])=>[a,(...c)=>u(...c)(l)]))}};return l}}class Yz{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function J(t,e,n){return t.config[e]===void 0&&t.parent?J(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?J(t.parent,e,n):null}):t.config[e]}function Hc(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function V1(t){const e=[],{nodeExtensions:n,markExtensions:r}=Hc(t),i=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:i},a=J(o,"addGlobalAttributes",l);if(!a)return;a().forEach(c=>{c.types.forEach(d=>{Object.entries(c.attributes).forEach(([f,h])=>{e.push({type:d,name:f,attribute:{...s,...h}})})})})}),i.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},a=J(o,"addAttributes",l);if(!a)return;const u=a();Object.entries(u).forEach(([c,d])=>{const f={...s,...d};typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,e.push({type:o.name,name:c,attribute:f})})}),e}function Ke(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function dt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const l=s?String(s).split(" "):[],a=r[i]?r[i].split(" "):[],u=l.filter(c=>!a.includes(c));r[i]=[...a,...u].join(" ")}else if(i==="style"){const l=s?s.split(";").map(c=>c.trim()).filter(Boolean):[],a=r[i]?r[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;a.forEach(c=>{const[d,f]=c.split(":").map(h=>h.trim());u.set(d,f)}),l.forEach(c=>{const[d,f]=c.split(":").map(h=>h.trim());u.set(d,f)}),r[i]=Array.from(u.entries()).map(([c,d])=>`${c}: ${d}`).join("; ")}else r[i]=s}),r},{})}function Hh(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>dt(n,r),{})}function U1(t){return typeof t=="function"}function ue(t,e=void 0,...n){return U1(t)?e?t.bind(e)(...n):t(...n):t}function Xz(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Qz(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Nv(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(n):Qz(n.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...r,...i}}}}function Ov(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&Xz(n)?!1:n!=null))}function Zz(t,e){var n;const r=V1(t),{nodeExtensions:i,markExtensions:s}=Hc(t),o=(n=i.find(u=>J(u,"topNode")))===null||n===void 0?void 0:n.name,l=Object.fromEntries(i.map(u=>{const c=r.filter(g=>g.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},f=t.reduce((g,w)=>{const y=J(w,"extendNodeSchema",d);return{...g,...y?y(u):{}}},{}),h=Ov({...f,content:ue(J(u,"content",d)),marks:ue(J(u,"marks",d)),group:ue(J(u,"group",d)),inline:ue(J(u,"inline",d)),atom:ue(J(u,"atom",d)),selectable:ue(J(u,"selectable",d)),draggable:ue(J(u,"draggable",d)),code:ue(J(u,"code",d)),whitespace:ue(J(u,"whitespace",d)),linebreakReplacement:ue(J(u,"linebreakReplacement",d)),defining:ue(J(u,"defining",d)),isolating:ue(J(u,"isolating",d)),attrs:Object.fromEntries(c.map(g=>{var w;return[g.name,{default:(w=g==null?void 0:g.attribute)===null||w===void 0?void 0:w.default}]}))}),p=ue(J(u,"parseHTML",d));p&&(h.parseDOM=p.map(g=>Nv(g,c)));const m=J(u,"renderHTML",d);m&&(h.toDOM=g=>m({node:g,HTMLAttributes:Hh(g,c)}));const v=J(u,"renderText",d);return v&&(h.toText=v),[u.name,h]})),a=Object.fromEntries(s.map(u=>{const c=r.filter(v=>v.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},f=t.reduce((v,g)=>{const w=J(g,"extendMarkSchema",d);return{...v,...w?w(u):{}}},{}),h=Ov({...f,inclusive:ue(J(u,"inclusive",d)),excludes:ue(J(u,"excludes",d)),group:ue(J(u,"group",d)),spanning:ue(J(u,"spanning",d)),code:ue(J(u,"code",d)),attrs:Object.fromEntries(c.map(v=>{var g;return[v.name,{default:(g=v==null?void 0:v.attribute)===null||g===void 0?void 0:g.default}]}))}),p=ue(J(u,"parseHTML",d));p&&(h.parseDOM=p.map(v=>Nv(v,c)));const m=J(u,"renderHTML",d);return m&&(h.toDOM=v=>m({mark:v,HTMLAttributes:Hh(v,c)})),[u.name,h]}));return new Mk({topNode:o,nodes:l,marks:a})}function nf(t,e){return e.nodes[t]||e.marks[t]||null}function Mv(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function Tm(t,e){const n=Ii.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const eB=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,l)=>{var a,u;const c=((u=(a=i.type.spec).toText)===null||u===void 0?void 0:u.call(a,{node:i,pos:s,parent:o,index:l}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,r-s))}),n};function Nm(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Wc{constructor(e){this.find=e.find,this.handler=e.handler}}const tB=(t,e)=>{if(Nm(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Ia(t){var e;const{editor:n,from:r,to:i,text:s,rules:o,plugin:l}=t,{view:a}=n;if(a.composing)return!1;const u=a.state.doc.resolve(r);if(u.parent.type.spec.code||!((e=u.nodeBefore||u.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let c=!1;const d=eB(u)+s;return o.forEach(f=>{if(c)return;const h=tB(d,f.find);if(!h)return;const p=a.state.tr,m=Vc({state:a.state,transaction:p}),v={from:r-(h[0].length-s.length),to:i},{commands:g,chain:w,can:y}=new Uc({editor:n,state:m});f.handler({state:m,range:v,match:h,commands:g,chain:w,can:y})===null||!p.steps.length||(p.setMeta(l,{transform:p,from:r,to:i,text:s}),a.dispatch(p),c=!0)}),c}function nB(t){const{editor:e,rules:n}=t,r=new Nt({state:{init(){return null},apply(i,s,o){const l=i.getMeta(r);if(l)return l;const a=i.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:c}=a;typeof c=="string"?c=c:c=Tm(F.from(c),o.schema);const{from:d}=a,f=d+c.length;Ia({editor:e,from:d,to:f,text:c,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,o,l){return Ia({editor:e,from:s,to:o,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&Ia({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?Ia({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function rB(t){return Object.prototype.toString.call(t).slice(8,-1)}function Ra(t){return rB(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function qc(t,e){const n={...t};return Ra(t)&&Ra(e)&&Object.keys(e).forEach(r=>{Ra(e[r])&&Ra(t[r])?n[r]=qc(t[r],e[r]):n[r]=e[r]}),n}class Yn{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(J(this,"addOptions",{name:this.name}))),this.storage=ue(J(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Yn(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>qc(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Yn(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(J(n,"addOptions",{name:n.name})),n.storage=ue(J(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const a=o.find(u=>(u==null?void 0:u.type.name)===n.name);return a&&r.removeStoredMark(a),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function iB(t){return typeof t=="number"}class sB{constructor(e){this.find=e.find,this.handler=e.handler}}const oB=(t,e,n)=>{if(Nm(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const s=[i.text];return s.index=i.index,s.input=t,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function lB(t){const{editor:e,state:n,from:r,to:i,rule:s,pasteEvent:o,dropEvent:l}=t,{commands:a,chain:u,can:c}=new Uc({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,i,(h,p)=>{if(!h.isTextblock||h.type.spec.code)return;const m=Math.max(r,p),v=Math.min(i,p+h.content.size),g=h.textBetween(m-p,v-p,void 0,"");oB(g,s.find,o).forEach(y=>{if(y.index===void 0)return;const x=m+y.index+1,k=x+y[0].length,S={from:n.tr.mapping.map(x),to:n.tr.mapping.map(k)},b=s.handler({state:n,range:S,match:y,commands:a,chain:u,can:c,pasteEvent:o,dropEvent:l});d.push(b)})}),d.every(h=>h!==null)}let Pa=null;const aB=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function uB(t){const{editor:e,rules:n}=t;let r=null,i=!1,s=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const a=({state:c,from:d,to:f,rule:h,pasteEvt:p})=>{const m=c.tr,v=Vc({state:c,transaction:m});if(!(!lB({editor:e,state:v,from:Math.max(d-1,0),to:f.b-1,rule:h,pasteEvent:p,dropEvent:l})||!m.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return n.map(c=>new Nt({view(d){const f=p=>{var m;r=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?d.dom.parentElement:null,r&&(Pa=e)},h=()=>{Pa&&(Pa=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(d,f)=>{if(s=r===d.dom.parentElement,l=f,!s){const h=Pa;h!=null&&h.isEditable&&setTimeout(()=>{const p=h.state.selection;p&&h.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,f)=>{var h;const p=(h=f.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return o=f,i=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(d,f,h)=>{const p=d[0],m=p.getMeta("uiEvent")==="paste"&&!i,v=p.getMeta("uiEvent")==="drop"&&!s,g=p.getMeta("applyPasteRules"),w=!!g;if(!m&&!v&&!w)return;if(w){let{text:k}=g;typeof k=="string"?k=k:k=Tm(F.from(k),h.schema);const{from:S}=g,b=S+k.length,E=aB(k);return a({rule:c,state:h,from:S,to:{b},pasteEvt:E})}const y=f.doc.content.findDiffStart(h.doc.content),x=f.doc.content.findDiffEnd(h.doc.content);if(!(!iB(y)||!x||y===x.b))return a({rule:c,state:h,from:y,to:x,pasteEvt:o})}}))}function cB(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class fs{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=fs.resolve(e),this.schema=Zz(this.extensions,n),this.setupExtensions()}static resolve(e){const n=fs.sort(fs.flatten(e)),r=cB(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=J(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=J(r,"priority")||100,o=J(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:nf(n.name,this.schema)},i=J(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=fs.sort([...this.extensions].reverse()),r=[],i=[],s=n.map(o=>{const l={name:o.name,options:o.options,storage:o.storage,editor:e,type:nf(o.name,this.schema)},a=[],u=J(o,"addKeyboardShortcuts",l);let c={};if(o.type==="mark"&&J(o,"exitable",l)&&(c.ArrowRight=()=>Yn.handleExit({editor:e,mark:o})),u){const m=Object.fromEntries(Object.entries(u()).map(([v,g])=>[v,()=>g({editor:e})]));c={...c,...m}}const d=Oz(c);a.push(d);const f=J(o,"addInputRules",l);Mv(o,e.options.enableInputRules)&&f&&r.push(...f());const h=J(o,"addPasteRules",l);Mv(o,e.options.enablePasteRules)&&h&&i.push(...h());const p=J(o,"addProseMirrorPlugins",l);if(p){const m=p();a.push(...m)}return a}).flat();return[nB({editor:e,rules:r}),...uB({editor:e,rules:i}),...s]}get attributes(){return V1(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Hc(this.extensions);return Object.fromEntries(n.filter(r=>!!J(r,"addNodeView")).map(r=>{const i=this.attributes.filter(a=>a.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:Ke(r.name,this.schema)},o=J(r,"addNodeView",s);if(!o)return[];const l=(a,u,c,d,f)=>{const h=Hh(a,i);return o()({node:a,view:u,getPos:c,decorations:d,innerDecorations:f,editor:e,extension:r,HTMLAttributes:h})};return[r.name,l]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:nf(e.name,this.schema)};e.type==="mark"&&(!((n=ue(J(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=J(e,"onBeforeCreate",r),s=J(e,"onCreate",r),o=J(e,"onUpdate",r),l=J(e,"onSelectionUpdate",r),a=J(e,"onTransaction",r),u=J(e,"onFocus",r),c=J(e,"onBlur",r),d=J(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),a&&this.editor.on("transaction",a),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}}class yt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(J(this,"addOptions",{name:this.name}))),this.storage=ue(J(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new yt(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>qc(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new yt({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(J(n,"addOptions",{name:n.name})),n.storage=ue(J(n,"addStorage",{name:n.name,options:n.options})),n}}function H1(t,e,n){const{from:r,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=n||{};let l="";return t.nodesBetween(r,i,(a,u,c,d)=>{var f;a.isBlock&&u>r&&(l+=s);const h=o==null?void 0:o[a.type.name];if(h)return c&&(l+=h({node:a,pos:u,parent:c,index:d,range:e})),!1;a.isText&&(l+=(f=a==null?void 0:a.text)===null||f===void 0?void 0:f.slice(Math.max(r,u)-u,i-u))}),l}function W1(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const dB=yt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Nt({key:new On("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(c=>c.$from.pos)),l=Math.max(...s.map(c=>c.$to.pos)),a=W1(n);return H1(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),fB=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),hB=(t=!1)=>({commands:e})=>e.setContent("",t),pB=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:s,$to:o})=>{t.doc.nodesBetween(s.pos,o.pos,(l,a)=>{if(l.type.isText)return;const{doc:u,mapping:c}=e,d=u.resolve(c.map(a)),f=u.resolve(c.map(a+l.nodeSize)),h=d.blockRange(f);if(!h)return;const p=Ys(h);if(l.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},mB=t=>e=>t(e),gB=()=>({state:t,dispatch:e})=>j1(t,e),yB=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,s=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,s.content),r.setSelection(new oe(r.doc.resolve(Math.max(o-1,0)))),!0},vB=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(e){const l=i.before(s),a=i.after(s);t.delete(l,a).scrollIntoView()}return!0}return!1},wB=t=>({tr:e,state:n,dispatch:r})=>{const i=Ke(t,n.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const a=s.before(o),u=s.after(o);e.delete(a,u).scrollIntoView()}return!0}return!1},xB=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},SB=()=>({state:t,dispatch:e})=>bm(t,e),bB=()=>({commands:t})=>t.keyboardShortcut("Enter"),kB=()=>({state:t,dispatch:e})=>Dz(t,e);function Zu(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:Nm(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function q1(t,e,n={}){return t.find(r=>r.type===e&&Zu(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function Av(t,e,n={}){return!!q1(t,e,n)}function Om(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!q1([...i.node.marks],e,n)))return;let o=i.index,l=t.start()+i.offset,a=o+1,u=l+i.node.nodeSize;for(;o>0&&Av([...t.parent.child(o-1).marks],e,n);)o-=1,l-=t.parent.child(o).nodeSize;for(;a<t.parent.childCount&&Av([...t.parent.child(a).marks],e,n);)u+=t.parent.child(a).nodeSize,a+=1;return{from:l,to:u}}function Vr(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const _B=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const s=Vr(t,r.schema),{doc:o,selection:l}=n,{$from:a,from:u,to:c}=l;if(i){const d=Om(a,s,e);if(d&&d.from<=u&&d.to>=c){const f=oe.create(o,d.from,d.to);n.setSelection(f)}}return!0},EB=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function K1(t){return t instanceof oe}function li(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function J1(t,e=null){if(!e)return null;const n=ae.atStart(t),r=ae.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,s=r.to;return e==="all"?oe.create(t,li(0,i,s),li(t.content.size,i,s)):oe.create(t,li(e,i,s),li(e,i,s))}function Iv(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function ec(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function CB(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}const TB=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{(ec()||Iv())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),CB()&&!ec()&&!Iv()&&r.dom.focus({preventScroll:!0}))})};if(r.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!K1(n.state.selection))return o(),!0;const l=J1(i.doc,t)||n.state.selection,a=n.state.selection.eq(l);return s&&(a||i.setSelection(l),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},NB=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),OB=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),G1=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&G1(r)}return t};function Da(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return G1(n)}function Nl(t,e,n){if(t instanceof Or||t instanceof F)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return F.fromArray(t.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),Nl("",e,n)}if(i){if(n.errorOnInvalidContent){let o=!1,l="";const a=new Mk({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,l=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?Mr.fromSchema(a).parseSlice(Da(t),n.parseOptions):Mr.fromSchema(a).parse(Da(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=Mr.fromSchema(e);return n.slice?s.parseSlice(Da(t),n.parseOptions).content:s.parse(Da(t),n.parseOptions)}return Nl("",e,n)}function MB(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof Ue||i instanceof We))return;const s=t.mapping.maps[r];let o=0;s.forEach((l,a,u,c)=>{o===0&&(o=c)}),t.setSelection(ae.near(t.doc.resolve(o),n))}const AB=t=>!("type"in t),IB=(t,e,n)=>({tr:r,dispatch:i,editor:s})=>{var o;if(i){n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const a=v=>{s.emit("contentError",{editor:s,error:v,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Nl(e,s.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(v){a(v)}try{l=Nl(e,s.schema,{parseOptions:u,errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:s.options.enableContentCheck})}catch(v){return a(v),!1}let{from:c,to:d}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},f=!0,h=!0;if((AB(l)?l:[l]).forEach(v=>{v.check(),f=f?v.isText&&v.marks.length===0:!1,h=h?v.isBlock:!1}),c===d&&h){const{parent:v}=r.doc.resolve(c);v.isTextblock&&!v.type.spec.code&&!v.childCount&&(c-=1,d+=1)}let m;if(f){if(Array.isArray(e))m=e.map(v=>v.text||"").join("");else if(e instanceof F){let v="";e.forEach(g=>{g.text&&(v+=g.text)}),m=v}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,c,d)}else m=l,r.replaceWith(c,d,m);n.updateSelection&&MB(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:m}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:m})}return!0},RB=()=>({state:t,dispatch:e})=>Iz(t,e),PB=()=>({state:t,dispatch:e})=>Rz(t,e),DB=()=>({state:t,dispatch:e})=>A1(t,e),$B=()=>({state:t,dispatch:e})=>D1(t,e),LB=()=>({state:t,dispatch:e,tr:n})=>{try{const r=$c(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},jB=()=>({state:t,dispatch:e,tr:n})=>{try{const r=$c(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},zB=()=>({state:t,dispatch:e})=>Mz(t,e),BB=()=>({state:t,dispatch:e})=>Az(t,e);function Y1(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function FB(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,s,o;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))ec()||Y1()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}const VB=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const s=FB(t).split(/-(?!$)/),o=s.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,l))});return a==null||a.steps.forEach(u=>{const c=u.map(r.mapping);c&&i&&r.maybeStep(c)}),!0};function Ol(t,e,n={}){const{from:r,to:i,empty:s}=t.selection,o=e?Ke(e,t.schema):null,l=[];t.doc.nodesBetween(r,i,(d,f)=>{if(d.isText)return;const h=Math.max(r,f),p=Math.min(i,f+d.nodeSize);l.push({node:d,from:h,to:p})});const a=i-r,u=l.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>Zu(d.node.attrs,n,{strict:!1}));return s?!!u.length:u.reduce((d,f)=>d+f.to-f.from,0)>=a}const UB=(t,e={})=>({state:n,dispatch:r})=>{const i=Ke(t,n.schema);return Ol(n,i,e)?Pz(n,r):!1},HB=()=>({state:t,dispatch:e})=>z1(t,e),WB=t=>({state:e,dispatch:n})=>{const r=Ke(t,e.schema);return qz(r)(e,n)},qB=()=>({state:t,dispatch:e})=>L1(t,e);function Kc(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Rv(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const KB=(t,e)=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const l=Kc(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(s=Ke(t,r.schema)),l==="mark"&&(o=Vr(t,r.schema)),i&&n.selection.ranges.forEach(a=>{r.doc.nodesBetween(a.$from.pos,a.$to.pos,(u,c)=>{s&&s===u.type&&n.setNodeMarkup(c,void 0,Rv(u.attrs,e)),o&&u.marks.length&&u.marks.forEach(d=>{o===d.type&&n.addMark(c,c+u.nodeSize,o.create(Rv(d.attrs,e)))})})}),!0):!1},JB=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),GB=()=>({tr:t,dispatch:e})=>{if(e){const n=new $t(t.doc);t.setSelection(n)}return!0},YB=()=>({state:t,dispatch:e})=>R1(t,e),XB=()=>({state:t,dispatch:e})=>$1(t,e),QB=()=>({state:t,dispatch:e})=>jz(t,e),ZB=()=>({state:t,dispatch:e})=>Fz(t,e),e3=()=>({state:t,dispatch:e})=>Bz(t,e);function Wh(t,e,n={},r={}){return Nl(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const t3=(t,e=!1,n={},r={})=>({editor:i,tr:s,dispatch:o,commands:l})=>{var a,u;const{doc:c}=s;if(n.preserveWhitespace!=="full"){const d=Wh(t,i.schema,n,{errorOnInvalidContent:(a=r.errorOnInvalidContent)!==null&&a!==void 0?a:i.options.enableContentCheck});return o&&s.replaceWith(0,c.content.size,d).setMeta("preventUpdate",!e),!0}return o&&s.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:c.content.size},t,{parseOptions:n,errorOnInvalidContent:(u=r.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function X1(t,e){const n=Vr(e,t.schema),{from:r,to:i,empty:s}=t.selection,o=[];s?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,a=>{o.push(...a.marks)});const l=o.find(a=>a.type.name===n.name);return l?{...l.attrs}:{}}function n3(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function r3(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function Mm(t){return e=>r3(e.$from,t)}function i3(t,e){const n={from:0,to:t.content.size};return H1(t,n,e)}function s3(t,e){const n=Ke(e,t.schema),{from:r,to:i}=t.selection,s=[];t.doc.nodesBetween(r,i,l=>{s.push(l)});const o=s.reverse().find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function o3(t,e){const n=Kc(typeof e=="string"?e:e.name,t.schema);return n==="node"?s3(t,e):n==="mark"?X1(t,e):{}}function Q1(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const s=n.resolve(t),o=Om(s,i.type);o&&r.push({mark:i,...o})}):n.nodesBetween(t,e,(i,s)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function nu(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(s=>s.type===e&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}function qh(t,e,n={}){const{empty:r,ranges:i}=t.selection,s=e?Vr(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>s?s.name===d.type.name:!0).find(d=>Zu(d.attrs,n,{strict:!1}));let o=0;const l=[];if(i.forEach(({$from:d,$to:f})=>{const h=d.pos,p=f.pos;t.doc.nodesBetween(h,p,(m,v)=>{if(!m.isText&&!m.marks.length)return;const g=Math.max(h,v),w=Math.min(p,v+m.nodeSize),y=w-g;o+=y,l.push(...m.marks.map(x=>({mark:x,from:g,to:w})))})}),o===0)return!1;const a=l.filter(d=>s?s.name===d.mark.type.name:!0).filter(d=>Zu(d.mark.attrs,n,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),u=l.filter(d=>s?d.mark.type!==s&&d.mark.type.excludes(s):!0).reduce((d,f)=>d+f.to-f.from,0);return(a>0?a+u:a)>=o}function l3(t,e,n={}){if(!e)return Ol(t,null,n)||qh(t,null,n);const r=Kc(e,t.schema);return r==="node"?Ol(t,e,n):r==="mark"?qh(t,e,n):!1}function Pv(t,e){const{nodeExtensions:n}=Hc(e),r=n.find(o=>o.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=ue(J(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Am(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(s=>{i!==!1&&(Am(s,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function a3(t){return t instanceof ee}function u3(t,e,n){var r;const{selection:i}=e;let s=null;if(K1(i)&&(s=i.$cursor),s){const l=(r=t.storedMarks)!==null&&r!==void 0?r:s.marks();return!!n.isInSet(l)||!l.some(a=>a.type.excludes(n))}const{ranges:o}=i;return o.some(({$from:l,$to:a})=>{let u=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,a.pos,(c,d,f)=>{if(u)return!1;if(c.isInline){const h=!f||f.type.allowsMarkType(n),p=!!n.isInSet(c.marks)||!c.marks.some(m=>m.type.excludes(n));u=h&&p}return!u}),u})}const c3=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:s}=n,{empty:o,ranges:l}=s,a=Vr(t,r.schema);if(i)if(o){const u=X1(r,a);n.addStoredMark(a.create({...u,...e}))}else l.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;r.doc.nodesBetween(c,d,(f,h)=>{const p=Math.max(h,c),m=Math.min(h+f.nodeSize,d);f.marks.find(g=>g.type===a)?f.marks.forEach(g=>{a===g.type&&n.addMark(p,m,a.create({...g.attrs,...e}))}):n.addMark(p,m,a.create(e))})});return u3(r,n,a)},d3=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),f3=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const s=Ke(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:l})=>Tv(s,{...o,...e})(n)?!0:l.clearNodes()).command(({state:l})=>Tv(s,{...o,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},h3=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=li(t,0,r.content.size),s=ee.create(r,i);e.setSelection(s)}return!0},p3=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:s}=typeof t=="number"?{from:t,to:t}:t,o=oe.atStart(r).from,l=oe.atEnd(r).to,a=li(i,o,l),u=li(s,o,l),c=oe.create(r,a,u);e.setSelection(c)}return!0},m3=t=>({state:e,dispatch:n})=>{const r=Ke(t,e.schema);return Gz(r)(e,n)};function Dv(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const g3=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:l,$to:a}=s,u=i.extensionManager.attributes,c=nu(u,l.node().type.name,l.node().attrs);if(s instanceof ee&&s.node.isBlock)return!l.parentOffset||!Un(o,l.pos)?!1:(r&&(t&&Dv(n,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const d=a.parentOffset===a.parent.content.size,f=l.depth===0?void 0:n3(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=d&&f?[{type:f,attrs:c}]:void 0,p=Un(e.doc,e.mapping.map(l.pos),1,h);if(!h&&!p&&Un(e.doc,e.mapping.map(l.pos),1,f?[{type:f}]:void 0)&&(p=!0,h=f?[{type:f,attrs:c}]:void 0),r){if(p&&(s instanceof oe&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,h),f&&!d&&!l.parentOffset&&l.parent.type!==f)){const m=e.mapping.map(l.before()),v=e.doc.resolve(m);l.node(-1).canReplaceWith(v.index(),v.index()+1,f)&&e.setNodeMarkup(e.mapping.map(l.before()),f)}t&&Dv(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return p},y3=(t,e={})=>({tr:n,state:r,dispatch:i,editor:s})=>{var o;const l=Ke(t,r.schema),{$from:a,$to:u}=r.selection,c=r.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(u))return!1;const d=a.node(-1);if(d.type!==l)return!1;const f=s.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==l||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let g=F.empty;const w=a.index(-1)?1:a.index(-2)?2:3;for(let E=a.depth-w;E>=a.depth-3;E-=1)g=F.from(a.node(E).copy(g));const y=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,x={...nu(f,a.node().type.name,a.node().attrs),...e},k=((o=l.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(x))||void 0;g=g.append(F.from(l.createAndFill(null,k)||void 0));const S=a.before(a.depth-(w-1));n.replace(S,a.after(-y),new W(g,4-w,0));let b=-1;n.doc.nodesBetween(S,n.doc.content.size,(E,O)=>{if(b>-1)return!1;E.isTextblock&&E.content.size===0&&(b=O+1)}),b>-1&&n.setSelection(oe.near(n.doc.resolve(b))),n.scrollIntoView()}return!0}const h=u.pos===a.end()?d.contentMatchAt(0).defaultType:null,p={...nu(f,d.type.name,d.attrs),...e},m={...nu(f,a.node().type.name,a.node().attrs),...e};n.delete(a.pos,u.pos);const v=h?[{type:l,attrs:p},{type:h,attrs:m}]:[{type:l,attrs:p}];if(!Un(n.doc,a.pos,2))return!1;if(i){const{selection:g,storedMarks:w}=r,{splittableMarks:y}=s.extensionManager,x=w||g.$to.parentOffset&&g.$from.marks();if(n.split(a.pos,2,v).scrollIntoView(),!x||!i)return!0;const k=x.filter(S=>y.includes(S.type.name));n.ensureMarks(k)}return!0},rf=(t,e)=>{const n=Mm(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Br(t.doc,n.pos)&&t.join(n.pos),!0},sf=(t,e)=>{const n=Mm(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Br(t.doc,r)&&t.join(r),!0},v3=(t,e,n,r={})=>({editor:i,tr:s,state:o,dispatch:l,chain:a,commands:u,can:c})=>{const{extensions:d,splittableMarks:f}=i.extensionManager,h=Ke(t,o.schema),p=Ke(e,o.schema),{selection:m,storedMarks:v}=o,{$from:g,$to:w}=m,y=g.blockRange(w),x=v||m.$to.parentOffset&&m.$from.marks();if(!y)return!1;const k=Mm(S=>Pv(S.type.name,d))(m);if(y.depth>=1&&k&&y.depth-k.depth<=1){if(k.node.type===h)return u.liftListItem(p);if(Pv(k.node.type.name,d)&&h.validContent(k.node.content)&&l)return a().command(()=>(s.setNodeMarkup(k.pos,h),!0)).command(()=>rf(s,h)).command(()=>sf(s,h)).run()}return!n||!x||!l?a().command(()=>c().wrapInList(h,r)?!0:u.clearNodes()).wrapInList(h,r).command(()=>rf(s,h)).command(()=>sf(s,h)).run():a().command(()=>{const S=c().wrapInList(h,r),b=x.filter(E=>f.includes(E.type.name));return s.ensureMarks(b),S?!0:u.clearNodes()}).wrapInList(h,r).command(()=>rf(s,h)).command(()=>sf(s,h)).run()},w3=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=n,o=Vr(t,r.schema);return qh(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},x3=(t,e,n={})=>({state:r,commands:i})=>{const s=Ke(t,r.schema),o=Ke(e,r.schema),l=Ol(r,s,n);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),l?i.setNode(o,a):i.setNode(s,{...a,...n})},S3=(t,e={})=>({state:n,commands:r})=>{const i=Ke(t,n.schema);return Ol(n,i,e)?r.lift(i):r.wrapIn(i,e)},b3=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let s;if(i.spec.isInputRules&&(s=i.getState(t))){if(e){const o=t.tr,l=s.transform;for(let a=l.steps.length-1;a>=0;a-=1)o.step(l.steps[a].invert(l.docs[a]));if(s.text){const a=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,t.schema.text(s.text,a))}else o.delete(s.from,s.to)}return!0}}return!1},k3=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},_3=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=n,a=Vr(t,r.schema),{$from:u,empty:c,ranges:d}=l;if(!i)return!0;if(c&&o){let{from:f,to:h}=l;const p=(s=u.marks().find(v=>v.type===a))===null||s===void 0?void 0:s.attrs,m=Om(u,a,p);m&&(f=m.from,h=m.to),n.removeMark(f,h,a)}else d.forEach(f=>{n.removeMark(f.$from.pos,f.$to.pos,a)});return n.removeStoredMark(a),!0},E3=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const l=Kc(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(s=Ke(t,r.schema)),l==="mark"&&(o=Vr(t,r.schema)),i&&n.selection.ranges.forEach(a=>{const u=a.$from.pos,c=a.$to.pos;let d,f,h,p;n.selection.empty?r.doc.nodesBetween(u,c,(m,v)=>{s&&s===m.type&&(h=Math.max(v,u),p=Math.min(v+m.nodeSize,c),d=v,f=m)}):r.doc.nodesBetween(u,c,(m,v)=>{v<u&&s&&s===m.type&&(h=Math.max(v,u),p=Math.min(v+m.nodeSize,c),d=v,f=m),v>=u&&v<=c&&(s&&s===m.type&&n.setNodeMarkup(v,void 0,{...m.attrs,...e}),o&&m.marks.length&&m.marks.forEach(g=>{if(o===g.type){const w=Math.max(v,u),y=Math.min(v+m.nodeSize,c);n.addMark(w,y,o.create({...g.attrs,...e}))}}))}),f&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...f.attrs,...e}),o&&f.marks.length&&f.marks.forEach(m=>{o===m.type&&n.addMark(h,p,o.create({...m.attrs,...e}))}))}),!0):!1},C3=(t,e={})=>({state:n,dispatch:r})=>{const i=Ke(t,n.schema);return Vz(i,e)(n,r)},T3=(t,e={})=>({state:n,dispatch:r})=>{const i=Ke(t,n.schema);return Uz(i,e)(n,r)};var N3=Object.freeze({__proto__:null,blur:fB,clearContent:hB,clearNodes:pB,command:mB,createParagraphNear:gB,cut:yB,deleteCurrentNode:vB,deleteNode:wB,deleteRange:xB,deleteSelection:SB,enter:bB,exitCode:kB,extendMarkRange:_B,first:EB,focus:TB,forEach:NB,insertContent:OB,insertContentAt:IB,joinBackward:DB,joinDown:PB,joinForward:$B,joinItemBackward:LB,joinItemForward:jB,joinTextblockBackward:zB,joinTextblockForward:BB,joinUp:RB,keyboardShortcut:VB,lift:UB,liftEmptyBlock:HB,liftListItem:WB,newlineInCode:qB,resetAttributes:KB,scrollIntoView:JB,selectAll:GB,selectNodeBackward:YB,selectNodeForward:XB,selectParentNode:QB,selectTextblockEnd:ZB,selectTextblockStart:e3,setContent:t3,setMark:c3,setMeta:d3,setNode:f3,setNodeSelection:h3,setTextSelection:p3,sinkListItem:m3,splitBlock:g3,splitListItem:y3,toggleList:v3,toggleMark:w3,toggleNode:x3,toggleWrap:S3,undoInputRule:b3,unsetAllMarks:k3,unsetMark:_3,updateAttributes:E3,wrapIn:C3,wrapInList:T3});const O3=yt.create({name:"commands",addCommands(){return{...N3}}}),M3=yt.create({name:"drop",addProseMirrorPlugins(){return[new Nt({key:new On("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),A3=yt.create({name:"editable",addProseMirrorPlugins(){return[new Nt({key:new On("editable"),props:{editable:()=>this.editor.options.editable}})]}}),I3=new On("focusEvents"),R3=yt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Nt({key:I3,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),P3=yt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:a,doc:u}=l,{empty:c,$anchor:d}=a,{pos:f,parent:h}=d,p=d.parent.isTextblock&&f>0?l.doc.resolve(f-1):d,m=p.parent.type.spec.isolating,v=d.pos-d.parentOffset,g=m&&p.parent.childCount===1?v===d.pos:ae.atStart(u).from===f;return!c||!h.type.isTextblock||h.textContent.length||!g||g&&d.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ec()||Y1()?s:i},addProseMirrorPlugins(){return[new Nt({key:new On("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(m=>m.getMeta("composition")))return;const r=t.some(m=>m.docChanged)&&!e.doc.eq(n.doc),i=t.some(m=>m.getMeta("preventClearDocument"));if(!r||i)return;const{empty:s,from:o,to:l}=e.selection,a=ae.atStart(e.doc).from,u=ae.atEnd(e.doc).to;if(s||!(o===a&&l===u)||!Am(n.doc))return;const f=n.tr,h=Vc({state:n,transaction:f}),{commands:p}=new Uc({editor:this.editor,state:h});if(p.clearNodes(),!!f.steps.length)return f}})]}}),D3=yt.create({name:"paste",addProseMirrorPlugins(){return[new Nt({key:new On("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),$3=yt.create({name:"tabindex",addProseMirrorPlugins(){return[new Nt({key:new On("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Zr{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Zr(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Zr(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Zr(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,o=this.pos+r+(s?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(o);if(!i&&l.depth<=this.depth)return;const a=new Zr(l,this.editor,i,i?n:null);i&&(a.actualDepth=this.depth+1),e.push(new Zr(l,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const s=i.node.attrs,o=Object.keys(n);for(let l=0;l<o.length;l+=1){const a=o[l];if(s[a]!==n[a])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const s=Object.keys(n);return this.children.forEach(o=>{r&&i.length>0||(o.node.type.name===e&&s.every(a=>n[a]===o.node.attrs[a])&&i.push(o),!(r&&i.length>0)&&(i=i.concat(o.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const L3=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function j3(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class z3 extends Yz{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=j3(L3,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=U1(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(s=>{const o=typeof s=="string"?`${s}$`:s.key;r=r.filter(l=>!l.key.startsWith(o))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[A3,dB.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),O3,R3,P3,$3,M3,D3].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new fs(i,this)}createCommandManager(){this.commandManager=new Uc({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=Wh(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()}}),n=Wh(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=J1(n,this.options.autofocus);this.view=new N1(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:ds.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(o)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return o3(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return l3(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Tm(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return i3(this.state.doc,{blockSeparator:n,textSerializers:{...W1(this.schema),...r}})}get isEmpty(){return Am(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new Zr(n,this)}get $doc(){return this.$pos(0)}}function Us(t){return new Wc({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ue(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],l=r[0];if(o){const a=l.search(/\S/),u=n.from+l.indexOf(o),c=u+o.length;if(Q1(n.from,n.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===t.type&&m!==h.mark.type)).filter(h=>h.to>u).length)return null;c<n.to&&s.delete(c,n.to),u>n.from&&s.delete(n.from+a,u);const f=n.from+a+o.length;s.addMark(n.from+a,f,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}function B3(t){return new Wc({find:t.find,handler:({state:e,range:n,match:r})=>{const i=ue(t.getAttributes,void 0,r)||{},{tr:s}=e,o=n.from;let l=n.to;const a=t.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let c=o+u;c>l?c=l:l=c+r[1].length;const d=r[0][r[0].length-1];s.insertText(d,o+r[0].length-1),s.replaceWith(c,l,a)}else if(r[0]){const u=t.type.isInline?o:o-1;s.insert(u,t.type.create(i)).delete(s.mapping.map(o),s.mapping.map(l))}s.scrollIntoView()}})}function Kh(t){return new Wc({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),s=ue(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})}function Ml(t){return new Wc({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const s=ue(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),a=o.doc.resolve(n.from).blockRange(),u=a&&dm(a,t.type,s);if(!u)return null;if(o.wrap(a,u),t.keepMarks&&t.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:h}=t.editor.extensionManager,p=f||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(v=>h.includes(v.type.name));o.ensureMarks(m)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,s).run()}const c=o.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&Br(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&o.join(n.from-1)}})}class Tt{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ue(J(this,"addOptions",{name:this.name}))),this.storage=ue(J(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Tt(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>qc(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Tt(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ue(J(n,"addOptions",{name:n.name})),n.storage=ue(J(n,"addStorage",{name:n.name,options:n.options})),n}}function Hs(t){return new sB({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const s=ue(t.getAttributes,void 0,r,i);if(s===!1||s===null)return null;const{tr:o}=e,l=r[r.length-1],a=r[0];let u=n.to;if(l){const c=a.search(/\S/),d=n.from+a.indexOf(l),f=d+l.length;if(Q1(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(v=>v===t.type&&v!==p.mark.type)).filter(p=>p.to>d).length)return null;f<n.to&&o.delete(f,n.to),d>n.from&&o.delete(n.from+c,d),u=n.from+c+l.length,o.addMark(n.from+c,u,t.type.create(s||{})),o.removeStoredMark(t.type)}}})}function F3(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof ee){const s=r.index();return r.parent.canReplaceWith(s,s+1,e)}let i=r.depth;for(;i>=0;){const s=r.index(i);if(r.node(i).contentMatchAt(s).matchType(e))return!0;i-=1}return!1}function V3(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Z1={exports:{}},of={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v;function U3(){if($v)return of;$v=1;var t=Ve;function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function l(d,f){var h=f(),p=r({inst:{value:h,getSnapshot:f}}),m=p[0].inst,v=p[1];return s(function(){m.value=h,m.getSnapshot=f,a(m)&&v({inst:m})},[d,h,f]),i(function(){return a(m)&&v({inst:m}),d(function(){a(m)&&v({inst:m})})},[d]),o(h),h}function a(d){var f=d.getSnapshot;d=d.value;try{var h=f();return!n(d,h)}catch{return!0}}function u(d,f){return f()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return of.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:c,of}Z1.exports=U3();var Im=Z1.exports;const H3=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},W3=({contentComponent:t})=>{const e=Im.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return Ve.createElement(Ve.Fragment,null,Object.values(e))};function q3(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:PT.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class K3 extends Ve.Component{constructor(e){var n;super(e),this.editorContentRef=Ve.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=q3(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return Ve.createElement(Ve.Fragment,null,Ve.createElement("div",{ref:H3(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&Ve.createElement(W3,{contentComponent:e.contentComponent}))}}const J3=I.forwardRef((t,e)=>{const n=Ve.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Ve.createElement(K3,{key:n,innerRef:e,...t})}),G3=Ve.memo(J3);var Y3=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!(o==="_owner"&&e.$$typeof)&&!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},X3=V3(Y3),e_={exports:{}},lf={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lv;function Q3(){if(Lv)return lf;Lv=1;var t=Ve,e=Im;function n(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,l=t.useMemo,a=t.useDebugValue;return lf.useSyncExternalStoreWithSelector=function(u,c,d,f,h){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=l(function(){function g(S){if(!w){if(w=!0,y=S,S=f(S),h!==void 0&&m.hasValue){var b=m.value;if(h(b,S))return x=b}return x=S}if(b=x,r(y,S))return b;var E=f(S);return h!==void 0&&h(b,E)?b:(y=S,x=E)}var w=!1,y,x,k=d===void 0?null:d;return[function(){return g(c())},k===null?void 0:function(){return g(k())}]},[c,d,f,h]);var v=i(u,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=v},[v]),a(v),v},lf}e_.exports=Q3();var Z3=e_.exports;const eF=typeof window<"u"?I.useLayoutEffect:I.useEffect;class tF{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function nF(t){var e;const[n]=I.useState(()=>new tF(t.editor)),r=Z3.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:X3);return eF(()=>n.watch(t.editor),[t.editor,n]),I.useDebugValue(r),r}const rF=!1,Jh=typeof window>"u",iF=Jh||!!(typeof window<"u"&&window.next);class Rm{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Jh||iF?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onBeforeCreate)===null||s===void 0?void 0:s.call(i,...r)},onBlur:(...r)=>{var i,s;return(s=(i=this.options.current).onBlur)===null||s===void 0?void 0:s.call(i,...r)},onCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onCreate)===null||s===void 0?void 0:s.call(i,...r)},onDestroy:(...r)=>{var i,s;return(s=(i=this.options.current).onDestroy)===null||s===void 0?void 0:s.call(i,...r)},onFocus:(...r)=>{var i,s;return(s=(i=this.options.current).onFocus)===null||s===void 0?void 0:s.call(i,...r)},onSelectionUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onSelectionUpdate)===null||s===void 0?void 0:s.call(i,...r)},onTransaction:(...r)=>{var i,s;return(s=(i=this.options.current).onTransaction)===null||s===void 0?void 0:s.call(i,...r)},onUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onUpdate)===null||s===void 0?void 0:s.call(i,...r)},onContentError:(...r)=>{var i,s;return(s=(i=this.options.current).onContentError)===null||s===void 0?void 0:s.call(i,...r)},onDrop:(...r)=>{var i,s;return(s=(i=this.options.current).onDrop)===null||s===void 0?void 0:s.call(i,...r)},onPaste:(...r)=>{var i,s;return(s=(i=this.options.current).onPaste)===null||s===void 0?void 0:s.call(i,...r)}};return new z3(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,s)=>{var o;return i===((o=n.extensions)===null||o===void 0?void 0:o[s])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Rm.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function sF(t={},e=[]){const n=I.useRef(t);n.current=t;const[r]=I.useState(()=>new Rm(n)),i=Im.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return I.useDebugValue(i),I.useEffect(r.onRender(e)),nF({editor:i,selector:({transactionNumber:s})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&s===0?0:s+1}),i}const oF=I.createContext({editor:null});oF.Consumer;const lF=I.createContext({onDragStart:void 0}),aF=()=>I.useContext(lF);Ve.forwardRef((t,e)=>{const{onDragStart:n}=aF(),r=t.as||"div";return Ve.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const uF=/^\s*>\s$/,cF=Tt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ml({find:uF,type:this.type})]}}),dF=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,fF=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,hF=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,pF=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,mF=Yn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Us({find:dF,type:this.type}),Us({find:hF,type:this.type})]},addPasteRules(){return[Hs({find:fF,type:this.type}),Hs({find:pF,type:this.type})]}}),gF="listItem",jv="textStyle",zv=/^\s*([-+*])\s$/,yF=Tt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(gF,this.editor.getAttributes(jv)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Ml({find:zv,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ml({find:zv,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(jv),editor:this.editor})),[t]}}),vF=/(^|[^`])`([^`]+)`(?!`)/,wF=/(^|[^`])`([^`]+)`(?!`)/g,xF=Yn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Us({find:vF,type:this.type})]},addPasteRules(){return[Hs({find:wF,type:this.type})]}}),SF=/^```([a-z]+)?[\s\n]$/,bF=/^~~~([a-z]+)?[\s\n]$/,kF=Tt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,s=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",dt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:s}=n;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:u})=>(u.setSelection(ae.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[Kh({find:SF,type:this.type,getAttributes:t=>({language:t[1]})}),Kh({find:bF,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Nt({key:new On("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i==null?void 0:i.mode;if(!n||!s)return!1;const{tr:o,schema:l}=t.state,a=l.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:s},a)),o.selection.$from.parent.type!==this.type&&o.setSelection(oe.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),_F=Tt.create({name:"doc",topNode:!0,content:"block+"});function EF(t={}){return new Nt({view(e){return new CF(e,t)}})}class CF{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,s=i.getBoundingClientRect(),o=s.width/i.offsetWidth,l=s.height/i.offsetHeight;if(n){let d=e.nodeBefore,f=e.nodeAfter;if(d||f){let h=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(h){let p=h.getBoundingClientRect(),m=d?p.bottom:p.top;d&&f&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let v=this.width/2*l;r={left:p.left,right:p.right,top:m-v,bottom:m+v}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),f=this.width/2*o;r={left:d.left-f,right:d.left+f,top:d.top,bottom:d.bottom}}let a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,c;if(!a||a==document.body&&getComputedStyle(a).position=="static")u=-pageXOffset,c=-pageYOffset;else{let d=a.getBoundingClientRect(),f=d.width/a.offsetWidth,h=d.height/a.offsetHeight;u=d.left-a.scrollLeft*f,c=d.top-a.scrollTop*h}this.element.style.left=(r.left-u)/o+"px",this.element.style.top=(r.top-c)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!s){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=Fk(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const TF=yt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[EF(this.options)]}});class Ae extends ae{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Ae.valid(r)?new Ae(r):ae.near(r)}content(){return W.empty}eq(e){return e instanceof Ae&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Ae(e.resolve(n.pos))}getBookmark(){return new Pm(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!NF(e)||!OF(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Ae.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(n>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=n;let a=e.doc.resolve(i);if(Ae.valid(a))return a}for(;;){let o=n>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!ee.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*n),r=!1;continue e}break}s=o,i+=n;let l=e.doc.resolve(i);if(Ae.valid(l))return l}return null}}}Ae.prototype.visible=!1;Ae.findFrom=Ae.findGapCursorFrom;ae.jsonID("gapcursor",Ae);class Pm{constructor(e){this.pos=e}map(e){return new Pm(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Ae.valid(n)?new Ae(n):ae.near(n)}}function t_(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function NF(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||t_(i.type))return!0;if(i.inlineContent)return!1}}return!0}function OF(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||t_(i.type))return!0;if(i.inlineContent)return!1}}return!0}function MF(){return new Nt({props:{decorations:PF,createSelectionBetween(t,e,n){return e.pos==n.pos&&Ae.valid(n)?new Ae(n):null},handleClick:IF,handleKeyDown:AF,handleDOMEvents:{beforeinput:RF}}})}const AF=O1({ArrowLeft:$a("horiz",-1),ArrowRight:$a("horiz",1),ArrowUp:$a("vert",-1),ArrowDown:$a("vert",1)});function $a(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,l=e>0?o.$to:o.$from,a=o.empty;if(o instanceof oe){if(!s.endOfTextblock(n)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=Ae.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new Ae(u))),!0):!1}}function IF(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Ae.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&ee.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Ae(r))),!0)}function RF(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Ae))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=F.empty;for(let o=r.length-1;o>=0;o--)i=F.from(r[o].createAndFill(null,i));let s=t.state.tr.replace(n.pos,n.pos,new W(i,0,0));return s.setSelection(oe.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function PF(t){if(!(t.selection instanceof Ae))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",ze.create(t.doc,[qt.widget(t.selection.head,e,{key:"gapcursor"})])}const DF=yt.create({name:"gapCursor",addProseMirrorPlugins(){return[MF()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ue(J(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),$F=Tt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",dt(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:s}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,a=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&a&&o){const d=a.filter(f=>l.includes(f.type.name));u.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),LF=Tt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,dt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Kh({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var tc=200,qe=function(){};qe.prototype.append=function(e){return e.length?(e=qe.from(e),!this.length&&e||e.length<tc&&this.leafAppend(e)||this.length<tc&&e.leafPrepend(this)||this.appendInner(e)):this};qe.prototype.prepend=function(e){return e.length?qe.from(e).append(this):this};qe.prototype.appendInner=function(e){return new jF(this,e)};qe.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?qe.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};qe.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};qe.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};qe.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},n,r),i};qe.from=function(e){return e instanceof qe?e:e&&e.length?new n_(e):qe.empty};var n_=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var a=s;a<o;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var a=s-1;a>=o;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=tc)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=tc)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(qe);qe.empty=new n_([]);var jF=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(qe);const zF=500;class un{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;n&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,l,a,u=[],c=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),s=i.maps.length),s--,c.push(d);return}if(i){c.push(new vn(d.map));let h=d.step.map(i.slice(s)),p;h&&o.maybeStep(h).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],u.push(new vn(p,void 0,void 0,u.length+c.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(d.step);if(d.selection)return l=i?d.selection.map(i.slice(s)):d.selection,a=new un(this.items.slice(0,r).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,n,r,i){let s=[],o=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let c=0;c<e.steps.length;c++){let d=e.steps[c].invert(e.docs[c]),f=new vn(e.mapping.maps[c],d,n),h;(h=a&&a.merge(f))&&(f=h,c?s.pop():l=l.slice(0,l.length-1)),s.push(f),n&&(o++,n=void 0),i||(a=f)}let u=o-r.depth;return u>FF&&(l=BF(l,u),o-=u),new un(l.append(s),o)}remapping(e,n){let r=new kl;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new un(this.items.append(e.map(n=>new vn(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(f=>{f.selection&&l--},i);let a=n;this.items.forEach(f=>{let h=s.getMirror(--a);if(h==null)return;o=Math.min(o,h);let p=s.maps[h];if(f.step){let m=e.steps[h].invert(e.docs[h]),v=f.selection&&f.selection.map(s.slice(a+1,h));v&&l++,r.push(new vn(p,m,v))}else r.push(new vn(p))},i);let u=[];for(let f=n;f<o;f++)u.push(new vn(s.maps[f]));let c=this.items.slice(0,i).append(u).append(r),d=new un(c,l);return d.emptyItemCount()>zF&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let a=o.step.map(n.slice(r)),u=a&&a.getMap();if(r--,u&&n.appendMap(u,r),a){let c=o.selection&&o.selection.map(n.slice(r));c&&s++;let d=new vn(u.invert(),a,c),f,h=i.length-1;(f=i.length&&i[h].merge(d))?i[h]=f:i.push(d)}}else o.map&&r--},this.items.length,0),new un(qe.from(i.reverse()),s)}}un.empty=new un(qe.empty,0);function BF(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class vn{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new vn(n.getMap().invert(),n,this.selection)}}}class ur{constructor(e,n,r,i,s){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const FF=20;function VF(t,e,n,r){let i=n.getMeta(gi),s;if(i)return i.historyState;n.getMeta(WF)&&(t=new ur(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(gi))return o.getMeta(gi).redo?new ur(t.done.addTransform(n,void 0,r,ru(e)),t.undone,Bv(n.mapping.maps),t.prevTime,t.prevComposition):new ur(t.done,t.undone.addTransform(n,void 0,r,ru(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),a=t.prevTime==0||!o&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!UF(n,t.prevRanges)),u=o?af(t.prevRanges,n.mapping):Bv(n.mapping.maps);return new ur(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,ru(e)),un.empty,u,n.time,l??t.prevComposition)}else return(s=n.getMeta("rebased"))?new ur(t.done.rebased(n,s),t.undone.rebased(n,s),af(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new ur(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),af(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function UF(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(n=!0)}),n}function Bv(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,s,o)=>e.push(s,o));return e}function af(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),s=e.map(t[r+1],-1);i<=s&&n.push(i,s)}return n}function HF(t,e,n){let r=ru(e),i=gi.get(e).spec.config,s=(n?t.undone:t.done).popEvent(e,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(n?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),i,r),a=new ur(n?l:s.remaining,n?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(gi,{redo:n,historyState:a})}let uf=!1,Fv=null;function ru(t){let e=t.plugins;if(Fv!=e){uf=!1,Fv=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){uf=!0;break}}return uf}const gi=new On("history"),WF=new On("closeHistory");function qF(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Nt({key:gi,state:{init(){return new ur(un.empty,un.empty,null,0,-1)},apply(e,n,r){return VF(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?i_:r=="historyRedo"?s_:null;return!i||!e.editable?!1:(n.preventDefault(),i(e.state,e.dispatch))}}}})}function r_(t,e){return(n,r)=>{let i=gi.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let s=HF(i,n,t);s&&r(e?s.scrollIntoView():s)}return!0}}const i_=r_(!1,!0),s_=r_(!0,!0),KF=yt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>i_(t,e),redo:()=>({state:t,dispatch:e})=>s_(t,e)}},addProseMirrorPlugins(){return[qF(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),JF=Tt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",dt(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!F3(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:r,$to:i}=n,s=t();return r.parentOffset===0?s.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):a3(n)?s.insertContentAt(i.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:o,dispatch:l})=>{var a;if(l){const{$to:u}=o.selection,c=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(oe.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(ee.create(o.doc,u.pos)):o.setSelection(oe.create(o.doc,u.pos));else{const d=(a=u.parent.type.contentMatch.defaultType)===null||a===void 0?void 0:a.create();d&&(o.insert(c,d),o.setSelection(oe.create(o.doc,c+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[B3({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),GF=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,YF=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,XF=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,QF=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,ZF=Yn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Us({find:GF,type:this.type}),Us({find:XF,type:this.type})]},addPasteRules(){return[Hs({find:YF,type:this.type}),Hs({find:QF,type:this.type})]}}),e4=Tt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",dt(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),t4="listItem",Vv="textStyle",Uv=/^(\d+)\.\s$/,n4=Tt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",dt(this.options.HTMLAttributes,n),0]:["ol",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(t4,this.editor.getAttributes(Vv)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Ml({find:Uv,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ml({find:Uv,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Vv)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),r4=Tt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),i4=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,s4=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,o4=Yn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Us({find:i4,type:this.type})]},addPasteRules(){return[Hs({find:s4,type:this.type})]}}),l4=Tt.create({name:"text",group:"inline"}),a4=yt.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(mF.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(cF.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(yF.configure(this.options.bulletList)),this.options.code!==!1&&t.push(xF.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(kF.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(_F.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(TF.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(DF.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push($F.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(LF.configure(this.options.heading)),this.options.history!==!1&&t.push(KF.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(JF.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(ZF.configure(this.options.italic)),this.options.listItem!==!1&&t.push(e4.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(n4.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(r4.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(o4.configure(this.options.strike)),this.options.text!==!1&&t.push(l4.configure(this.options.text)),t}}),u4=Yn.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",dt(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),Zt=({onClick:t,active:e,title:n,children:r})=>_.jsx("button",{type:"button",onMouseDown:i=>{i.preventDefault(),t()},className:`editor-btn${e?" active":""}`,title:n,children:r}),c4=({editor:t})=>t?_.jsxs("div",{className:"editor-toolbar",children:[_.jsx(Zt,{onClick:()=>t.chain().focus().toggleBold().run(),active:t.isActive("bold"),title:"Bold",children:_.jsx("strong",{children:"B"})}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleItalic().run(),active:t.isActive("italic"),title:"Italic",children:_.jsx("em",{children:"I"})}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleUnderline().run(),active:t.isActive("underline"),title:"Underline",children:_.jsx("u",{children:"U"})}),_.jsx("div",{className:"editor-toolbar-sep"}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),active:t.isActive("heading",{level:1}),title:"Heading 1",children:"H1"}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),active:t.isActive("heading",{level:2}),title:"Heading 2",children:"H2"}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleHeading({level:3}).run(),active:t.isActive("heading",{level:3}),title:"Heading 3",children:"H3"}),_.jsx("div",{className:"editor-toolbar-sep"}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleBulletList().run(),active:t.isActive("bulletList"),title:"Bullet list",children:""}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleOrderedList().run(),active:t.isActive("orderedList"),title:"Ordered list",children:"1"}),_.jsx("div",{className:"editor-toolbar-sep"}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleCode().run(),active:t.isActive("code"),title:"Inline code",children:"<>"}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleCodeBlock().run(),active:t.isActive("codeBlock"),title:"Code block",children:"{ }"}),_.jsx("div",{className:"editor-toolbar-sep"}),_.jsx(Zt,{onClick:()=>t.chain().focus().toggleBlockquote().run(),active:t.isActive("blockquote"),title:"Blockquote",children:""})]}):null,d4=({content:t,onChange:e})=>{const n=sF({extensions:[a4,u4],content:t||"",onUpdate:({editor:r})=>{e(r.getHTML())},editorProps:{attributes:{class:"prose-editor"}}});return I.useEffect(()=>{if(!n)return;n.getHTML()!==(t||"")&&n.commands.setContent(t||"",!1)},[t]),_.jsxs("div",{className:"rich-text-editor",children:[_.jsx(c4,{editor:n}),_.jsx(G3,{editor:n,className:"editor-content"})]})},f4={0:"Root",1:"Main Topic",2:"Subtopic",3:"Detail"},h4=()=>{const{nodes:t,selectedNodeId:e,updateNodeData:n,deselectNode:r,deleteNode:i}=Gs(),s=t.find(h=>h.id===e),o=I.useCallback(h=>{e&&n(e,{title:h.target.value})},[e,n]),l=I.useCallback(h=>{e&&n(e,{content:h})},[e,n]),a=I.useCallback(()=>{if(s){if(s.data.level===0){alert("The root node cannot be deleted.");return}confirm(`Delete "${s.data.title}"?`)&&i(e)}},[s,e,i]);if(!s)return _.jsx("div",{className:"sidebar sidebar--empty",children:_.jsx("p",{children:"Click a node to view and edit its details"})});const{title:u,key:c,level:d,content:f}=s.data;return _.jsxs("div",{className:"sidebar",children:[_.jsxs("div",{className:"sidebar-header",children:[_.jsx("div",{className:"sidebar-header-left",children:_.jsxs("span",{className:"level-badge","data-level":Math.min(d,3),children:[f4[Math.min(d,3)]||"Node","  L",d]})}),_.jsx("button",{className:"icon-btn",onClick:r,title:"Close panel","aria-label":"Close",children:""})]}),_.jsxs("div",{className:"sidebar-body",children:[_.jsxs("div",{className:"field",children:[_.jsx("label",{className:"field-label",children:"Title"}),_.jsx("input",{className:"field-input",value:u,onChange:o,placeholder:"Node title",autoFocus:!0})]}),_.jsxs("div",{className:"field",children:[_.jsx("label",{className:"field-label",children:"Key"}),_.jsx("div",{className:"key-display",children:c})]}),_.jsxs("div",{className:"field field--grow",children:[_.jsx("label",{className:"field-label",children:"Notes"}),_.jsx(d4,{content:f,onChange:l},e)]})]}),d>0&&_.jsx("div",{className:"sidebar-footer",children:_.jsx("button",{className:"btn btn--danger btn--sm",onClick:a,children:"Delete node"})})]})},p4=()=>{const{isMapListOpen:t,closeMapList:e,loadMap:n,currentMapId:r}=Gs(),[i,s]=I.useState([]),[o,l]=I.useState(!1),[a,u]=I.useState(null);I.useEffect(()=>{t&&c()},[t]);const c=async()=>{l(!0),u(null);try{const{data:p,error:m}=await Lo.from("maps").select("id, name, updated_at, created_at").order("updated_at",{ascending:!1});if(m)throw m;s(p||[])}catch(p){u(p.message)}finally{l(!1)}},d=async p=>{var v;const m=await n(p);m.success?e():alert("Failed to load map: "+((v=m.error)==null?void 0:v.message))},f=async(p,m,v)=>{if(v.stopPropagation(),!confirm(`Delete "${m}"? This cannot be undone.`))return;const{error:g}=await Lo.from("maps").delete().eq("id",p);g?alert("Delete failed: "+g.message):s(w=>w.filter(y=>y.id!==p))},h=p=>{const m=new Date(p);return m.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})+"  "+m.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})};return t?_.jsx("div",{className:"modal-overlay",onClick:e,children:_.jsxs("div",{className:"modal",role:"dialog","aria-modal":"true",onClick:p=>p.stopPropagation(),children:[_.jsxs("div",{className:"modal-header",children:[_.jsx("h2",{className:"modal-title",children:"Open Map"}),_.jsx("button",{className:"icon-btn",onClick:e,"aria-label":"Close",children:""})]}),_.jsxs("div",{className:"modal-body",children:[o&&_.jsx("div",{className:"modal-state",children:"Loading"}),a&&_.jsxs("div",{className:"modal-state modal-state--error",children:["Error: ",a]}),!o&&!a&&i.length===0&&_.jsx("div",{className:"modal-state modal-state--empty",children:"No saved maps yet. Save a map to see it here."}),_.jsx("ul",{className:"map-list",children:i.map(p=>_.jsxs("li",{className:`map-item${p.id===r?" map-item--current":""}`,onClick:()=>d(p.id),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&d(p.id),children:[_.jsxs("div",{className:"map-item-info",children:[_.jsx("span",{className:"map-item-name",children:p.name}),_.jsx("span",{className:"map-item-date",children:h(p.updated_at)})]}),_.jsx("button",{className:"icon-btn icon-btn--danger",onClick:m=>f(p.id,p.name,m),title:"Delete map","aria-label":"Delete",children:""})]},p.id))})]})]})}):null};function m4(){const{undo:t,redo:e,selectedNodeId:n}=Gs();return I.useEffect(()=>{const r=i=>{(i.metaKey||i.ctrlKey)&&(i.key==="z"&&!i.shiftKey?(i.preventDefault(),t()):(i.key==="y"||i.key==="z"&&i.shiftKey)&&(i.preventDefault(),e()))};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[t,e]),_.jsxs("div",{className:"app",children:[_.jsx($$,{}),_.jsxs("div",{className:"app-body",children:[_.jsx(z$,{}),_.jsx("div",{className:"canvas-wrapper",children:_.jsx(U$,{})}),_.jsx(h4,{})]}),_.jsx(p4,{})]})}function g4(){return _.jsx(Kb,{children:_.jsx(m4,{})})}cf.createRoot(document.getElementById("root")).render(_.jsx(Ve.StrictMode,{children:_.jsx(g4,{})}));
